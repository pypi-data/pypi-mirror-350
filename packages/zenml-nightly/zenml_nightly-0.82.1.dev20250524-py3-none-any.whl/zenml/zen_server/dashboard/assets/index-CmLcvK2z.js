import{i as q,q as T}from"./@tanstack-CSxjHCME.js";import{o as g,p as N,q as R,j as S,s as v,F as b,z as c,h as E,ao as k,az as I,aA as P,aB as _,aC as J,ah as K,aD as V,ac as B,I as C,b5 as G}from"./index-D2iSHVZq.js";import{j as a}from"./@radix-C7hRs6Kx.js";import{S as L}from"./plus-COjQg3AG.js";import{S as Q}from"./trash-BWSZ7NRK.js";import{b as f,a as Z,C as x}from"./index.esm-D7jFlf5N.js";import{c as H,i as M}from"./type-guards-CaeD8wHO.js";async function O(e){const r=g(N.flavors.all)+(e?`?${R(e)}`:""),t=await S(r,{method:"GET",headers:{"Content-Type":"application/json"}});if(t.status===404&&v(),!t.ok){const o=await t.json().then(n=>Array.isArray(n.detail)?n.detail[1]:n.detail).catch(()=>"Error while fetching flavors");throw new b({status:t.status,statusText:t.statusText,message:o})}return t.json()}async function U(e){const r=g(N.flavors.detail(e)),t=await S(r,{method:"GET",headers:{"Content-Type":"application/json"}});if(t.status===404&&v(),!t.ok){const o=await t.json().then(n=>Array.isArray(n.detail)?n.detail[1]:n.detail).catch(()=>`Error while fetching flavor ${e}`);throw new b({status:t.status,statusText:t.statusText,message:o})}return t.json()}const F={all:["flavors"],flavorList:e=>T({queryKey:[...F.all,e],queryFn:async()=>O(e)}),flavorDetail:e=>T({queryKey:[...F.all,e],queryFn:async()=>U(e)}),flavorListInfinite:e=>q({queryKey:[...F.all,e,"infinite"],queryFn:({pageParam:r})=>O({...e,page:r}),getNextPageParam:r=>r.index<r.total_pages?r.index+1:null,initialPageParam:1})};function Se(e){const r=Object.keys(e).reduce((t,o)=>(t[o]=c.string().trim().min(1),t),{});return c.object(r)}function ve(e){if(!e.properties)return c.object({});const r=e.required||[],t=e.properties,o=Object.keys(t).reduce((n,s)=>{const i=t[s];if(!i)return n;const l=Y(s,r);return n[s]=$(i,e.$defs,l),n},{});return c.object(o)}function $(e,r,t,o=!1){let n=w(e,r);if(n.anyOf){const i=n.anyOf.find(l=>l.type!==null);i&&(n=w(i,r))}switch(n.allOf&&(n=w(n.allOf[0],r)),n.type){case"string":return t?c.string().trim():c.string().trim().min(1,"Required");case"boolean":return t?c.union([c.literal(""),c.boolean()]):c.boolean();case"array":{if(o)return t?c.union([c.literal(""),p]):p;const i=c.array($(n.items||{},r,!1,!1));return t?i:i.min(1)}case"object":return t?c.union([c.literal(""),p]):p;case"integer":return t?c.union([c.literal(""),c.preprocess(i=>Number(i),c.number().int())]):c.preprocess(i=>Number(i),c.number().int());default:return t?c.union([c.literal(""),c.string()]):c.string().min(1,"Required")}}function Y(e,r){return!r.includes(e)}const p=c.string().refine(e=>{try{return JSON.parse(e),!0}catch{return!1}},{message:"Invalid JSON"}).transform(e=>e===""?e:JSON.parse(e));function w(e,r){if(!e.$ref||!r)return e;const t=e.$ref.split("/").pop();return!t||!r[t]?e:r[t]}function d({label:e,isOptional:r}){return a.jsxs(a.Fragment,{children:[e,!r&&a.jsx("span",{className:"text-theme-text-error","aria-label":"required",children:"*"})]})}function W({name:e,label:r,isOptional:t,schema:o,definitions:n}){const s=f(),{fields:i,append:l,remove:u}=Z({name:e,control:s.control});return a.jsxs("div",{className:"space-y-3",children:[!!r&&a.jsx("label",{className:"text-text-sm",children:a.jsx(d,{label:r,isOptional:t})}),a.jsx("ul",{className:"space-y-5",children:i.map((h,m)=>a.jsxs("li",{className:"flex w-full items-center gap-4 [&>div]:w-full",children:[a.jsx(fe,{isNested:!0,name:`${e}.${m}`,schema:o,isOptional:t,definitions:n}),a.jsxs(E,{className:"h-7 w-7",emphasis:"subtle",size:"sm",type:"button",onClick:()=>u(m),children:[a.jsx(Q,{className:"h-5 w-5 fill-primary-900"}),a.jsx("span",{className:"sr-only",children:"remove"})]})]},h.id))}),a.jsxs(E,{className:"h-7 w-7",emphasis:"subtle",type:"button",onClick:()=>l(""),children:[a.jsx(L,{className:"h-5 w-5 fill-primary-900"}),a.jsx("p",{className:"sr-only",children:"Add Item"})]})]})}function X({name:e,isOptional:r,label:t}){var s;const o=f(),n=o.formState.errors[e];return a.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[!!t&&a.jsx("label",{htmlFor:e,className:"text-text-sm",children:a.jsx(d,{label:t,isOptional:r})}),a.jsx(x,{control:o.control,name:e,render:({field:{onChange:i,value:l,...u}})=>a.jsx(k,{id:e,checked:l,onCheckedChange:h=>i(h),...u})}),n&&a.jsx("p",{className:"text-text-sm text-error-500",children:(s=n.message)==null?void 0:s.toString()})]})}function ee({name:e,label:r,isOptional:t,enumValues:o}){var i;const n=f(),s=n.formState.errors[e];return a.jsxs("div",{className:"space-y-0.5",children:[!!r&&a.jsx("label",{htmlFor:e,className:"text-text-sm",children:a.jsx(d,{label:r,isOptional:t})}),a.jsx(x,{control:n.control,name:e,render:({field:{onChange:l,ref:u,...h}})=>a.jsxs(I,{...h,onValueChange:l,children:[a.jsx(P,{"data-error":s?"true":"false",className:"h-7 max-w-full truncate border border-neutral-300 px-2 text-left text-text-sm data-[error=true]:border-error-500",children:a.jsx(_,{placeholder:"Select Option"})}),a.jsx(J,{children:a.jsx(K,{viewportClassName:"max-h-[300px]",children:o.map(m=>a.jsx(V,{className:"space-x-2",value:m,children:m},m))})})]})}),s&&a.jsx("p",{className:"text-text-sm text-error-500",children:(i=s.message)==null?void 0:i.toString()})]})}function re(e){return e.type==="string"}function te(e){return e.type==="string"&&e.enum!==void 0}function se(e){return e.type==="string"&&!!e.sensitive}function z(e){return e.type==="boolean"}function D(e){return e.type==="object"}function y(e){return e.type==="array"}function ne(e){return e.type==="integer"}function ae(e){var r;return((r=e.enum)==null?void 0:r.map(t=>t.toString()))||[]}function j(e,r){if(!e.$ref||!r)return e;const t=e.$ref.replace("#/$defs/",""),o=r[t];return o||console.error(`Could not resolve $ref: ${e.$ref}`),o}function oe(e,r){return e.title?e.title:B(r)}function be(e,r){const t=Object.entries(e.properties||{}).reduce((o,[n,s])=>{let i="";return s.default?z(s)?i=s.default:D(s)?i=JSON.stringify(s.default):y(s)?i=s.default:i=s.default.toString():y(s)&&(i=[]),{...o,[n]:i}},{});return r&&Object.entries(r).forEach(([o,n])=>{t[o]=H(n)?n.map(s=>JSON.stringify(s)):M(n)?JSON.stringify(n):n}),t}function ie({name:e,isOptional:r,label:t}){var s;const o=f(),n=o.formState.errors[e];return a.jsxs("div",{className:"space-y-0.5",children:[!!t&&a.jsx("label",{htmlFor:e,className:"text-text-sm",children:a.jsx(d,{label:t,isOptional:r})}),a.jsx(x,{control:o.control,name:e,render:({field:i})=>a.jsx(C,{inputSize:"md",className:"w-full data-[error=true]:border-error-500",id:e,...i,type:"number","data-error":n?"true":"false"})}),n&&a.jsx("p",{className:"text-text-sm text-error-500",children:(s=n.message)==null?void 0:s.toString()})]})}function ce({name:e,label:r,isOptional:t}){var s;const o=f(),n=o.formState.errors[e];return a.jsxs("div",{className:"space-y-0.5",children:[!!r&&a.jsx("label",{htmlFor:e,className:"text-text-sm",children:a.jsx(d,{label:r,isOptional:t})}),a.jsx(x,{control:o.control,name:e,render:({field:i})=>a.jsx("textarea",{rows:4,placeholder:"Please paste your JSON",className:G({inputSize:"md",className:"h-auto w-full resize-none font-mono data-[error=true]:border-error-500"}),id:e,...i,"data-error":n?"true":"false"})}),n&&a.jsx("p",{className:"text-text-sm text-error-500",children:(s=n.message)==null?void 0:s.toString()})]})}function le({name:e,isOptional:r,label:t}){var s;const o=f(),n=o.formState.errors[e];return a.jsxs("div",{className:"space-y-0.5",children:[!!t&&a.jsx("label",{htmlFor:e,className:"text-text-sm",children:a.jsx(d,{label:t,isOptional:r})}),a.jsx(x,{control:o.control,name:e,render:({field:i})=>a.jsx(C,{inputSize:"md",className:"w-full data-[error=true]:border-error-500",id:e,...i,"data-error":n?"true":"false"})}),n&&a.jsx("p",{className:"text-text-sm text-error-500",children:(s=n.message)==null?void 0:s.toString()})]})}function ue({name:e,label:r,isOptional:t}){var s;const o=f(),n=o.formState.errors[e];return a.jsxs("div",{className:"space-y-0.5",children:[!!r&&a.jsx("label",{htmlFor:e,className:"text-text-sm",children:a.jsx(d,{label:r,isOptional:t})}),a.jsx(x,{control:o.control,name:e,render:({field:i})=>a.jsx(C,{placeholder:"Use {{<SECRET_NAME>.<SECRET_KEY>}} to reference a secret",inputSize:"md",className:"w-full placeholder:font-mono data-[error=true]:border-error-500",id:e,...i,type:"text","data-error":n?"true":"false"})}),n&&a.jsx("p",{className:"text-text-sm text-error-500",children:(s=n.message)==null?void 0:s.toString()})]})}function fe({schema:e,name:r,isOptional:t,definitions:o,isNested:n}){let s=j(e,o);n&&s.items&&(s=j(s.items,o)),n&&s.prefixItems&&(s=j(s.prefixItems[0],o));const i=n?"":oe(s,r);if(s.anyOf){const l=s.anyOf.find(u=>u.type!==null);if(l){const u=j(l,o);s={...s,...u}}}if(s.allOf){const l=j(s.allOf[0],o);s={...s,...l}}if(te(s))return a.jsx(ee,{name:r,label:i,schema:e,isOptional:t,enumValues:ae(s)});if(se(s))return a.jsx(ue,{name:r,label:i,schema:s,isOptional:t});if(ne(s))return a.jsx(ie,{name:r,label:i,schema:s,isOptional:t});if(re(s))return a.jsx(le,{name:r,label:i,schema:s,isOptional:t});if(z(s))return a.jsx(X,{name:r,label:i,schema:s,isOptional:t});if(D(s)||y(s)&&n)return a.jsx(ce,{name:r,label:i,schema:s,isOptional:t});if(y(s))return a.jsx(W,{definitions:o,name:r,label:i,schema:s,isOptional:t})}async function de(e){const r=g(N.serviceConnectors.types.detail(e)),t=await S(r,{method:"GET",headers:{"Content-Type":"application/json"}});if(t.status===404&&v(),!t.ok){const o=await t.json().then(n=>Array.isArray(n.detail)?n.detail[1]:n.detail).catch(()=>"Error while fetching service connector type");throw new b({status:t.status,statusText:t.statusText,message:o})}return t.json()}async function me(e){const r=R(e).toString(),t=g(N.serviceConnectors.list+(r?`?${r}`:"")),o=await S(t,{method:"GET",headers:{"Content-Type":"application/json"}});if(o.status===404&&v(),!o.ok){const n=await o.json().then(s=>Array.isArray(s.detail)?s.detail[1]:s.detail).catch(()=>"Error while fetching service connector list");throw new b({status:o.status,statusText:o.statusText,message:n})}return o.json()}const A={connectorTypes:["service_connector_types"],connectors:["service_connectors"],serviceConnectorTypeDetail:e=>T({queryKey:[...A.connectorTypes,e],queryFn:async()=>de(e)}),serviceConnectorListInfinite:(e={})=>q({queryKey:[...A.connectors,e,"infinite"],queryFn:({pageParam:r})=>me({...e,page:r}),getNextPageParam:r=>r.index<r.total_pages?r.index+1:null,initialPageParam:1})};export{fe as D,be as a,Y as b,F as f,ve as g,A as s,Se as z};
