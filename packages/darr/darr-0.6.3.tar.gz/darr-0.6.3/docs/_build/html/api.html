
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Darr API Documentation &#8212; darr 0.4.0 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Release notes" href="releasenotes.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="releasenotes.html" title="Release notes"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">darr 0.4.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Darr API Documentation</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="darr-api-documentation">
<h1>Darr API Documentation<a class="headerlink" href="#darr-api-documentation" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#arrays" id="id3">Arrays</a></p>
<ul>
<li><p><a class="reference internal" href="#accessing-arrays" id="id4">Accessing arrays</a></p></li>
<li><p><a class="reference internal" href="#creating-arrays" id="id5">Creating arrays</a></p></li>
<li><p><a class="reference internal" href="#deleting-arrays" id="id6">Deleting arrays</a></p></li>
<li><p><a class="reference internal" href="#truncating-arrays" id="id7">Truncating arrays</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#ragged-arrays" id="id8">Ragged Arrays</a></p>
<ul>
<li><p><a class="reference internal" href="#accessing-ragged-arrays" id="id9">Accessing ragged arrays</a></p></li>
<li><p><a class="reference internal" href="#creating-ragged-arrays" id="id10">Creating ragged arrays</a></p></li>
<li><p><a class="reference internal" href="#deleting-ragged-arrays" id="id11">Deleting ragged arrays</a></p></li>
<li><p><a class="reference internal" href="#truncating-ragged-arrays" id="id12">Truncating ragged arrays</a></p></li>
</ul>
</li>
</ul>
</div>
<p>Two types of numeric data structures are supported:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#arrays">arrays</a></p></li>
<li><p><a class="reference internal" href="#raggedarrays">raggedarrays</a></p></li>
</ul>
<span class="target" id="module-darr.array"></span><p>Darr is a Python library for storing numeric data arrays in a format that
is as open and simple as possible. It also provides easy memory-mapped
access to such disk-based data using numpy indexing.</p>
<p>Darr objects can be created from array-like objects, such as numpy arrays
and lists, using the <strong>asarray</strong> function. Alternatively, darr arrays can be
created from scratch by the <strong>create_array</strong> function. Existing Darr data on
disk can be accessed through the <strong>Array</strong> constructor. To remove a Darr
array from disk, use <strong>delete_array</strong>.</p>
<div class="section" id="arrays">
<span id="id1"></span><h2><a class="toc-backref" href="#id3">Arrays</a><a class="headerlink" href="#arrays" title="Permalink to this headline">¶</a></h2>
<div class="section" id="accessing-arrays">
<h3><a class="toc-backref" href="#id4">Accessing arrays</a><a class="headerlink" href="#accessing-arrays" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="darr.Array">
<em class="property">class </em><code class="sig-prename descclassname">darr.</code><code class="sig-name descname">Array</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">accessmode</span><span class="o">=</span><span class="default_value">'r'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#darr.Array" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate a Darr array from disk.</p>
<p>A darr array corresponds to a directory containing 1) a binary file with
the raw numeric array values, 2) a text file (json format) describing the
numeric type, array shape, and other format information, 3) a README text
file documenting the data format, including examples of how to read the
data in Python or Matlab.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em><em> or </em><em>pathlib.Path</em>) – Path to disk-based array directory.</p></li>
<li><p><strong>accessmode</strong> (<em>{'r'</em><em>, </em><em>'r+'}</em><em>, </em><em>default 'r'</em>) – File access mode of the darr data. <cite>r</cite> means read-only, <cite>r+</cite> means
read-write. <cite>w</cite> does not exist. To create new darr arrays, potentially
overwriting an other one, use the <cite>asarray</cite> or <cite>create_array</cite>
functions.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="darr.Array.accessmode">
<em class="property">property </em><code class="sig-name descname">accessmode</code><a class="headerlink" href="#darr.Array.accessmode" title="Permalink to this definition">¶</a></dt>
<dd><p>Data access mode of metadata, {‘r’, ‘r+’}.</p>
</dd></dl>

<dl class="py method">
<dt id="darr.Array.append">
<code class="sig-name descname">append</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">array</span></em><span class="sig-paren">)</span><a class="headerlink" href="#darr.Array.append" title="Permalink to this definition">¶</a></dt>
<dd><p>Add array-like objects to darr to the end of the dataset.</p>
<p>Data will be appended along the first axis. The shape of the data and
the darr must be compliant. When appending data repeatedly it is
more efficient to use <cite>iterappend</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>array</strong> (<em>array-like object</em>) – This can be a numpy array, a sequence that can be converted into a
numpy array.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">darr</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">create_array</span><span class="p">(</span><span class="s1">&#39;test.da&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">[[ 0.  0.]</span>
<span class="go"> [ 0.  0.]</span>
<span class="go"> [ 0.  0.]</span>
<span class="go"> [ 0.  0.]</span>
<span class="go"> [ 1.  2.]</span>
<span class="go"> [ 3.  4.]</span>
<span class="go"> [ 5.  6.]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="darr.Array.archive">
<code class="sig-name descname">archive</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">compressiontype</span><span class="o">=</span><span class="default_value">'xz'</span></em>, <em class="sig-param"><span class="n">overwrite</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#darr.Array.archive" title="Permalink to this definition">¶</a></dt>
<dd><p>Archive array data into a single compressed file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> (<em>str</em>) – Name of the archive. In None, it will be derived from the data’s
path name.</p></li>
<li><p><strong>compressiontype</strong> (<em>str</em>) – One of ‘xz’, ‘gz’, or ‘bz2’, corresponding to the gzip, bz2 and
lzma compression algorithms supported by the Python standard
library.</p></li>
<li><p><strong>overwrite</strong> (<em>(</em><em>True</em><em>, </em><em>False</em><em>)</em><em>, </em><em>optional</em>) – Overwrites existing archive if it exists. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The path of the created archive</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pathlib.Path</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>See the <a class="reference external" href="https://docs.python.org/3/library/tarfile.html">tarfile library</a> for more info on archiving formats</p>
</dd></dl>

<dl class="py method">
<dt id="darr.Array.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">dtype</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">chunklen</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">accessmode</span><span class="o">=</span><span class="default_value">'r'</span></em>, <em class="sig-param"><span class="n">overwrite</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#darr.Array.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy darr to a different path, potentially changing its dtype.</p>
<p>The copying is performed in chunks to avoid RAM memory overflow for
very large darr arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em><em> or </em><em>pathlib.Path</em>) – </p></li>
<li><p><strong>dtype</strong> (<em>&lt;dtype</em><em>, </em><em>None&gt;</em>) – Numpy data type of the copy. Default is None, which corresponds to
the dtype of the darr to be copied.</p></li>
<li><p><strong>chunklen</strong> (<em>&lt;int</em><em>, </em><em>None&gt;</em>) – The length of chunks (along first axis) that are written during
creation. If None, it is chosen so that chunks are 10 Mb in total
size.</p></li>
<li><p><strong>accessmode</strong> (<em>{'r'</em><em>, </em><em>'r+'}</em><em>, </em><em>default 'r'</em>) – File access mode of the darr data of the returned Darr
object. <cite>r</cite> means read-only, <cite>r+</cite> means read-write.</p></li>
<li><p><strong>overwrite</strong> (<em>(</em><em>True</em><em>, </em><em>False</em><em>)</em><em>, </em><em>optional</em>) – Overwrites existing darr data if it exists. Note that a
darr path is a directory. If that directory contains
additional files, these will not be removed and an OSError is
raised. Default is <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>copy of the darr array</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#darr.Array" title="darr.Array">Array</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="darr.Array.datadir">
<em class="property">property </em><code class="sig-name descname">datadir</code><a class="headerlink" href="#darr.Array.datadir" title="Permalink to this definition">¶</a></dt>
<dd><p>Data directory object with many useful methods, such as
writing information to text or json files, archiving all data,
calculating checksums etc.</p>
</dd></dl>

<dl class="py method">
<dt id="darr.Array.dtype">
<em class="property">property </em><code class="sig-name descname">dtype</code><a class="headerlink" href="#darr.Array.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>Numpy data type of the array values.</p>
</dd></dl>

<dl class="py method">
<dt id="darr.Array.itemsize">
<em class="property">property </em><code class="sig-name descname">itemsize</code><a class="headerlink" href="#darr.Array.itemsize" title="Permalink to this definition">¶</a></dt>
<dd><p>The size in bytes of each item in the array.</p>
</dd></dl>

<dl class="py method">
<dt id="darr.Array.iterappend">
<code class="sig-name descname">iterappend</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">arrayiterable</span></em><span class="sig-paren">)</span><a class="headerlink" href="#darr.Array.iterappend" title="Permalink to this definition">¶</a></dt>
<dd><p>Iteratively append data from a data iterable.</p>
<p>The iterable has to yield chunks of data that are array-like objects
compliant with Darr arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arrayiterable</strong> (<em>an iterable that yield array-like objects</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">darr</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">create_array</span><span class="p">(</span><span class="s1">&#39;test.da&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">ga</span><span class="p">():</span>
<span class="go">        yield [[1,2],[3,4]]</span>
<span class="go">        yield [[5,6],[7,8],[9,10]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">iterappend</span><span class="p">(</span><span class="n">ga</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">[[  0.   0.]</span>
<span class="go"> [  0.   0.]</span>
<span class="go"> [  0.   0.]</span>
<span class="go"> [  1.   2.]</span>
<span class="go"> [  3.   4.]</span>
<span class="go"> [  5.   6.]</span>
<span class="go"> [  7.   8.]</span>
<span class="go"> [  9.  10.]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="darr.Array.iterchunks">
<code class="sig-name descname">iterchunks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">chunklen</span></em>, <em class="sig-param"><span class="n">stepsize</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">startindex</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">endindex</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">include_remainder</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">accessmode</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#darr.Array.iterchunks" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over data array of the darr yielding chunks of a
given length and with a given stepsize.</p>
<p>This method keeps the underlying data file open during iteration,
and is therefore relatively fast.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chunklen</strong> (<em>int</em>) – Size of chunk for across the first axis. Note that the last chunk
may be smaller than <cite>chunklen</cite>, depending on the size of the
first axis.</p></li>
<li><p><strong>stepsize</strong> (<em>&lt;int</em><em>, </em><em>None&gt;</em>) – Size of the shift per iteration across the first axis.
Default is None, which means that <cite>stepsize</cite> equals <cite>chunklen</cite>.</p></li>
<li><p><strong>include_remainder</strong> (<em>&lt;True</em><em>, </em><em>False&gt;</em>) – Determines whether remainder (&lt; chunklen) should be included.</p></li>
<li><p><strong>startindex</strong> (<em>&lt;int</em><em>, </em><em>None&gt;</em>) – Start index value.
Default is None, which means to start at the beginning.</p></li>
<li><p><strong>endindex</strong> (<em>&lt;int</em><em>, </em><em>None&gt;</em>) – End index value.
Default is None, which means to end at the end.</p></li>
<li><p><strong>include_remainder</strong> – Determines if the remainder at the end of the array, if it exist,
should be yielded or not. The remainder is smaller than <cite>chunklen</cite>.
Default is True.</p></li>
<li><p><strong>accessmode</strong> (<em>{'r'</em><em>, </em><em>'r+'}</em><em>, </em><em>default 'r'</em>) – File access mode of the darr data. <cite>r</cite> means read-only, <cite>r+</cite>
means read-write.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a generator that produces numpy array chunks.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>generator</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">darr</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fillfunc</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="c1"># fill with index number</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d1</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">create_array</span><span class="p">(</span><span class="s1">&#39;test1.da&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,),</span> <span class="n">fillfunc</span><span class="o">=</span><span class="n">fillfunc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d1</span><span class="p">)</span>
<span class="go">[  0.   1.   2.   3.   4.   5.   6.   7.   8.   9.  10.  11.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d2</span> <span class="o">=</span> <span class="n">darr</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="s1">&#39;test2.da&#39;</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">iterchunks</span><span class="p">(</span><span class="n">chunklen</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d2</span><span class="p">)</span>
<span class="go">[  0.   1.   3.   4.   6.   7.   9.  10.]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="darr.Array.iterindices">
<code class="sig-name descname">iterindices</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">chunklen</span></em>, <em class="sig-param"><span class="n">stepsize</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">startindex</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">endindex</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">include_remainder</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#darr.Array.iterindices" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate indices of chunks of a given length and with a given
stepsize.</p>
<p>This method keeps the underlying data file open during iteration,
and is therefore relatively fast.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chunklen</strong> (<em>int</em>) – Size of chunk for across the first axis. Note that the last chunk
may be smaller than <cite>chunklen</cite>, depending on the size of the
first axis.</p></li>
<li><p><strong>stepsize</strong> (<em>&lt;int</em><em>, </em><em>None&gt;</em>) – Size of the shift per iteration across the first axis.
Default is None, which means that <cite>stepsize</cite> equals <cite>chunklen</cite>.</p></li>
<li><p><strong>include_remainder</strong> (<em>&lt;True</em><em>, </em><em>False&gt;</em>) – Determines whether remainder (&lt; chunklen) should be included.</p></li>
<li><p><strong>startindex</strong> (<em>&lt;int</em><em>, </em><em>None&gt;</em>) – Start index value.
Default is None, which means to start at the beginning.</p></li>
<li><p><strong>endindex</strong> (<em>&lt;int</em><em>, </em><em>None&gt;</em>) – End index value.
Default is None, which means to end at the end.</p></li>
<li><p><strong>include_remainder</strong> – Determines if the remainder at the end of the array, if it exist,
should be yielded or not. The remainder is smaller than <cite>chunklen</cite>.
Default is True.</p></li>
<li><p><strong>accessmode</strong> (<em>{'r'</em><em>, </em><em>'r+'}</em><em>, </em><em>default 'r'</em>) – File access mode of the darr data. <cite>r</cite> means read-only, <cite>r+</cite>
means read-write.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a generator that produces numpy array chunks.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>generator</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">darr</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">create_array</span><span class="p">(</span><span class="s1">&#39;test.da&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,),</span> <span class="n">accesmode</span><span class="o">=</span> <span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">iterindices</span><span class="p">(</span><span class="n">chunklen</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="mi">3</span><span class="p">)):</span>
<span class="go">        d[:] = 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">[ 1.  1.  0.  1.  1.  0.  1.  1.  0.  1.  1.  0.]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="darr.Array.mb">
<em class="property">property </em><code class="sig-name descname">mb</code><a class="headerlink" href="#darr.Array.mb" title="Permalink to this definition">¶</a></dt>
<dd><p>Array size in megabytes, excluding metadata.</p>
</dd></dl>

<dl class="py method">
<dt id="darr.Array.metadata">
<em class="property">property </em><code class="sig-name descname">metadata</code><a class="headerlink" href="#darr.Array.metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary-like interface to metadata.</p>
</dd></dl>

<dl class="py method">
<dt id="darr.Array.nbytes">
<em class="property">property </em><code class="sig-name descname">nbytes</code><a class="headerlink" href="#darr.Array.nbytes" title="Permalink to this definition">¶</a></dt>
<dd><p>Array size in bytes, excluding metadata.</p>
</dd></dl>

<dl class="py method">
<dt id="darr.Array.ndim">
<em class="property">property </em><code class="sig-name descname">ndim</code><a class="headerlink" href="#darr.Array.ndim" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of dimensions</p>
</dd></dl>

<dl class="py method">
<dt id="darr.Array.open_array">
<code class="sig-name descname">open_array</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">accessmode</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#darr.Array.open_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Open the array for efficient multiple read or write operations.</p>
<p>Although read and write operations can be performed conveniently using
indexing notation on the Darr object, this can be relatively slow
when performing multiple access operations after each other. To read
data, the disk file needs to be opened, data copied into memory, and
after which the file is closed. In such cases, it is much faster to
first open the disk-based data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>accessmode</strong> (<em>{'r'</em><em>, </em><em>'r+'}</em><em>, </em><em>default 'r'</em>) – File access mode of the disk array data. <cite>r</cite> means read-only, <cite>r+</cite>
means read-write.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">darr</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">create_array</span><span class="p">(</span><span class="s1">&#39;test.da&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">d</span><span class="o">.</span><span class="n">open_array</span><span class="p">(</span><span class="n">accessmode</span><span class="o">=</span><span class="s1">&#39;r+&#39;</span><span class="p">):</span>
<span class="go">        s1 = d[:10,1:].sum()</span>
<span class="go">        s2 = d[20:25,:2].sum()</span>
<span class="go">        d[500:] = 3.33</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="darr.Array.path">
<em class="property">property </em><code class="sig-name descname">path</code><a class="headerlink" href="#darr.Array.path" title="Permalink to this definition">¶</a></dt>
<dd><p>File system path to array data</p>
</dd></dl>

<dl class="py method">
<dt id="darr.Array.readcode">
<code class="sig-name descname">readcode</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">language</span></em><span class="sig-paren">)</span><a class="headerlink" href="#darr.Array.readcode" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate code to read the array in a different language.</p>
<p>Note that this does not include reading the metadata, which is just
based on a text file in JSON format.</p>
<dl class="simple">
<dt>language: str</dt><dd><p>One of the languages that are supported. Choose from:
‘darr’, ‘idl’, ‘julia_ver0’, ‘julia_ver1’, ‘mathematica’,
‘matlab’, ‘maple’, ‘numpy’, ‘numpymemmap’, ‘R’.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">darr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">darr</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="s1">&#39;test.darr&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">readcode</span><span class="p">(</span><span class="s1">&#39;matlab&#39;</span><span class="p">))</span>
<span class="go">fileid = fopen(&#39;arrayvalues.bin&#39;);</span>
<span class="go">a = fread(fileid, [3, 2], &#39;*int32&#39;, &#39;ieee-le&#39;);</span>
<span class="go">fclose(fileid);</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="darr.Array.shape">
<em class="property">property </em><code class="sig-name descname">shape</code><a class="headerlink" href="#darr.Array.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuple with sizes of each axis of the data array.</p>
</dd></dl>

<dl class="py method">
<dt id="darr.Array.size">
<em class="property">property </em><code class="sig-name descname">size</code><a class="headerlink" href="#darr.Array.size" title="Permalink to this definition">¶</a></dt>
<dd><p>Total number of values in the data array.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="creating-arrays">
<h3><a class="toc-backref" href="#id5">Creating arrays</a><a class="headerlink" href="#creating-arrays" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="darr.asarray">
<code class="sig-prename descclassname">darr.</code><code class="sig-name descname">asarray</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">array</span></em>, <em class="sig-param"><span class="n">dtype</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">accessmode</span><span class="o">=</span><span class="default_value">'r'</span></em>, <em class="sig-param"><span class="n">metadata</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">chunklen</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">overwrite</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#darr.asarray" title="Permalink to this definition">¶</a></dt>
<dd><p>Save an array or array generator as a Darr array to file system path.</p>
<p>Data is always written in ‘C’ order to disk, independent of the order of
<cite>array</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em><em> or </em><em>pathlib.Path</em>) – File system path to which the array will be saved. Note that this will
be a directory containing multiple files.</p></li>
<li><p><strong>array</strong> (<em>array-like object</em><em> or </em><em>generator yielding array-like objects</em>) – This can be a numpy array, a sequence that can be converted into a
numpy array, or a generator that yields such objects. The latter will
be concatenated along the first dimension.</p></li>
<li><p><strong>dtype</strong> (<cite>numpy dtype</cite>, optional) – Is inferred from the data if <cite>None</cite>. If <cite>dtype</cite> is provided the data
will be cast to <cite>dtype</cite>. Default is <cite>None</cite>.</p></li>
<li><p><strong>accessmode</strong> ({<cite>r</cite>, <cite>r+</cite>}, optional) – File access mode of the darr that is returned. <cite>r</cite> means
read-only, <cite>r+</cite> means read-write. In the latter case, data can be
changed. Default <cite>r</cite>.</p></li>
<li><p><strong>metadata</strong> (<em>{None</em><em>, </em><em>dict}</em>) – Dictionary with metadata to be saved in a separate JSON file.
Default is None. If so, and the array has a ‘metadata’ attribute,
Darr will try to use it as metadata of the output array.</p></li>
<li><p><strong>chunklen</strong> (<em>&lt;int</em><em>, </em><em>None&gt;</em>) – The length of chunks (along first axis) that are read and written
during the process. If None and the <cite>array</cite> is a numpy array or
darr, it is chosen so that chunks are 10 Mb in total size. If
None and <cite>array</cite> is a generator or sequence, chunklen will be 1.</p></li>
<li><p><strong>overwrite</strong> (<em>(</em><em>True</em><em>, </em><em>False</em><em>)</em><em>, </em><em>optional</em>) – Overwrites existing darr data if it exists. Note that a darr
path is a directory. If that directory contains additional files,
these will not be removed and an OSError is raised. Default is <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A Darr <cite>array</cite> instance.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#darr.Array" title="darr.Array">Array</a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#darr.create_array" title="darr.create_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_array()</span></code></a></dt><dd><p>create an array from scratch.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">asarray</span><span class="p">(</span><span class="s1">&#39;data.da&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">darr([0, 1, 2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">asarray</span><span class="p">(</span><span class="s1">&#39;data.da&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">darr([ 0.,  1.,  2.,  3.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ar</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="s1">&#39;data_rw.da&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">accessmode</span><span class="o">=</span><span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ar</span>
<span class="go">darr([0, 1, 2, 3, 4, 5]) (r+)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ar</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ar</span>
<span class="go">darr([0, 1, 2, 3, 4, 8]) (r+)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ar</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9</span>
<span class="go">darr([9, 1, 9, 3, 9, 8]) (r+)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="darr.create_array">
<code class="sig-prename descclassname">darr.</code><code class="sig-name descname">create_array</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">shape</span></em>, <em class="sig-param"><span class="n">dtype</span><span class="o">=</span><span class="default_value">'float64'</span></em>, <em class="sig-param"><span class="n">fill</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fillfunc</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">accessmode</span><span class="o">=</span><span class="default_value">'r+'</span></em>, <em class="sig-param"><span class="n">chunklen</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">metadata</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">overwrite</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#darr.create_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new <cite>darr array</cite> of given shape and type, filled with
predetermined values. Data is always written in ‘C’ order to disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em><em> or </em><em>pathlib.Path</em>) – File system path to which the array will be saved. Note that this will
be a directory containing multiple files.</p></li>
<li><p><strong>shape</strong> (<em>int ot sequence of ints</em>) – Shape of the <cite>darr</cite>.</p></li>
<li><p><strong>dtype</strong> (<em>dtype</em><em>, </em><em>optional</em>) – The type of the <cite>darr</cite>. Default is ‘float64’</p></li>
<li><p><strong>fill</strong> (<em>number</em><em>, </em><em>optional</em>) – The value used to fill the array with. Default is <cite>None</cite>, which will
lead to the array being filled with zeros.</p></li>
<li><p><strong>fillfunc</strong> (<em>function</em><em>, </em><em>optional</em>) – A function that generates the fill values, potentially on the basis of
the index numbers of the first axis of the array. This function should
only have one argument, which will be automatically provided during
filling and which represents the index numbers along the first axis for
all dimensions (see example below). If <cite>fillfunc</cite> is provided, <cite>fill</cite>
should be <cite>None</cite>.  And vice versa. Default is None.</p></li>
<li><p><strong>accessmode</strong> (&lt;<cite>r</cite>, <cite>r+</cite>&gt;, optional) – File access mode of the darr data. <cite>r</cite> means real-only, <cite>r+</cite>
means read-write, i.e. values can be changed. Default <cite>r</cite>.</p></li>
<li><p><strong>chunklen</strong> (<em>&lt;int</em><em>, </em><em>None&gt;</em>) – The length of chunks (along first axis) that are written during
creation. If None, it is chosen so that chunks are 10 Mb in total size.</p></li>
<li><p><strong>metadata</strong> (<em>{None</em><em>, </em><em>dict}</em>) – Dictionary with metadata to be saved in a separate JSON file. Default
None</p></li>
<li><p><strong>overwrite</strong> (<em>&lt;True</em><em>, </em><em>False&gt;</em><em>, </em><em>optional</em>) – Overwrites existing darr data if it exists. Note that a darr
paths is a directory. If that directory contains additional files,
these will not be removed and an OSError is raised.
Default is <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A Darr <cite>array</cite> instance.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#darr.Array" title="darr.Array">Array</a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#darr.asarray" title="darr.asarray"><code class="xref py py-func docutils literal notranslate"><span class="pre">asarray()</span></code></a></dt><dd><p>create a darr array from existing array-like object or generator.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">darr</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">create_array</span><span class="p">(</span><span class="s1">&#39;testarray0&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="go">darr([[ 0.,  0.],</span>
<span class="go">   [ 0.,  0.],</span>
<span class="go">   [ 0.,  0.],</span>
<span class="go">   [ 0.,  0.],</span>
<span class="go">   [ 0.,  0.]]) (r+)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">create_array</span><span class="p">(</span><span class="s1">&#39;testarray1&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int16&#39;</span><span class="p">)</span>
<span class="go">darr([[0, 0],</span>
<span class="go">   [0, 0],</span>
<span class="go">   [0, 0],</span>
<span class="go">   [0, 0],</span>
<span class="go">   [0, 0]], dtype=int16) (r+)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">create_array</span><span class="p">(</span><span class="s1">&#39;testarray3&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="mf">23.4</span><span class="p">)</span>
<span class="go">darr([[ 23.4,  23.4],</span>
<span class="go">   [ 23.4,  23.4],</span>
<span class="go">   [ 23.4,  23.4],</span>
<span class="go">   [ 23.4,  23.4],</span>
<span class="go">   [ 23.4,  23.4]]) (r+)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fillfunc</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">create_array</span><span class="p">(</span><span class="s1">&#39;testarray4&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,),</span> <span class="n">fillfunc</span><span class="o">=</span><span class="n">fillfunc</span><span class="p">)</span>
<span class="go">darr([ 0.,  2.,  4.,  6.,  8.]) (r+)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fillfunc</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">create_array</span><span class="p">(</span><span class="s1">&#39;testarray4&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">fillfunc</span><span class="o">=</span><span class="n">fillfunc</span><span class="p">)</span>
<span class="go">darr([[ 0.,  0.],</span>
<span class="go">   [ 1.,  2.],</span>
<span class="go">   [ 2.,  4.],</span>
<span class="go">   [ 3.,  6.],</span>
<span class="go">   [ 4.,  8.]]) (r+)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="deleting-arrays">
<h3><a class="toc-backref" href="#id6">Deleting arrays</a><a class="headerlink" href="#deleting-arrays" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="darr.delete_array">
<code class="sig-prename descclassname">darr.</code><code class="sig-name descname">delete_array</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">da</span></em><span class="sig-paren">)</span><a class="headerlink" href="#darr.delete_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete Darr array data from disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>da</strong> (<a class="reference internal" href="#darr.Array" title="darr.Array"><em>Array</em></a><em> or </em><em>str</em><em> or </em><em>pathlib.Path</em>) – The darr object to be deleted or file system path to it.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="truncating-arrays">
<h3><a class="toc-backref" href="#id7">Truncating arrays</a><a class="headerlink" href="#truncating-arrays" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="darr.truncate_array">
<code class="sig-prename descclassname">darr.</code><code class="sig-name descname">truncate_array</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">index</span></em><span class="sig-paren">)</span><a class="headerlink" href="#darr.truncate_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Truncate darr data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>array</em><em> or </em><em>str</em><em> or </em><em>pathlib.Path</em>) – The darr object to be truncated or file system path to it.</p></li>
<li><p><strong>index</strong> (<em>int</em>) – The index along the first axis at which the darr should be
truncated. Negative indices can be used but the resulting length of
the truncated darr should be larger than 0 and smaller than the
current length.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">darr</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fillfunc</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">create_array</span><span class="p">(</span><span class="s1">&#39;testarray.da&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">fillfunc</span><span class="o">=</span><span class="n">fillfunc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">darr([[ 0.,  0.],</span>
<span class="go">           [ 1.,  1.],</span>
<span class="go">           [ 2.,  2.],</span>
<span class="go">           [ 3.,  3.],</span>
<span class="go">           [ 4.,  4.]]) (r+)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">truncate_array</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">darr([[ 0.,  0.],</span>
<span class="go">           [ 1.,  1.],</span>
<span class="go">           [ 2.,  2.]]) (r+)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">da</span><span class="o">.</span><span class="n">truncate_array</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">darr([[ 0.,  0.],</span>
<span class="go">           [ 1.,  1.]]) (r+)</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="ragged-arrays">
<span id="raggedarrays"></span><h2><a class="toc-backref" href="#id8">Ragged Arrays</a><a class="headerlink" href="#ragged-arrays" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Note that Ragged Arrays are still experimental! They do not support setting
values yet, only creating, appending, and reading.</p>
</div>
<div class="section" id="accessing-ragged-arrays">
<h3><a class="toc-backref" href="#id9">Accessing ragged arrays</a><a class="headerlink" href="#accessing-ragged-arrays" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="darr.RaggedArray">
<em class="property">class </em><code class="sig-prename descclassname">darr.</code><code class="sig-name descname">RaggedArray</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">accessmode</span><span class="o">=</span><span class="default_value">'r'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#darr.RaggedArray" title="Permalink to this definition">¶</a></dt>
<dd><p>Disk-based sequence of arrays that may have a variable length in maximally
one dimension.</p>
<dl class="py method">
<dt id="darr.RaggedArray.accessmode">
<em class="property">property </em><code class="sig-name descname">accessmode</code><a class="headerlink" href="#darr.RaggedArray.accessmode" title="Permalink to this definition">¶</a></dt>
<dd><p>Data access mode of metadata, {‘r’, ‘r+’}.</p>
</dd></dl>

<dl class="py method">
<dt id="darr.RaggedArray.archive">
<code class="sig-name descname">archive</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">compressiontype</span><span class="o">=</span><span class="default_value">'xz'</span></em>, <em class="sig-param"><span class="n">overwrite</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#darr.RaggedArray.archive" title="Permalink to this definition">¶</a></dt>
<dd><p>Archive array data into a single compressed file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> (<em>str</em>) – Name of the archive. In None, it will be derived from the data’s
path name.</p></li>
<li><p><strong>compressiontype</strong> (<em>str</em>) – One of ‘xz’, ‘gz’, or ‘bz2’, corresponding to the gzip, bz2 and
lzma compression algorithms supported by the Python standard
library.</p></li>
<li><p><strong>overwrite</strong> (<em>(</em><em>True</em><em>, </em><em>False</em><em>)</em><em>, </em><em>optional</em>) – Overwrites existing archive if it exists. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The path of the created archive</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pathlib.Path</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>See the <a class="reference external" href="https://docs.python.org/3/library/tarfile.html">tarfile library</a> for more info on archiving formats</p>
</dd></dl>

<dl class="py method">
<dt id="darr.RaggedArray.atom">
<em class="property">property </em><code class="sig-name descname">atom</code><a class="headerlink" href="#darr.RaggedArray.atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimensions of the non-variable axes of the arrays.</p>
</dd></dl>

<dl class="py method">
<dt id="darr.RaggedArray.datadir">
<em class="property">property </em><code class="sig-name descname">datadir</code><a class="headerlink" href="#darr.RaggedArray.datadir" title="Permalink to this definition">¶</a></dt>
<dd><p>Data directory object with many useful methods, such as
writing information to text or json files, archiving all data,
calculating checksums etc.</p>
</dd></dl>

<dl class="py method">
<dt id="darr.RaggedArray.dtype">
<em class="property">property </em><code class="sig-name descname">dtype</code><a class="headerlink" href="#darr.RaggedArray.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>Numpy data type of the array values.</p>
</dd></dl>

<dl class="py method">
<dt id="darr.RaggedArray.iterappend">
<code class="sig-name descname">iterappend</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">arrayiterable</span></em><span class="sig-paren">)</span><a class="headerlink" href="#darr.RaggedArray.iterappend" title="Permalink to this definition">¶</a></dt>
<dd><p>Iteratively append data from a data iterable.</p>
<p>The iterable has to yield array-like objects compliant with darr.
The length of first dimension of these objects may be different,
but the length of other dimensions, if any, has to be the same.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arrayiterable</strong> (<em>an iterable that yield array-like objects</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="darr.RaggedArray.mb">
<em class="property">property </em><code class="sig-name descname">mb</code><a class="headerlink" href="#darr.RaggedArray.mb" title="Permalink to this definition">¶</a></dt>
<dd><p>Storage size in megabytes of the ragged array.</p>
</dd></dl>

<dl class="py method">
<dt id="darr.RaggedArray.metadata">
<em class="property">property </em><code class="sig-name descname">metadata</code><a class="headerlink" href="#darr.RaggedArray.metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of meta data.</p>
</dd></dl>

<dl class="py method">
<dt id="darr.RaggedArray.narrays">
<em class="property">property </em><code class="sig-name descname">narrays</code><a class="headerlink" href="#darr.RaggedArray.narrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Numpy data type of the array values.</p>
</dd></dl>

<dl class="py method">
<dt id="darr.RaggedArray.path">
<em class="property">property </em><code class="sig-name descname">path</code><a class="headerlink" href="#darr.RaggedArray.path" title="Permalink to this definition">¶</a></dt>
<dd><p>File system path to array data</p>
</dd></dl>

<dl class="py method">
<dt id="darr.RaggedArray.readcode">
<code class="sig-name descname">readcode</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">language</span></em><span class="sig-paren">)</span><a class="headerlink" href="#darr.RaggedArray.readcode" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate code to read the array in a different language.</p>
<p>Note that this does not include reading the metadata, which is just
based on a text file in JSON format.</p>
<dl class="simple">
<dt>language: str</dt><dd><p>One of the languages that are supported. Choose from:
‘matlab’, ‘numpymemmap’, ‘R’.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">darr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">darr</span><span class="o">.</span><span class="n">asraggedarray</span><span class="p">(</span><span class="s1">&#39;test.darr&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">]],</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">readcode</span><span class="p">(</span><span class="s1">&#39;matlab&#39;</span><span class="p">))</span>
<span class="go">fileid = fopen(&#39;indices/arrayvalues.bin&#39;);</span>
<span class="go">i = fread(fileid, [2, 4], &#39;*int64&#39;, &#39;ieee-le&#39;);</span>
<span class="go">fclose(fileid);</span>
<span class="go">fileid = fopen(&#39;values/arrayvalues.bin&#39;);</span>
<span class="go">v = fread(fileid, 10, &#39;*int32&#39;, &#39;ieee-le&#39;);</span>
<span class="go">fclose(fileid);</span>
<span class="go">% example to read third subarray</span>
<span class="go">startindex = i(1,3) + 1;  % matlab starts counting from 1</span>
<span class="go">endindex = i(2,3);  % matlab has inclusive end index</span>
<span class="go">a = v(startindex:endindex);</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="darr.RaggedArray.size">
<em class="property">property </em><code class="sig-name descname">size</code><a class="headerlink" href="#darr.RaggedArray.size" title="Permalink to this definition">¶</a></dt>
<dd><p>Total number of values in the data array.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="creating-ragged-arrays">
<h3><a class="toc-backref" href="#id10">Creating ragged arrays</a><a class="headerlink" href="#creating-ragged-arrays" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="darr.asraggedarray">
<code class="sig-prename descclassname">darr.</code><code class="sig-name descname">asraggedarray</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">arrayiterable</span></em>, <em class="sig-param"><span class="n">dtype</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">metadata</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">accessmode</span><span class="o">=</span><span class="default_value">'r+'</span></em>, <em class="sig-param"><span class="n">overwrite</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#darr.asraggedarray" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="darr.create_raggedarray">
<code class="sig-prename descclassname">darr.</code><code class="sig-name descname">create_raggedarray</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">atom</span><span class="o">=</span><span class="default_value">()</span></em>, <em class="sig-param"><span class="n">dtype</span><span class="o">=</span><span class="default_value">'float64'</span></em>, <em class="sig-param"><span class="n">metadata</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">accessmode</span><span class="o">=</span><span class="default_value">'r+'</span></em>, <em class="sig-param"><span class="n">overwrite</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#darr.create_raggedarray" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="deleting-ragged-arrays">
<h3><a class="toc-backref" href="#id11">Deleting ragged arrays</a><a class="headerlink" href="#deleting-ragged-arrays" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="darr.delete_raggedarray">
<code class="sig-prename descclassname">darr.</code><code class="sig-name descname">delete_raggedarray</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ra</span></em><span class="sig-paren">)</span><a class="headerlink" href="#darr.delete_raggedarray" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete Darr ragged array data from disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>path to data directory</em>) – </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="truncating-ragged-arrays">
<h3><a class="toc-backref" href="#id12">Truncating ragged arrays</a><a class="headerlink" href="#truncating-ragged-arrays" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="darr.truncate_raggedarray">
<code class="sig-prename descclassname">darr.</code><code class="sig-name descname">truncate_raggedarray</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ra</span></em>, <em class="sig-param"><span class="n">index</span></em><span class="sig-paren">)</span><a class="headerlink" href="#darr.truncate_raggedarray" title="Permalink to this definition">¶</a></dt>
<dd><p>Truncate darr ragged array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra</strong> (<em>array</em><em> or </em><em>str</em><em> or </em><em>pathlib.Path</em>) – The darr object to be truncated or file system path to it.</p></li>
<li><p><strong>index</strong> (<em>int</em>) – The index along the first axis at which the darr ragged array should
be truncated. Negative indices can be used but the resulting length of
the truncated darr should be 0 or larger and smaller than the
current length.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="releasenotes.html"
                        title="previous chapter">Release notes</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="releasenotes.html" title="Release notes"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">darr 0.4.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Darr API Documentation</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017-2022, Gabriel Beckers.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.1.2.
    </div>
  </body>
</html>