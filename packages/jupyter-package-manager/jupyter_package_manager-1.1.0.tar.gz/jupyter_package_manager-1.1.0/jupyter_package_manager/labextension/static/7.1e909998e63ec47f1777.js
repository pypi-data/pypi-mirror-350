"use strict";(self.webpackChunkpackage_manager=self.webpackChunkpackage_manager||[]).push([[7],{7:(e,n,a)=>{a.r(n),a.d(n,{default:()=>O});var t=a(345),r=a.n(t),s=a(655);const l=new s.LabIcon({name:"package-manager-icon",svgstr:'\n<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-package-export">\n  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>\n  <path d="M12 21l-8 -4.5v-9l8 -4.5l8 4.5v4.5" />\n  <path d="M12 12l8 -4.5" />\n  <path d="M12 12v9" />\n  <path d="M12 12l-8 -4.5" />\n  <path d="M15 18h7" />\n  <path d="M19 15l3 3l-3 3" />\n</svg>\n'}),o=(0,t.createContext)(null);function i(){return(0,t.useContext)(o)}function c({children:e,notebookWatcher:n}){const[a,s]=(0,t.useState)(n.notebookPanel());return(0,t.useEffect)((()=>{const e=(e,n)=>{s(n)};return n.notebookPanelChanged.connect(e),s(n.notebookPanel()),()=>{n.notebookPanelChanged.disconnect(e)}}),[n]),r().createElement(o.Provider,{value:a},e)}const m=(0,t.createContext)(null);function d({children:e,notebookWatcher:n}){const[a,s]=(0,t.useState)(n.kernelInfo);return(0,t.useEffect)((()=>{const e=(e,n)=>{s(n)};return n.kernelChanged.connect(e),s(n.kernelInfo),()=>{n.kernelChanged.disconnect(e)}}),[n]),r().createElement(m.Provider,{value:a},e)}const h=(0,t.createContext)(void 0),g=({children:e})=>{const n=i(),a=(0,t.useContext)(m),[s,l]=(0,t.useState)([]),[o,c]=(0,t.useState)(!1),[d,g]=(0,t.useState)(null),[u,p]=(0,t.useState)(""),k=(0,t.useCallback)((async()=>{var e,t,r;if(l([]),c(!0),g(null),n&&a)try{const a=null===(r=null===(t=null===(e=n.sessionContext)||void 0===e?void 0:e.session)||void 0===t?void 0:t.kernel)||void 0===r?void 0:r.requestExecute({code:'\ndef __list_packages():\n    from importlib.metadata import distributions\n    pkgs = []\n    seen = set()\n    for dist in distributions():\n        name = dist.metadata["Name"]\n        if name not in seen:\n            seen.add(name)\n            pkgs.append({"name": name, "version": dist.version})\n    return pkgs\n\n__list_packages()\n',store_history:!1});a&&(a.onIOPub=e=>{const n=e.header.msg_type;if("execute_result"===n||"display_data"===n||"update_display_data"===n){const n=e.content,a=n.data["application/json"],t=n.data["text/plain"];if(a)Array.isArray(a)?l(a):console.warn("Data is not JSON:",a),c(!1);else if(t)try{const e=t.replace(/^['"]|['"]$/g,"").replace(/'/g,'"'),n=JSON.parse(e);if(!Array.isArray(n))throw new Error("Error during parsing.");l([]),l(n),c(!1)}catch(e){console.error("Error during export JSON from text/plain:",e),g("Error during export JSON."),c(!1)}}})}catch(e){console.error("Unexpected error:",e),g("Unexpected error."),c(!1)}else c(!1)}),[n,a]);return(0,t.useEffect)((()=>{k()}),[k]),r().createElement(h.Provider,{value:{packages:s,loading:o,error:d,searchTerm:u,setSearchTerm:p,refreshPackages:k}},e)},u=()=>{const e=(0,t.useContext)(h);if(void 0===e)throw new Error("usePackageContext must be used within a PackageProvider");return e},p=()=>{const{searchTerm:e,setSearchTerm:n}=u();return r().createElement("div",{className:"mljar-packages-manager-search-bar-container"},r().createElement("input",{type:"text",value:e,onChange:e=>{n(e.target.value)},placeholder:"Search Package...",className:"mljar-packages-manager-search-bar-input"}))},k=new s.LabIcon({name:"my-delete-icon",svgstr:'\n<svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-trash"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 7l16 0" /><path d="M10 11l0 6" /><path d="M14 11l0 6" /><path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" /><path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" /></svg>\n'}),v=new s.LabIcon({name:"my-error-icon",svgstr:'\n<svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-zoom-exclamation"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" /><path d="M21 21l-6 -6" /><path d="M10 13v.01" /><path d="M10 7v3" /></svg>\n'}),_=({pkg:e})=>{const n=i(),{refreshPackages:a}=u(),[s,l]=(0,t.useState)(!1),[o,c]=(0,t.useState)(!1);return r().createElement("li",{className:"mljar-packages-manager-list-item"},r().createElement("span",{className:"mljar-packages-manager-package-name"}," ",e.name),r().createElement("span",{className:"mljar-packages-manager-package-version"},e.version),r().createElement("button",{className:"mljar-packages-manager-delete-button",onClick:async()=>{var t,r;let s=!1;if(s=window.electron?await window.electron.invoke("show-confirm-dialog",`Click "Ok" to confirm the deletion of ${e.name}.`):window.confirm(`Click "Ok" to confirm the deletion of ${e.name}.`),s){l(!0),c(!1);const s=(e=>`\ndef __remove_package():\n    import subprocess\n    import sys\n    python_exe = sys.executable\n    if python_exe.startswith('\\\\?'):\n        python_exe = python_exe[4:]\n    subprocess.check_call([python_exe, '-m', 'pip', 'uninstall', '-y', '${e}'])\n__remove_package()\n`)(e.name),o=null===(r=null===(t=null==n?void 0:n.sessionContext.session)||void 0===t?void 0:t.kernel)||void 0===r?void 0:r.requestExecute({code:s,store_history:!1});if(!o)return l(!1),void c(!0);o.onIOPub=e=>{const n=e.header.msg_type;if("stream"===n||"execute_result"===n||"display_data"===n||"update_display_data"===n){const n=e.content;n.text.includes("ERROR")?(c(!0),l(!1)):n.text.includes("Successfully uninstalled")&&(c(!1),c(!1),a())}else"error"===n&&(c(!0),l(!1))}}},"aria-label":o?`Error during uninstalling ${e.name}`:`Uninstall ${e.name}`,title:`Delete ${e.name}`},s?r().createElement("span",{className:"mljar-packages-manager-spinner"}):o?r().createElement(v.react,{className:"mljar-packages-manager-error-icon"}):r().createElement(k.react,{className:"mljar-packages-manager-delete-icon"})))},f=()=>{const{packages:e,searchTerm:n}=u(),a=e.filter((e=>e.name.toLowerCase().includes(n.toLowerCase())));return 0===a.length?r().createElement("p",null,"Any packages found or notebook is closed. Try refresh page or change kernel."):r().createElement("ul",{className:"mljar-packages-manager-list"},r().createElement("li",{className:"mljar-packages-manager-list-header"},r().createElement("span",{className:"mljar-packages-manager-header-name"},"Name"),r().createElement("span",{className:"mljar-packages-manager-header-version"},"Version"),r().createElement("span",{className:"mljar-packages-manager-header-blank"},"Â ")),a.sort(((e,n)=>e.name.localeCompare(n.name))).map((e=>r().createElement(_,{key:e.name,pkg:e}))))},b=()=>{const{loading:e,error:n}=u();return r().createElement("div",{className:"mljar-packages-manager-list-container"},e&&r().createElement("div",{className:"mljar-packages-manager-spinner-container"},r().createElement("div",{className:"mljar-packages-manager-spinner",role:"status","aria-label":"Loading"})),n&&r().createElement("p",{className:"mljar-packages-manager-error-message"},n),!e&&!n&&r().createElement(f,null))},w=new s.LabIcon({name:"my-refresh-icon",svgstr:'\n<svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-refresh"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4" /><path d="M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4" /></svg>\n'}),E=()=>{const{refreshPackages:e,loading:n}=u();return r().createElement("button",{className:"mljar-packages-manager-refresh-button",onClick:e,disabled:n,title:"Refresh Packages"},r().createElement(w.react,{className:"mljar-packages-manager-refresh-icon"}))},C=new s.LabIcon({name:"my-install-icon",svgstr:'\n<svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-cube-plus"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M21 12.5v-4.509a1.98 1.98 0 0 0 -1 -1.717l-7 -4.008a2.016 2.016 0 0 0 -2 0l-7 4.007c-.619 .355 -1 1.01 -1 1.718v8.018c0 .709 .381 1.363 1 1.717l7 4.008a2.016 2.016 0 0 0 2 0" /><path d="M12 22v-10" /><path d="M12 12l8.73 -5.04" /><path d="M3.27 6.96l8.73 5.04" /><path d="M16 19h6" /><path d="M19 16v6" /></svg>\n'}),x=({onStartInstall:e})=>{const{loading:n}=u();return r().createElement("button",{className:"mljar-packages-manager-install-button",onClick:e,disabled:n,title:"Install Package"},r().createElement(C.react,{className:"mljar-packages-manager-install-icon"}))},y=new s.LabIcon({name:"my-back-icon",svgstr:'\n<svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-arrow-back-up"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 14l-4 -4l4 -4" /><path d="M5 10h11a4 4 0 1 1 0 8h-1" /></svg>\n'}),N=({onBack:e})=>r().createElement("button",{className:"mljar-packages-manager-back-button",onClick:e,title:"Go Back"},r().createElement(y.react,{className:"mljar-packages-manager-back-icon"}),"Back"),j=e=>(null==e?void 0:e.toLowerCase().includes("success"))||(null==e?void 0:e.toLowerCase().includes("already"))||!1,P=()=>{const[e,n]=(0,t.useState)(""),[a,s]=(0,t.useState)(!1),[l,o]=(0,t.useState)(null),c=i(),{refreshPackages:m}=u();return r().createElement("div",{className:"mljar-packages-manager-install-form"},r().createElement("span",{className:"mljar-packages-manager-usage-span"},r().createElement("span",{style:{fontWeight:600}},"Usage: "),"Enter ",r().createElement("span",{style:{fontWeight:600,color:"#0099cc"}},"package_name")," or ",r().createElement("span",{style:{fontWeight:600,color:"#0099cc"}},"package_name==version")),r().createElement("input",{type:"text",value:e,onChange:e=>n(e.target.value),placeholder:"Enter package name...",className:"mljar-packages-manager-install-input"}),r().createElement("div",{className:"mljar-packages-manager-install-form-buttons"},r().createElement("button",{className:"mljar-packages-manager-install-submit-button",onClick:()=>{var n,a;s(!0),o(null);const t=`\ndef __check_if_installed():\n    from importlib.metadata import distributions\n    for dist in distributions():\n        if dist.metadata["Name"].lower() == "${e}".lower():\n            print("INSTALLED")\n            return\n    print("NOT_INSTALLED")\n__check_if_installed()\n`,r=null===(a=null===(n=null==c?void 0:c.sessionContext.session)||void 0===n?void 0:n.kernel)||void 0===a?void 0:a.requestExecute({code:t,store_history:!1});if(!r)return s(!1),void o("No kernel available.");r.onIOPub=n=>{const a=n.header.msg_type;if("stream"===a||"execute_result"===a||"display_data"===a||"update_display_data"===a){const a=n.content;a.text.includes("NOT_INSTALLED")?(()=>{var n,a;const t=`\ndef __install_pip():\n    import subprocess\n    import sys\n    python_exe = sys.executable\n    if python_exe.startswith('\\\\?'):\n        python_exe = python_exe[4:] \n    subprocess.check_call([python_exe, '-m', 'pip', 'install', '${e}'])\n__install_pip()\n`,r=null===(a=null===(n=null==c?void 0:c.sessionContext.session)||void 0===n?void 0:n.kernel)||void 0===a?void 0:a.requestExecute({code:t,store_history:!1});if(!r)return o("No kernel available."),void s(!1);r.onIOPub=e=>{const n=e.header.msg_type;if("stream"===n||"execute_result"===n||"display_data"===n||"update_display_data"===n){const n=e.content;n.text.includes("ERROR")?(o("Error installing the package."),s(!1)):n.text.includes("Successfully installed")&&(o("Package installed successfully."),s(!1),m())}else"error"===n&&(o("An error occurred during installation. Check the correctness of the package name."),s(!1))}})():a.text.includes("INSTALLED")&&(s(!1),o("Package is already installed."))}else"error"===a&&(s(!1),o("An error occurred while checking installation. Check the correctness of the package name."))}},disabled:a||""===e.trim()},a?"Processing...":"Install")),l&&r().createElement("p",{className:"mljar-packages-manager-install-message "+(j(l)?"success":"error")},l))},M=()=>{const[e,n]=(0,t.useState)("list");return r().createElement(g,null,r().createElement("div",{className:"mljar-packages-manager-container"},r().createElement("div",{className:"mljar-packages-manager-header-container"},"list"===e&&r().createElement("h3",{className:"mljar-packages-manager-header"},"Packages Manager"),"install"===e&&r().createElement("h3",{className:"mljar-packages-manager-header"},"Install Packages"),"list"===e&&r().createElement(E,null),"list"===e&&r().createElement(x,{onStartInstall:()=>{n("install")}}),"install"===e&&r().createElement(N,{onBack:()=>{n("list")}})),"list"===e?r().createElement("div",null,r().createElement(p,null),r().createElement(b,null)):r().createElement(P,null)))};class S extends s.ReactWidget{constructor(e){super(),this.notebookWatcher=e,this.id="package-manager::empty-sidebar",this.title.icon=l,this.title.caption="Package Manager",this.addClass("mljar-packages-manager-sidebar-widget")}render(){return r().createElement("div",{className:"mljar-packages-manager-sidebar-container"},r().createElement(c,{notebookWatcher:this.notebookWatcher},r().createElement(d,{notebookWatcher:this.notebookWatcher},r().createElement(M,null))))}}var I=a(123),L=a(602),A=a(470);class W{constructor(e){var n;this._kernelInfo=null,this._kernelChanged=new L.Signal(this),this._mainAreaWidget=null,this._selections=[],this._selectionChanged=new L.Signal(this),this._notebookPanel=null,this._notebookPanelChanged=new L.Signal(this),this._shell=e,null===(n=this._shell.currentChanged)||void 0===n||n.connect(((e,n)=>{this._mainAreaWidget=n.newValue,this._notebookPanel=this.notebookPanel(),this._notebookPanelChanged.emit(this._notebookPanel),this._attachKernelChangeHandler()}))}get selection(){return this._selections}get selectionChanged(){return this._selectionChanged}get notebookPanelChanged(){return this._notebookPanelChanged}get kernelInfo(){return this._kernelInfo}get kernelChanged(){return this._kernelChanged}notebookPanel(){const e=function(e){if(!(e instanceof A.DocumentWidget))return null;const{content:n}=e;return n instanceof I.Notebook?n:null}(this._mainAreaWidget);return e&&e.parent instanceof I.NotebookPanel?e.parent:null}_attachKernelChangeHandler(){if(this._notebookPanel){const e=this._notebookPanel.sessionContext.session;e?(e.kernelChanged.connect(this._onKernelChanged,this),this._updateKernelInfo(e.kernel)):setTimeout((()=>{var e;const n=null===(e=this._notebookPanel)||void 0===e?void 0:e.sessionContext.session;n?(n.kernelChanged.connect(this._onKernelChanged,this),this._updateKernelInfo(n.kernel)):console.warn("Session not initialized after delay")}),2e3)}else console.warn("Session not initalizated")}_onKernelChanged(e,n){n.newValue?this._updateKernelInfo(n.newValue):(this._kernelInfo=null,this._kernelChanged.emit(null))}_updateKernelInfo(e){this._kernelInfo={name:e.name,id:e.id},this._kernelChanged.emit(this._kernelInfo)}}const O={id:"package-manager:plugin",description:"A JupyterLab extension to list, remove and install python packages from pip.",autoStart:!0,activate:async e=>{const n=new W(e.shell);n.selectionChanged.connect(((e,n)=>{}));let a=function(e){return new S(e)}(n);e.shell.add(a,"left",{rank:1999})}}}}]);