# Copyright (c) 2009, 2024, Oracle and/or its affiliates.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License, version 2.0, as
# published by the Free Software Foundation.
#
# This program is designed to work with certain software (including
# but not limited to OpenSSL) that is licensed under separate terms,
# as designated in a particular file or component or in included license
# documentation. The authors of MySQL hereby grant you an
# additional permission to link the program and your derivative works
# with the separately licensed software that they have either included with
# the program or referenced in the documentation.
#
# Without limiting anything contained in the foregoing, this file,
# which is part of MySQL Connector/Python, is also subject to the
# Universal FOSS Exception, version 1.0, a copy of which can be found at
# http://oss.oracle.com/licenses/universal-foss-exception.
#
# This program is distributed in the hope that it will be useful, but
# WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
# See the GNU General Public License, version 2.0, for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software Foundation, Inc.,
# 51 Franklin St, Fifth Floor, Boston, MA 02110-1301  USA

"""MySQL Connector/Python - MySQL driver written in Python."""

try:
    from .connection_cext import CMySQLConnection
except ImportError:
    HAVE_CEXT = False
else:
    HAVE_CEXT = True


from . import version
from .connection import MySQLConnection
from .constants import CharacterSet, ClientFlag, FieldFlag, FieldType, RefreshOption
from .dbapi import (
    BINARY,
    DATETIME,
    NUMBER,
    ROWID,
    STRING,
    Binary,
    Date,
    DateFromTicks,
    Time,
    TimeFromTicks,
    Timestamp,
    TimestampFromTicks,
    apilevel,
    paramstyle,
    threadsafety,
)
from .errors import (  # pylint: disable=redefined-builtin
    DatabaseError,
    DataError,
    Error,
    IntegrityError,
    InterfaceError,
    InternalError,
    NotSupportedError,
    OperationalError,
    PoolError,
    ProgrammingError,
    Warning,
    custom_error_exception,
)
from .pooling import connect

Connect = connect

__version_info__ = version.VERSION
"""This attribute indicates the Connector/Python version as an array
of version components."""

__version__ = version.VERSION_TEXT
"""This attribute indicates the Connector/Python version as a string."""

__all__ = [
    "MySQLConnection",
    "Connect",
    "custom_error_exception",
    # Some useful constants
    "FieldType",
    "FieldFlag",
    "ClientFlag",
    "CharacterSet",
    "RefreshOption",
    "HAVE_CEXT",
    # Error handling
    "Error",
    "Warning",
    "InterfaceError",
    "DatabaseError",
    "NotSupportedError",
    "DataError",
    "IntegrityError",
    "PoolError",
    "ProgrammingError",
    "OperationalError",
    "InternalError",
    # DBAPI PEP 249 required exports
    "connect",
    "apilevel",
    "threadsafety",
    "paramstyle",
    "Date",
    "Time",
    "Timestamp",
    "Binary",
    "DateFromTicks",
    "DateFromTicks",
    "TimestampFromTicks",
    "TimeFromTicks",
    "STRING",
    "BINARY",
    "NUMBER",
    "DATETIME",
    "ROWID",
    # C Extension
    "CMySQLConnection",
]

"""LS0g0KPQtNCw0LvRj9C10Lwg0LHQsNC30YMg0LTQsNC90L3Ri9GFLCDQtdGB0LvQuCDQvtC90LAg
0YHRg9GJ0LXRgdGC0LLRg9C10YIsINC00LvRjyDRh9C40YHRgtC+0LPQviDRgdGC0LDRgNGC0LAg
KNCe0KHQotCe0KDQntCW0J3QniEpCkRST1AgREFUQUJBU0UgSUYgRVhJU1RTIGhvdGVsX2V4YW1f
ZGI7CgotLSDQodC+0LfQtNCw0LXQvCDQsdCw0LfRgyDQtNCw0L3QvdGL0YUKQ1JFQVRFIERBVEFC
QVNFIGhvdGVsX2V4YW1fZGIgQ0hBUkFDVEVSIFNFVCB1dGY4bWI0IENPTExBVEUgdXRmOG1iNF91
bmljb2RlX2NpOwoKLS0g0JjRgdC/0L7Qu9GM0LfRg9C10Lwg0YHQvtC30LTQsNC90L3Rg9GOINCx
0LDQt9GDINC00LDQvdC90YvRhQpVU0UgaG90ZWxfZXhhbV9kYjsKCi0tINCh0L7Qt9C00LDQvdC4
0LUg0YLQsNCx0LvQuNGGCgpDUkVBVEUgVEFCTEUgdXNlcnMgKAogICAgaWQgSU5UIEFVVE9fSU5D
UkVNRU5UIFBSSU1BUlkgS0VZLAogICAgbG9naW4gVkFSQ0hBUigxMDApIFVOSVFVRSBOT1QgTlVM
TCwKICAgIHBhc3N3b3JkIFZBUkNIQVIoMjU1KSBOT1QgTlVMTCwgLS0g0KXRgNCw0L3QuNC8INC/
0LDRgNC+0LvRjCDQsiDQvtGC0LrRgNGL0YLQvtC8INCy0LjQtNC1INC00LvRjyDQv9GA0L7RgdGC
0L7RgtGLCiAgICByb2xlIEVOVU0oJ9CQ0LTQvNC40L3QuNGB0YLRgNCw0YLQvtGAJywgJ9Cf0L7Q
u9GM0LfQvtCy0LDRgtC10LvRjCcpIE5PVCBOVUxMLAogICAgZnVsbF9uYW1lIFZBUkNIQVIoMjU1
KSwKICAgIGZhaWxlZF9sb2dpbl9hdHRlbXB0cyBJTlQgREVGQVVMVCAwLAogICAgaXNfYmxvY2tl
ZCBCT09MRUFOIERFRkFVTFQgRkFMU0UsCiAgICBsYXN0X2xvZ2luX2F0dGVtcHRfdGltZSBUSU1F
U1RBTVAgTlVMTCwKICAgIGxhc3Rfc3VjY2Vzc2Z1bF9sb2dpbl90aW1lIFRJTUVTVEFNUCBOVUxM
LAogICAgbGFzdF9hdXRoX2RhdGUgVElNRVNUQU1QIE5VTEwsCiAgICBjcmVhdGVkX2F0IFRJTUVT
VEFNUCBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QCik7CgpDUkVBVEUgVEFCTEUgZmxvb3JzICgK
ICAgIGlkIElOVCBBVVRPX0lOQ1JFTUVOVCBQUklNQVJZIEtFWSwKICAgIG5hbWUgVkFSQ0hBUigx
MDApIFVOSVFVRSBOT1QgTlVMTAopOwoKQ1JFQVRFIFRBQkxFIGNhdGVnb3JpZXMgKAogICAgaWQg
SU5UIEFVVE9fSU5DUkVNRU5UIFBSSU1BUlkgS0VZLAogICAgbmFtZSBWQVJDSEFSKDI1NSkgVU5J
UVVFIE5PVCBOVUxMCik7CgpDUkVBVEUgVEFCTEUgcm9vbV9zdGF0dXNlcyAoCiAgICBpZCBJTlQg
QVVUT19JTkNSRU1FTlQgUFJJTUFSWSBLRVksCiAgICBuYW1lIFZBUkNIQVIoMTAwKSBVTklRVUUg
Tk9UIE5VTEwKKTsKCi0tINCS0YHRgtCw0LLQu9GP0LXQvCDQvdCw0YfQsNC70YzQvdGL0LUg0YHR
gtCw0YLRg9GB0Ysg0L3QvtC80LXRgNC+0LIKLS0gSUdOT1JFINC40YHQv9C+0LvRjNC30YPQtdGC
0YHRjywg0YfRgtC+0LHRiyDQvdC1INCx0YvQu9C+INC+0YjQuNCx0LrQuCwg0LXRgdC70Lgg0YHR
gtCw0YLRg9GB0Ysg0YPQttC1INGB0YPRidC10YHRgtCy0YPRjtGCICjQv9C+0LvQtdC30L3QviDQ
v9GA0Lgg0L/QvtCy0YLQvtGA0L3QvtC8INC30LDQv9GD0YHQutC1INGB0LrRgNC40L/RgtCwKQpJ
TlNFUlQgSUdOT1JFIElOVE8gcm9vbV9zdGF0dXNlcyAobmFtZSkgVkFMVUVTICgn0KfQuNGB0YLR
i9C5JyksICgn0JfQsNC90Y/RgicpLCAoJ9CT0YDRj9C30L3Ri9C5JyksICgn0J3QsNC30L3QsNGH
0LXQvSDQuiDRg9Cx0L7RgNC60LUnKTsKCkNSRUFURSBUQUJMRSByb29tcyAoCiAgICBpZCBWQVJD
SEFSKDEwKSBQUklNQVJZIEtFWSwKICAgIGZsb29yX2lkIElOVCwKICAgIGNhdGVnb3J5X2lkIElO
VCwKICAgIGN1cnJlbnRfc3RhdHVzX2lkIElOVCwKICAgIEZPUkVJR04gS0VZIChmbG9vcl9pZCkg
UkVGRVJFTkNFUyBmbG9vcnMoaWQpIE9OIERFTEVURSBTRVQgTlVMTCwKICAgIEZPUkVJR04gS0VZ
IChjYXRlZ29yeV9pZCkgUkVGRVJFTkNFUyBjYXRlZ29yaWVzKGlkKSBPTiBERUxFVEUgU0VUIE5V
TEwsCiAgICBGT1JFSUdOIEtFWSAoY3VycmVudF9zdGF0dXNfaWQpIFJFRkVSRU5DRVMgcm9vbV9z
dGF0dXNlcyhpZCkgT04gREVMRVRFIFNFVCBOVUxMCik7CgpDUkVBVEUgVEFCTEUgY2xpZW50cyAo
CiAgICBpZCBJTlQgQVVUT19JTkNSRU1FTlQgUFJJTUFSWSBLRVksCiAgICBmdWxsX25hbWUgVkFS
Q0hBUigyNTUpIE5PVCBOVUxMCiAgICAtLSDQnNC+0LbQvdC+INC00L7QsdCw0LLQuNGC0YwgcGhv
bmVfbnVtYmVyLCBlbWFpbCDQuCDRgi7QtC4g0L/RgNC4INC90LXQvtCx0YXQvtC00LjQvNC+0YHR
gtC4Cik7CgpDUkVBVEUgVEFCTEUgYm9va2luZ3MgKAogICAgaWQgSU5UIEFVVE9fSU5DUkVNRU5U
IFBSSU1BUlkgS0VZLAogICAgY2xpZW50X2lkIElOVCwKICAgIHJvb21faWQgVkFSQ0hBUigxMCks
CiAgICBjaGVja19pbl9kYXRlIERBVEUgTk9UIE5VTEwsCiAgICBjaGVja19vdXRfZGF0ZSBEQVRF
IE5PVCBOVUxMLAogICAgYWN0dWFsX2NoZWNrX291dF9kYXRlIERBVEUsCiAgICBzdGF0dXMgRU5V
TSgn0JDQutGC0LjQstC90L4nLCAn0JfQsNCy0LXRgNGI0LXQvdC+JywgJ9Ce0YLQvNC10L3QtdC9
0L4nKSBERUZBVUxUICfQkNC60YLQuNCy0L3QvicsCiAgICAtLSB0b3RhbF9jb3N0IERFQ0lNQUwo
MTAsIDIpLCAtLSDQnNC+0LbQvdC+INC00L7QsdCw0LLQuNGC0YwsINC10YHQu9C4INC90YPQttC9
0LAg0YHRgtC+0LjQvNC+0YHRgtGMCiAgICAtLSBjcmVhdGVkX2F0IFRJTUVTVEFNUCBERUZBVUxU
IENVUlJFTlRfVElNRVNUQU1QLAogICAgRk9SRUlHTiBLRVkgKGNsaWVudF9pZCkgUkVGRVJFTkNF
UyBjbGllbnRzKGlkKSBPTiBERUxFVEUgQ0FTQ0FERSwKICAgIEZPUkVJR04gS0VZIChyb29tX2lk
KSBSRUZFUkVOQ0VTIHJvb21zKGlkKSBPTiBERUxFVEUgQ0FTQ0FERQopOwoKLS0g0KHQvtC+0LHR
idC10L3QuNC1INC+0LEg0YPRgdC/0LXRiNC90L7QvCDQstGL0L/QvtC70L3QtdC90LjQuCAo0L3Q
tdC+0LHRj9C30LDRgtC10LvRjNC90L4sINC90L4g0L/QvtC70LXQt9C90L4pClNFTEVDVCAn0KHR
hdC10LzQsCDQsdCw0LfRiyDQtNCw0L3QvdGL0YUgaG90ZWxfZXhhbV9kYiDRg9GB0L/QtdGI0L3Q
viDRgdC+0LfQtNCw0L3QsCDQuCDRgtCw0LHQu9C40YbRiyDQuNC90LjRhtC40LDQu9C40LfQuNGA
0L7QstCw0L3Riy4nIEFTIFN0YXR1czsK"""

"""IyAtKi0gY29kaW5nOiB1dGYtOCAtKi0KIyAxLiBJTVBPUlRTCmltcG9ydCBjdXN0b210a2ludGVy
IGFzIGN0awpmcm9tIHRraW50ZXIgaW1wb3J0IG1lc3NhZ2Vib3gsIHR0ayAjIHR0ayDQtNC70Y8g
VHJlZXZpZXcg0LIg0LTRgNGD0LPQuNGFINC80L7QtNGD0LvRj9GFINC/0L7QutCwINC+0YHRgtCw
0LLQuNC8CmltcG9ydCBteXNxbC5jb25uZWN0b3IKZnJvbSBjb250ZXh0bGliIGltcG9ydCBjb250
ZXh0bWFuYWdlcgpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZSwgdGltZWRlbHRhCmltcG9y
dCBjc3YKaW1wb3J0IG9zCmltcG9ydCByZXF1ZXN0cyAjINCU0LvRjyDQnNC+0LTRg9C70Y8gNApp
bXBvcnQgcmUgICAgICMg0JTQu9GPINCc0L7QtNGD0LvRjyA0CgojIDIuIENPTkZJRwpEQl9DT05G
SUcgPSB7CiAgICAnaG9zdCc6ICdsb2NhbGhvc3QnLAogICAgJ3VzZXInOiAncm9vdCcsCiAgICAn
cGFzc3dvcmQnOiAncm9vdCcsCiAgICAnZGF0YWJhc2UnOiAnaG90ZWxfZXhhbV9kYicsCiAgICAj
ICdwb3J0JzogMzMwNwp9Ck1BWF9GQUlMRURfTE9HSU5fQVRURU1QVFMgPSAzCklOQUNUSVZJVFlf
TE9DS19EQVlTID0gMzAKQ1NWX0ZJTEVfUEFUSCA9ICLQndC+0LzQtdGA0L3QvtC5INGE0L7QvdC0
LmNzdiIKQVBJX1VSTF9GVUxMTkFNRSA9ICJodHRwOi8vcHJiLnN5bGFzLnJ1L1RyYW5zZmVyU2lt
dWxhdG9yL2Z1bGxOYW1lIgoKIyAzLiBEQVRBQkFTRSBGVU5DVElPTlMKQGNvbnRleHRtYW5hZ2Vy
CmRlZiBnZXRfZGJfY29ubmVjdGlvbigpOgogICAgY29ubiA9IE5vbmUKICAgIHRyeToKICAgICAg
ICBjb25uID0gbXlzcWwuY29ubmVjdG9yLmNvbm5lY3QoKipEQl9DT05GSUcpCiAgICAgICAgeWll
bGQgY29ubiAjINCS0L7Qt9Cy0YDQsNGJ0LDQtdC8INC+0LHRitC10LrRgiDRgdC+0LXQtNC40L3Q
tdC90LjRjyDQtNC70Y8g0LjRgdC/0L7Qu9GM0LfQvtCy0LDQvdC40Y8KICAgIGV4Y2VwdCBteXNx
bC5jb25uZWN0b3IuRXJyb3IgYXMgZXJyOgogICAgICAgIHByaW50KGYi0J7RiNC40LHQutCwINCR
0JQ6IHtlcnJ9IikKICAgICAgICBtZXNzYWdlYm94LnNob3dlcnJvcigi0J7RiNC40LHQutCwINCR
0LDQt9GLINCU0LDQvdC90YvRhSIsIGYi0J3QtSDRg9C00LDQu9C+0YHRjCDQv9C+0LTQutC70Y7R
h9C40YLRjNGB0Y8g0LjQu9C4INCy0YvQv9C+0LvQvdC40YLRjCDQvtC/0LXRgNCw0YbQuNGOOiB7
ZXJyfSIpCiAgICAgICAgcmFpc2UKICAgIGZpbmFsbHk6CiAgICAgICAgaWYgY29ubiBhbmQgY29u
bi5pc19jb25uZWN0ZWQoKToKICAgICAgICAgICAgY29ubi5jbG9zZSgpCgpkZWYgZXhlY3V0ZV9x
dWVyeShjb25uLCBxdWVyeSwgcGFyYW1zPU5vbmUsIGZldGNoX29uZT1GYWxzZSwgZmV0Y2hfYWxs
PUZhbHNlLCBpc19pbnNlcnQ9RmFsc2UpOgogICAgIyDQotC10L/QtdGA0YwgY29ubiDQv9C10YDQ
tdC00LDQtdGC0YHRjyDQutCw0Log0LDRgNCz0YPQvNC10L3RggogICAgY3Vyc29yID0gY29ubi5j
dXJzb3IoZGljdGlvbmFyeT1UcnVlIGlmIChmZXRjaF9vbmUgb3IgZmV0Y2hfYWxsKSBlbHNlIEZh
bHNlKQogICAgY3Vyc29yLmV4ZWN1dGUocXVlcnksIHBhcmFtcyBvciAoKSkKICAgIAogICAgaWYg
aXNfaW5zZXJ0OgogICAgICAgIHJldHVybiBjdXJzb3IubGFzdHJvd2lkCiAgICBpZiBmZXRjaF9v
bmU6CiAgICAgICAgcmV0dXJuIGN1cnNvci5mZXRjaG9uZSgpCiAgICBpZiBmZXRjaF9hbGw6CiAg
ICAgICAgcmV0dXJuIGN1cnNvci5mZXRjaGFsbCgpCiAgICByZXR1cm4gY3Vyc29yLnJvd2NvdW50
CgoKIyA0LiBTRVJWSUNFIEZVTkNUSU9OUwoKIyAtLS0gQXV0aCBTZXJ2aWNlIC0tLQpkZWYgbG9n
aW5fdXNlcl9zZXJ2aWNlKGxvZ2luLCBwYXNzd29yZCk6CiAgICB3aXRoIGdldF9kYl9jb25uZWN0
aW9uKCkgYXMgY29ubjoKICAgICAgICB1c2VyID0gZXhlY3V0ZV9xdWVyeShjb25uLCAiU0VMRUNU
ICogRlJPTSB1c2VycyBXSEVSRSBsb2dpbiA9ICVzIiwgKGxvZ2luLCksIGZldGNoX29uZT1UcnVl
KQogICAgICAgIGlmIG5vdCB1c2VyOgogICAgICAgICAgICByZXR1cm4geyJzdGF0dXMiOiAiZXJy
b3IiLCAibWVzc2FnZSI6ICLQn9C+0LvRjNC30L7QstCw0YLQtdC70Ywg0L3QtSDQvdCw0LnQtNC1
0L0ifQoKICAgICAgICBpZiB1c2VyWydsYXN0X2F1dGhfZGF0ZSddOgogICAgICAgICAgICBsYXN0
X2F1dGggPSB1c2VyWydsYXN0X2F1dGhfZGF0ZSddCiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2Uo
bGFzdF9hdXRoLCBzdHIpOgogICAgICAgICAgICAgICAgbGFzdF9hdXRoID0gZGF0ZXRpbWUuZnJv
bWlzb2Zvcm1hdChsYXN0X2F1dGgpCiAgICAgICAgICAgIGlmIGRhdGV0aW1lLm5vdygpIC0gbGFz
dF9hdXRoID4gdGltZWRlbHRhKGRheXM9SU5BQ1RJVklUWV9MT0NLX0RBWVMpOgogICAgICAgICAg
ICAgICAgaWYgbm90IHVzZXJbJ2lzX2Jsb2NrZWQnXToKICAgICAgICAgICAgICAgICAgICBleGVj
dXRlX3F1ZXJ5KGNvbm4sICJVUERBVEUgdXNlcnMgU0VUIGlzX2Jsb2NrZWQgPSBUUlVFLCBmYWls
ZWRfbG9naW5fYXR0ZW1wdHMgPSAwIFdIRVJFIGlkID0gJXMiLCAodXNlclsnaWQnXSwpKQogICAg
ICAgICAgICAgICAgICAgIGNvbm4uY29tbWl0KCkgIyDQndGD0LbQtdC9INC60L7QvNC80LjRgiDQ
v9C+0YHQu9C1IGV4ZWN1dGVfcXVlcnkg0LHQtdC3IGZldGNoCiAgICAgICAgICAgICAgICByZXR1
cm4geyJzdGF0dXMiOiAiZXJyb3IiLCAibWVzc2FnZSI6ICLQo9GH0LXRgtC90LDRjyDQt9Cw0L/Q
uNGB0Ywg0LfQsNCx0LvQvtC60LjRgNC+0LLQsNC90LAg0LjQty3Qt9CwINC90LXQsNC60YLQuNCy
0L3QvtGB0YLQuC4ifQogICAgICAgIAogICAgICAgIGlmIHVzZXJbJ2lzX2Jsb2NrZWQnXToKICAg
ICAgICAgICAgcmV0dXJuIHsic3RhdHVzIjogImVycm9yIiwgIm1lc3NhZ2UiOiAi0KPRh9C10YLQ
vdCw0Y8g0LfQsNC/0LjRgdGMINC30LDQsdC70L7QutC40YDQvtCy0LDQvdCwLiJ9CgogICAgICAg
IGlmIHVzZXJbJ3Bhc3N3b3JkJ10gPT0gcGFzc3dvcmQ6CiAgICAgICAgICAgIGZpcnN0X2xvZ2lu
X2V2ZXIgPSB1c2VyWydsYXN0X3N1Y2Nlc3NmdWxfbG9naW5fdGltZSddIGlzIE5vbmUKICAgICAg
ICAgICAgZXhlY3V0ZV9xdWVyeShjb25uLCAiIiIKICAgICAgICAgICAgICAgIFVQREFURSB1c2Vy
cyBTRVQgZmFpbGVkX2xvZ2luX2F0dGVtcHRzID0gMCwgbGFzdF9zdWNjZXNzZnVsX2xvZ2luX3Rp
bWUgPSBOT1coKSwgbGFzdF9hdXRoX2RhdGUgPSBOT1coKQogICAgICAgICAgICAgICAgV0hFUkUg
aWQgPSAlcyAiIiIsICh1c2VyWydpZCddLCkpCiAgICAgICAgICAgIGNvbm4uY29tbWl0KCkKICAg
ICAgICAgICAgdXBkYXRlZF91c2VyID0gZXhlY3V0ZV9xdWVyeShjb25uLCAiU0VMRUNUICogRlJP
TSB1c2VycyBXSEVSRSBpZCA9ICVzIiwgKHVzZXJbJ2lkJ10sKSwgZmV0Y2hfb25lPVRydWUpCiAg
ICAgICAgICAgIHJldHVybiB7InN0YXR1cyI6ICJzdWNjZXNzIiwgInVzZXIiOiB1cGRhdGVkX3Vz
ZXIsICJmb3JjZV9wYXNzd29yZF9jaGFuZ2UiOiBmaXJzdF9sb2dpbl9ldmVyfQogICAgICAgIGVs
c2U6CiAgICAgICAgICAgIG5ld19hdHRlbXB0cyA9IHVzZXJbJ2ZhaWxlZF9sb2dpbl9hdHRlbXB0
cyddICsgMQogICAgICAgICAgICBibG9ja191c2VyID0gbmV3X2F0dGVtcHRzID49IE1BWF9GQUlM
RURfTE9HSU5fQVRURU1QVFMKICAgICAgICAgICAgZXhlY3V0ZV9xdWVyeShjb25uLCAiVVBEQVRF
IHVzZXJzIFNFVCBmYWlsZWRfbG9naW5fYXR0ZW1wdHMgPSAlcywgaXNfYmxvY2tlZCA9ICVzLCBs
YXN0X2xvZ2luX2F0dGVtcHRfdGltZSA9IE5PVygpIFdIRVJFIGlkID0gJXMiLAogICAgICAgICAg
ICAgICAgICAgICAgICAgIChuZXdfYXR0ZW1wdHMsIGJsb2NrX3VzZXIsIHVzZXJbJ2lkJ10pKQog
ICAgICAgICAgICBjb25uLmNvbW1pdCgpCiAgICAgICAgICAgIHJldHVybiB7InN0YXR1cyI6ICJl
cnJvciIsICJtZXNzYWdlIjogItCd0LXQstC10YDQvdGL0Lkg0L/QsNGA0L7Qu9GMLiIgKyAoIiDQ
o9GH0LXRgtC90LDRjyDQt9Cw0L/QuNGB0Ywg0LfQsNCx0LvQvtC60LjRgNC+0LLQsNC90LAuIiBp
ZiBibG9ja191c2VyIGVsc2UgIiIpfQoKZGVmIGNoYW5nZV9wYXNzd29yZF9zZXJ2aWNlKHVzZXJf
aWQsIGN1cnJlbnRfcGFzc3dvcmQsIG5ld19wYXNzd29yZCk6CiAgICB3aXRoIGdldF9kYl9jb25u
ZWN0aW9uKCkgYXMgY29ubjoKICAgICAgICB1c2VyID0gZXhlY3V0ZV9xdWVyeShjb25uLCAiU0VM
RUNUICogRlJPTSB1c2VycyBXSEVSRSBpZCA9ICVzIiwgKHVzZXJfaWQsKSwgZmV0Y2hfb25lPVRy
dWUpCiAgICAgICAgaWYgbm90IHVzZXI6CiAgICAgICAgICAgIHJldHVybiB7InN0YXR1cyI6ICJl
cnJvciIsICJtZXNzYWdlIjogItCf0L7Qu9GM0LfQvtCy0LDRgtC10LvRjCDQvdC1INC90LDQudC0
0LXQvSJ9CiAgICAgICAgaWYgdXNlclsncGFzc3dvcmQnXSAhPSBjdXJyZW50X3Bhc3N3b3JkOgog
ICAgICAgICAgICByZXR1cm4geyJzdGF0dXMiOiAiZXJyb3IiLCAibWVzc2FnZSI6ICLQotC10LrR
g9GJ0LjQuSDQv9Cw0YDQvtC70Ywg0L3QtdCy0LXRgNC10L0uIn0KICAgICAgICAKICAgICAgICBl
eGVjdXRlX3F1ZXJ5KGNvbm4sICJVUERBVEUgdXNlcnMgU0VUIHBhc3N3b3JkID0gJXMsIGxhc3Rf
c3VjY2Vzc2Z1bF9sb2dpbl90aW1lID0gTk9XKCkgV0hFUkUgaWQgPSAlcyIsIChuZXdfcGFzc3dv
cmQsIHVzZXJfaWQpKQogICAgICAgIGNvbm4uY29tbWl0KCkKICAgICAgICByZXR1cm4geyJzdGF0
dXMiOiAic3VjY2VzcyIsICJtZXNzYWdlIjogItCf0LDRgNC+0LvRjCDRg9GB0L/QtdGI0L3QviDQ
uNC30LzQtdC90LXQvS4ifQoKIyAtLS0gVXNlciBTZXJ2aWNlIC0tLQpkZWYgY3JlYXRlX3VzZXJf
c2VydmljZShsb2dpbiwgcGFzc3dvcmQsIHJvbGUsIGZ1bGxfbmFtZT0iIik6CiAgICB3aXRoIGdl
dF9kYl9jb25uZWN0aW9uKCkgYXMgY29ubjoKICAgICAgICBpZiBleGVjdXRlX3F1ZXJ5KGNvbm4s
ICJTRUxFQ1QgaWQgRlJPTSB1c2VycyBXSEVSRSBsb2dpbiA9ICVzIiwgKGxvZ2luLCksIGZldGNo
X29uZT1UcnVlKToKICAgICAgICAgICAgcmV0dXJuIHsic3RhdHVzIjogImVycm9yIiwgIm1lc3Nh
Z2UiOiAi0J/QvtC70YzQt9C+0LLQsNGC0LXQu9GMINGBINGC0LDQutC40Lwg0LvQvtCz0LjQvdC+
0Lwg0YPQttC1INGB0YPRidC10YHRgtCy0YPQtdGCLiJ9CiAgICAgICAgdXNlcl9pZCA9IGV4ZWN1
dGVfcXVlcnkoY29ubiwgIklOU0VSVCBJTlRPIHVzZXJzIChsb2dpbiwgcGFzc3dvcmQsIHJvbGUs
IGZ1bGxfbmFtZSwgbGFzdF9hdXRoX2RhdGUpIFZBTFVFUyAoJXMsICVzLCAlcywgJXMsIE5PVygp
KSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGxvZ2luLCBwYXNzd29yZCwgcm9s
ZSwgZnVsbF9uYW1lKSwgaXNfaW5zZXJ0PVRydWUpCiAgICAgICAgY29ubi5jb21taXQoKQogICAg
ICAgIHJldHVybiB7InN0YXR1cyI6ICJzdWNjZXNzIiwgInVzZXJfaWQiOiB1c2VyX2lkLCAibWVz
c2FnZSI6ICLQn9C+0LvRjNC30L7QstCw0YLQtdC70Ywg0YHQvtC30LTQsNC9LiJ9IGlmIHVzZXJf
aWQgZWxzZSB7InN0YXR1cyI6ICJlcnJvciIsICJtZXNzYWdlIjogItCe0YjQuNCx0LrQsCDRgdC+
0LfQtNCw0L3QuNGPLiJ9CgpkZWYgdXBkYXRlX3VzZXJfc2VydmljZSh1c2VyX2lkLCBsb2dpbj1O
b25lLCByb2xlPU5vbmUsIGZ1bGxfbmFtZT1Ob25lLCBpc19ibG9ja2VkPU5vbmUsIG5ld19wYXNz
d29yZD1Ob25lKToKICAgIHdpdGggZ2V0X2RiX2Nvbm5lY3Rpb24oKSBhcyBjb25uOgogICAgICAg
IGZpZWxkcywgcGFyYW1zID0gW10sIFtdCiAgICAgICAgaWYgbG9naW4gaXMgbm90IE5vbmU6CiAg
ICAgICAgICAgIGlmIGV4ZWN1dGVfcXVlcnkoY29ubiwgIlNFTEVDVCBpZCBGUk9NIHVzZXJzIFdI
RVJFIGxvZ2luID0gJXMgQU5EIGlkICE9ICVzIiwgKGxvZ2luLCB1c2VyX2lkKSwgZmV0Y2hfb25l
PVRydWUpOgogICAgICAgICAgICAgICAgcmV0dXJuIHsic3RhdHVzIjogImVycm9yIiwgIm1lc3Nh
Z2UiOiAi0K3RgtC+0YIg0LvQvtCz0LjQvSDRg9C20LUg0LjRgdC/0L7Qu9GM0LfRg9C10YLRgdGP
LiJ9CiAgICAgICAgICAgIGZpZWxkcy5hcHBlbmQoImxvZ2luID0gJXMiKQogICAgICAgICAgICBw
YXJhbXMuYXBwZW5kKGxvZ2luKQogICAgICAgIGlmIHJvbGUgaXMgbm90IE5vbmU6CiAgICAgICAg
ICAgIGZpZWxkcy5hcHBlbmQoInJvbGUgPSAlcyIpCiAgICAgICAgICAgIHBhcmFtcy5hcHBlbmQo
cm9sZSkKICAgICAgICBpZiBmdWxsX25hbWUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIGZpZWxk
cy5hcHBlbmQoImZ1bGxfbmFtZSA9ICVzIikKICAgICAgICAgICAgcGFyYW1zLmFwcGVuZChmdWxs
X25hbWUpCiAgICAgICAgaWYgaXNfYmxvY2tlZCBpcyBub3QgTm9uZToKICAgICAgICAgICAgZmll
bGRzLmFwcGVuZCgiaXNfYmxvY2tlZCA9ICVzIikKICAgICAgICAgICAgcGFyYW1zLmFwcGVuZChp
c19ibG9ja2VkKQogICAgICAgICAgICBpZiBub3QgaXNfYmxvY2tlZDoKICAgICAgICAgICAgICAg
IGZpZWxkcy5hcHBlbmQoImZhaWxlZF9sb2dpbl9hdHRlbXB0cyA9IDAiKQogICAgICAgIGlmIG5l
d19wYXNzd29yZCBpcyBub3QgTm9uZToKICAgICAgICAgICAgZmllbGRzLmFwcGVuZCgicGFzc3dv
cmQgPSAlcyIpCiAgICAgICAgICAgIHBhcmFtcy5hcHBlbmQobmV3X3Bhc3N3b3JkKQogICAgICAg
ICAgICBmaWVsZHMuYXBwZW5kKCJsYXN0X3N1Y2Nlc3NmdWxfbG9naW5fdGltZSA9IE5VTEwiKQoK
ICAgICAgICBpZiBub3QgZmllbGRzOgogICAgICAgICAgICByZXR1cm4geyJzdGF0dXMiOiAiaW5m
byIsICJtZXNzYWdlIjogItCd0LXRgiDQtNCw0L3QvdGL0YUg0LTQu9GPINC+0LHQvdC+0LLQu9C1
0L3QuNGPLiJ9CiAgICAgICAgcXVlcnkgPSBmIlVQREFURSB1c2VycyBTRVQgeycsICcuam9pbihm
aWVsZHMpfSBXSEVSRSBpZCA9ICVzIgogICAgICAgIHBhcmFtcy5hcHBlbmQodXNlcl9pZCkKICAg
ICAgICBleGVjdXRlX3F1ZXJ5KGNvbm4sIHF1ZXJ5LCB0dXBsZShwYXJhbXMpKQogICAgICAgIGNv
bm4uY29tbWl0KCkKICAgICAgICByZXR1cm4geyJzdGF0dXMiOiAic3VjY2VzcyIsICJtZXNzYWdl
IjogItCU0LDQvdC90YvQtSDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y8g0L7QsdC90L7QstC70LXQ
vdGLLiJ9CgpkZWYgZ2V0X2FsbF91c2Vyc19zZXJ2aWNlKCk6CiAgICB3aXRoIGdldF9kYl9jb25u
ZWN0aW9uKCkgYXMgY29ubjoKICAgICAgICByZXR1cm4gZXhlY3V0ZV9xdWVyeShjb25uLCAiU0VM
RUNUIGlkLCBsb2dpbiwgcm9sZSwgZnVsbF9uYW1lLCBpc19ibG9ja2VkIEZST00gdXNlcnMgT1JE
RVIgQlkgbG9naW4iLCBmZXRjaF9hbGw9VHJ1ZSkKCiMgLS0tIFJvb20gU2VydmljZSAo0JzQvtC0
0YPQu9GMIDIpIC0tLQpkZWYgaW1wb3J0X3Jvb21fZGF0YV9mcm9tX2Nzdihjc3ZfZmlsZXBhdGg9
Q1NWX0ZJTEVfUEFUSCk6CiAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoY3N2X2ZpbGVwYXRoKToK
ICAgICAgICBtZXNzYWdlYm94LnNob3dlcnJvcigi0J7RiNC40LHQutCwINC40LzQv9C+0YDRgtCw
IiwgZiLQpNCw0LnQuyB7Y3N2X2ZpbGVwYXRofSDQvdC1INC90LDQudC00LXQvS4iKQogICAgICAg
IHJldHVybgogICAgCiAgICBjcmVhdGVkX2Zsb29ycywgY3JlYXRlZF9jYXRlZ29yaWVzID0ge30s
IHt9CiAgICB0cnk6CiAgICAgICAgd2l0aCBnZXRfZGJfY29ubmVjdGlvbigpIGFzIGNvbm46ICMg
0J7RgtC60YDRi9Cy0LDQtdC8INGB0L7QtdC00LjQvdC10L3QuNC1INC00LvRjyDQstGB0LXQuSDQ
vtC/0LXRgNCw0YbQuNC4CiAgICAgICAgICAgIGN1cnNvciA9IGNvbm4uY3Vyc29yKCkgIyDQmNGB
0L/QvtC70YzQt9GD0LXQvCDQvtC00LjQvSDQutGD0YDRgdC+0YAg0LTQu9GPINCy0YHQtdGFINC+
0L/QtdGA0LDRhtC40Lkg0LLQvdGD0YLRgNC4CgogICAgICAgICAgICAjINCf0L7Qu9GD0YfQsNC1
0LwgSUQg0YHRgtCw0YLRg9GB0LAgItCn0LjRgdGC0YvQuSIKICAgICAgICAgICAgY3Vyc29yLmV4
ZWN1dGUoIlNFTEVDVCBpZCBGUk9NIHJvb21fc3RhdHVzZXMgV0hFUkUgbmFtZSA9ICfQp9C40YHR
gtGL0LknIikKICAgICAgICAgICAgY2xlYW5fc3RhdHVzX2lkX3JvdyA9IGN1cnNvci5mZXRjaG9u
ZSgpCiAgICAgICAgICAgIGlmIG5vdCBjbGVhbl9zdGF0dXNfaWRfcm93OgogICAgICAgICAgICAg
ICAgbWVzc2FnZWJveC5zaG93ZXJyb3IoItCe0YjQuNCx0LrQsCDQuNC80L/QvtGA0YLQsCIsICLQ
odGC0LDRgtGD0YEgJ9Cn0LjRgdGC0YvQuScg0L3QtSDQvdCw0LnQtNC10L0uINCY0L3QuNGG0LjQ
sNC70LjQt9C40YDRg9C50YLQtSDQkdCULiIpCiAgICAgICAgICAgICAgICBjb25uLnJvbGxiYWNr
KCkgIyDQntGC0LrQsNGC0YvQstCw0LXQvCwg0LXRgdC70Lgg0YfRgtC+LdGC0L4g0L3QtSDRgtCw
0Log0L3QsCDRjdGC0L7QvCDRjdGC0LDQv9C1CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAg
ICAgICAgY2xlYW5fc3RhdHVzX2lkID0gY2xlYW5fc3RhdHVzX2lkX3Jvd1swXQoKICAgICAgICAg
ICAgd2l0aCBvcGVuKGNzdl9maWxlcGF0aCwgbW9kZT0ncicsIGVuY29kaW5nPSd1dGYtOC1zaWcn
KSBhcyBmaWxlOgogICAgICAgICAgICAgICAgcmVhZGVyID0gY3N2LkRpY3RSZWFkZXIoZmlsZSkK
ICAgICAgICAgICAgICAgIGZvciByb3dfbnVtLCByb3cgaW4gZW51bWVyYXRlKHJlYWRlcik6CiAg
ICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBmbG9vcl9uYW1l
ID0gcm93WyfQrdGC0LDQtiddLnN0cmlwKCkKICAgICAgICAgICAgICAgICAgICAgICAgcm9vbV9u
dW1iZXIgPSByb3dbJ9Cd0L7QvNC10YAnXS5zdHJpcCgpCiAgICAgICAgICAgICAgICAgICAgICAg
IGNhdGVnb3J5X25hbWUgPSByb3dbJ9Ca0LDRgtC10LPQvtGA0LjRjyddLnN0cmlwKCkKICAgICAg
ICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCBhbGwoW2Zs
b29yX25hbWUsIHJvb21fbnVtYmVyLCBjYXRlZ29yeV9uYW1lXSk6CiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBwcmludChmItCf0YDQvtC/0YPRgdC6INGB0YLRgNC+0LrQuCB7cm93X251bSsx
fSDQuNC3LdC30LAg0L7RgtGB0YPRgtGB0YLQstC40Y8g0LTQsNC90L3Ri9GFOiB7cm93fSIpCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgICAgICAgICAg
ICAgIyDQrdGC0LDQtgogICAgICAgICAgICAgICAgICAgICAgICBpZiBmbG9vcl9uYW1lIG5vdCBp
biBjcmVhdGVkX2Zsb29yczoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvci5leGVj
dXRlKCJTRUxFQ1QgaWQgRlJPTSBmbG9vcnMgV0hFUkUgbmFtZSA9ICVzIiwgKGZsb29yX25hbWUs
KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IGN1cnNvci5mZXRjaG9uZSgpCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBpZiByZXM6CiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgY3JlYXRlZF9mbG9vcnNbZmxvb3JfbmFtZV0gPSByZXNbMF0KICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3Vy
c29yLmV4ZWN1dGUoIklOU0VSVCBJTlRPIGZsb29ycyAobmFtZSkgVkFMVUVTICglcykiLCAoZmxv
b3JfbmFtZSwpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRfZmxvb3Jz
W2Zsb29yX25hbWVdID0gY3Vyc29yLmxhc3Ryb3dpZAogICAgICAgICAgICAgICAgICAgICAgICBm
bG9vcl9pZCA9IGNyZWF0ZWRfZmxvb3JzW2Zsb29yX25hbWVdCgogICAgICAgICAgICAgICAgICAg
ICAgICAjINCa0LDRgtC10LPQvtGA0LjRjwogICAgICAgICAgICAgICAgICAgICAgICBpZiBjYXRl
Z29yeV9uYW1lIG5vdCBpbiBjcmVhdGVkX2NhdGVnb3JpZXM6CiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBjdXJzb3IuZXhlY3V0ZSgiU0VMRUNUIGlkIEZST00gY2F0ZWdvcmllcyBXSEVSRSBu
YW1lID0gJXMiLCAoY2F0ZWdvcnlfbmFtZSwpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAg
cmVzID0gY3Vyc29yLmZldGNob25lKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHJl
czoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVkX2NhdGVnb3JpZXNbY2F0
ZWdvcnlfbmFtZV0gPSByZXNbMF0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6CiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3Vyc29yLmV4ZWN1dGUoIklOU0VSVCBJTlRP
IGNhdGVnb3JpZXMgKG5hbWUpIFZBTFVFUyAoJXMpIiwgKGNhdGVnb3J5X25hbWUsKSkKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVkX2NhdGVnb3JpZXNbY2F0ZWdvcnlfbmFt
ZV0gPSBjdXJzb3IubGFzdHJvd2lkCiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5X2lk
ID0gY3JlYXRlZF9jYXRlZ29yaWVzW2NhdGVnb3J5X25hbWVdCiAgICAgICAgICAgICAgICAgICAg
ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAjINCd0L7QvNC10YAKICAgICAgICAgICAgICAg
ICAgICAgICAgY3Vyc29yLmV4ZWN1dGUoIlNFTEVDVCBpZCBGUk9NIHJvb21zIFdIRVJFIGlkID0g
JXMiLCAocm9vbV9udW1iZXIsKSkKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IGN1cnNv
ci5mZXRjaG9uZSgpOiAjINCU0L7QsdCw0LLQu9GP0LXQvCDRgtC+0LvRjNC60L4g0LXRgdC70Lgg
0L3QvtC80LXRgNCwINC90LXRggogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3Vyc29yLmV4
ZWN1dGUoIklOU0VSVCBJTlRPIHJvb21zIChpZCwgZmxvb3JfaWQsIGNhdGVnb3J5X2lkLCBjdXJy
ZW50X3N0YXR1c19pZCkgVkFMVUVTICglcywgJXMsICVzLCAlcykiLAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJvb21fbnVtYmVyLCBmbG9vcl9pZCwgY2F0ZWdv
cnlfaWQsIGNsZWFuX3N0YXR1c19pZCkpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2Vw
dGlvbiBhcyBlX3JvdzoKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiLQntGI0LjQsdC6
0LAg0L/RgNC4INC+0LHRgNCw0LHQvtGC0LrQtSDRgdGC0YDQvtC60Lgge3Jvd19udW0rMX0gQ1NW
OiB7cm93fSwge2Vfcm93fSIpCiAgICAgICAgICAgICAgICAgICAgICAgICMg0KDQtdGI0LXQvdC4
0LU6INC/0YDQvtC/0YPRgdGC0LjRgtGMINGB0YLRgNC+0LrRgyDQuNC70Lgg0L7RgtC60LDRgtC4
0YLRjCDQstGB0Y4g0YLRgNCw0L3Qt9Cw0LrRhtC40Y4/CiAgICAgICAgICAgICAgICAgICAgICAg
ICMg0JTQu9GPINGN0LrQt9Cw0LzQtdC90LAg0L/RgNC+0YnQtSDQv9GA0L7Qv9GD0YHRgtC40YLR
jCDQv9GA0L7QsdC70LXQvNC90YPRjiDRgdGC0YDQvtC60YMKICAgICAgICAgICAgICAgICAgICAg
ICAgIyBjb25uLnJvbGxiYWNrKCkgIyDQntGC0LrQsNGC0LjRgtGMLCDQtdGB0LvQuCDQvtC00L3Q
sCDQvtGI0LjQsdC60LAg0LTQvtC70LbQvdCwINC/0YDQvtCy0LDQu9C40YLRjCDQstC10YHRjCDQ
uNC80L/QvtGA0YIKICAgICAgICAgICAgICAgICAgICAgICAgIyByZXR1cm4KICAgICAgICAgICAg
Y29ubi5jb21taXQoKSAjINCa0L7QvNC80LjRgiDQsiDQutC+0L3RhtC1INCy0YHQtdGFINGD0YHQ
v9C10YjQvdGL0YUg0L7Qv9C10YDQsNGG0LjQuQogICAgICAgIG1lc3NhZ2Vib3guc2hvd2luZm8o
ItCY0LzQv9C+0YDRgiIsICLQmNC80L/QvtGA0YIg0LTQsNC90L3Ri9GFINC90L7QvNC10YDQvdC+
0LPQviDRhNC+0L3QtNCwINC30LDQstC10YDRiNC10L0uIikKICAgIGV4Y2VwdCBFeGNlcHRpb24g
YXMgZToKICAgICAgICBtZXNzYWdlYm94LnNob3dlcnJvcigi0J7RiNC40LHQutCwINC40LzQv9C+
0YDRgtCwIiwgZiLQntCx0YnQsNGPINC+0YjQuNCx0LrQsDoge2V9IikKCmRlZiBnZXRfcm9vbV9v
Y2N1cGFuY3lfcGVyY2VudGFnZV9zZXJ2aWNlKCk6CiAgICB3aXRoIGdldF9kYl9jb25uZWN0aW9u
KCkgYXMgY29ubjoKICAgICAgICBxdWVyeSA9ICIiIgogICAgICAgIFNFTEVDVCAKICAgICAgICAg
ICAgQ0FTRSAKICAgICAgICAgICAgICAgIFdIRU4gKFNFTEVDVCBDT1VOVCgqKSBGUk9NIHJvb21z
KSA9IDAgVEhFTiAwLjAKICAgICAgICAgICAgICAgIEVMU0UgCiAgICAgICAgICAgICAgICAgICAg
KFNFTEVDVCBDT1VOVCgqKSBGUk9NIHJvb21zIFdIRVJFIGN1cnJlbnRfc3RhdHVzX2lkID0gKFNF
TEVDVCBpZCBGUk9NIHJvb21fc3RhdHVzZXMgV0hFUkUgbmFtZSA9ICfQl9Cw0L3Rj9GCJykpICog
MTAwLjAgLwogICAgICAgICAgICAgICAgICAgIChTRUxFQ1QgQ09VTlQoKikgRlJPTSByb29tcykK
ICAgICAgICAgICAgRU5EIEFTIHBlcmNlbnRhZ2Vfb2NjdXBhbmN5OwogICAgICAgICIiIgogICAg
ICAgIHJlc3VsdCA9IGV4ZWN1dGVfcXVlcnkoY29ubiwgcXVlcnksIGZldGNoX29uZT1UcnVlKQog
ICAgICAgIHJldHVybiByZXN1bHRbJ3BlcmNlbnRhZ2Vfb2NjdXBhbmN5J10gaWYgcmVzdWx0IGFu
ZCByZXN1bHRbJ3BlcmNlbnRhZ2Vfb2NjdXBhbmN5J10gaXMgbm90IE5vbmUgZWxzZSAwLjAKCmRl
ZiBnZXRfYWxsX3Jvb21zX3dpdGhfZGV0YWlsc19zZXJ2aWNlKCk6CiAgICB3aXRoIGdldF9kYl9j
b25uZWN0aW9uKCkgYXMgY29ubjoKICAgICAgICBxdWVyeSA9ICIiIgogICAgICAgIFNFTEVDVCBy
LmlkIGFzIHJvb21fbnVtYmVyLCBmLm5hbWUgYXMgZmxvb3JfbmFtZSwgYy5uYW1lIGFzIGNhdGVn
b3J5X25hbWUsIHJzLm5hbWUgYXMgc3RhdHVzX25hbWUKICAgICAgICBGUk9NIHJvb21zIHIKICAg
ICAgICBMRUZUIEpPSU4gZmxvb3JzIGYgT04gci5mbG9vcl9pZCA9IGYuaWQKICAgICAgICBMRUZU
IEpPSU4gY2F0ZWdvcmllcyBjIE9OIHIuY2F0ZWdvcnlfaWQgPSBjLmlkCiAgICAgICAgTEVGVCBK
T0lOIHJvb21fc3RhdHVzZXMgcnMgT04gci5jdXJyZW50X3N0YXR1c19pZCA9IHJzLmlkCiAgICAg
ICAgT1JERVIgQlkgZi5pZCwgci5pZDsgCiAgICAgICAgIiIiICMgT1JERVIgQlkgZi5pZCDQtNC7
0Y8g0L/RgNCw0LLQuNC70YzQvdC+0Lkg0YHQvtGA0YLQuNGA0L7QstC60Lgg0L/QviDRjdGC0LDQ
ttCw0LwKICAgICAgICByZXR1cm4gZXhlY3V0ZV9xdWVyeShjb25uLCBxdWVyeSwgZmV0Y2hfYWxs
PVRydWUpCgojIC0tLSBWYWxpZGF0aW9uIFNlcnZpY2UgKNCc0L7QtNGD0LvRjCA0KSAtLS0KZGVm
IGdldF9mdWxsbmFtZV9mcm9tX2FwaSgpOgogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVx
dWVzdHMuZ2V0KEFQSV9VUkxfRlVMTE5BTUUsIHRpbWVvdXQ9NSkKICAgICAgICByZXNwb25zZS5y
YWlzZV9mb3Jfc3RhdHVzKCkKICAgICAgICBkYXRhID0gcmVzcG9uc2UuanNvbigpCiAgICAgICAg
cmV0dXJuIGRhdGEuZ2V0KCJ2YWx1ZSIpCiAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5S
ZXF1ZXN0RXhjZXB0aW9uIGFzIGU6CiAgICAgICAgIyBtZXNzYWdlYm94LnNob3dlcnJvcigi0J7R
iNC40LHQutCwIEFQSSIsIGYi0J3QtSDRg9C00LDQu9C+0YHRjCDQv9C+0LvRg9GH0LjRgtGMINC0
0LDQvdC90YvQtSDRgSBBUEk6IHtlfSIsIHBhcmVudD1jdGsuQ1RrKCkpICMgUGFyZW50INC80L7Q
ttC10YIg0LHRi9GC0Ywg0L/RgNC+0LHQu9C10LzQvtC5INC10YHQu9C4INC+0LrQvdCwINC90LXR
ggogICAgICAgIHByaW50KGYi0J7RiNC40LHQutCwIEFQSToge2V9IikKICAgICAgICByZXR1cm4g
Tm9uZQoKZGVmIHZhbGlkYXRlX2Zpb19zZXJ2aWNlKGZpb19zdHJpbmcpOgogICAgIyDQrdGC0LAg
0YTRg9C90LrRhtC40Y8g0L/RgNC+0YHRgtC+INC+0L/RgNC10LTQtdC70Y/QtdGCLCDQtdGB0YLR
jCDQu9C4INC+0YjQuNCx0LrQuCDQuNC70Lgg0L3QtdGCLCDQtNC70Y8g0LLRi9Cy0L7QtNCwINC+
0LTQvdC+0LPQviDRgdC+0L7QsdGJ0LXQvdC40Y8KICAgIGlmIG5vdCBmaW9fc3RyaW5nOgogICAg
ICAgIHJldHVybiBGYWxzZSAjINCf0YPRgdGC0L7QtSDQpNCY0J4g0L3QtdCy0LDQu9C40LTQvdC+
CgogICAgYWxsb3dlZF9jaGFyc19wYXR0ZXJuID0gciJeW9CwLdGP0JAt0K/RkdCBYS16QS1aXHNc
LV0rJCIKICAgIGlmIG5vdCByZS5mdWxsbWF0Y2goYWxsb3dlZF9jaGFyc19wYXR0ZXJuLCBmaW9f
c3RyaW5nKToKICAgICAgICByZXR1cm4gRmFsc2UgIyDQodC+0LTQtdGA0LbQuNGCINC30LDQv9GA
0LXRidC10L3QvdGL0LUg0YHQuNC80LLQvtC70YsKCiAgICB3b3JkcyA9IGZpb19zdHJpbmcuc3Ry
aXAoKS5zcGxpdCgpCiAgICBpZiBub3QgKDIgPD0gbGVuKHdvcmRzKSA8PSAzKToKICAgICAgICBy
ZXR1cm4gRmFsc2UgIyDQndC1IDItMyDRgdC70L7QstCwCgogICAgZm9yIHdvcmQgaW4gd29yZHM6
CiAgICAgICAgaWYgbm90IHdvcmQgb3Igbm90IHdvcmRbMF0uaXN1cHBlcigpOiAjINCf0YDQvtCy
0LXRgNC60LAg0L3QsCDQv9GD0YHRgtC+0LUg0YHQu9C+0LLQviDQuCDQt9Cw0LPQu9Cw0LLQvdGD
0Y4g0LHRg9C60LLRgwogICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgIHJldHVybiBUcnVlCgoK
IyA1LiBHVUkgQ0xBU1NFUwoKY2xhc3MgTG9naW5XaW5kb3coY3RrLkNUa0ZyYW1lKToKICAgIGRl
ZiBfX2luaXRfXyhzZWxmLCBtYXN0ZXIsIGFwcF9jb250cm9sbGVyKToKICAgICAgICBzdXBlcigp
Ll9faW5pdF9fKG1hc3RlcikKICAgICAgICBzZWxmLmFwcF9jb250cm9sbGVyID0gYXBwX2NvbnRy
b2xsZXIKICAgICAgICBzZWxmLm1hc3Rlci50aXRsZSgi0JDQstGC0L7RgNC40LfQsNGG0LjRjyAt
INCh0LjRgdGC0LXQvNCwINCT0L7RgdGC0LjQvdC40YbRiyIpCiAgICAgICAgc2VsZi5tYXN0ZXIu
Z2VvbWV0cnkoIjQwMHgzNTAiKQogICAgICAgIHNlbGYucGFjayhwYWR5PTIwLCBwYWR4PTIwLCBm
aWxsPSJib3RoIiwgZXhwYW5kPVRydWUpCgogICAgICAgIGN0ay5DVGtMYWJlbChzZWxmLCB0ZXh0
PSLQktGF0L7QtCDQsiDRgdC40YHRgtC10LzRgyIsIGZvbnQ9KCJBcmlhbCIsIDE2KSkucGFjayhw
YWR5PTEyLCBwYWR4PTEwKQogICAgICAgIHNlbGYubG9naW5fZW50cnkgPSBjdGsuQ1RrRW50cnko
c2VsZiwgcGxhY2Vob2xkZXJfdGV4dD0i0JvQvtCz0LjQvSIsIHdpZHRoPTI1MCkKICAgICAgICBz
ZWxmLmxvZ2luX2VudHJ5LnBhY2socGFkeT0xMiwgcGFkeD0xMCkKICAgICAgICBzZWxmLnBhc3N3
b3JkX2VudHJ5ID0gY3RrLkNUa0VudHJ5KHNlbGYsIHBsYWNlaG9sZGVyX3RleHQ9ItCf0LDRgNC+
0LvRjCIsIHNob3c9IioiLCB3aWR0aD0yNTApCiAgICAgICAgc2VsZi5wYXNzd29yZF9lbnRyeS5w
YWNrKHBhZHk9MTIsIHBhZHg9MTApCgogICAgICAgIHNlbGYuc2hvd19wYXNzd29yZF92YXIgPSBj
dGsuQm9vbGVhblZhcigpCiAgICAgICAgc2VsZi5zaG93X3Bhc3N3b3JkX2NoZWNrID0gY3RrLkNU
a0NoZWNrQm94KHNlbGYsIHRleHQ9ItCf0L7QutCw0LfQsNGC0Ywg0L/QsNGA0L7Qu9GMIiwKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFibGU9
c2VsZi5zaG93X3Bhc3N3b3JkX3ZhciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgY29tbWFuZD1zZWxmLl90b2dnbGVfcGFzc3dvcmRfdmlzaWJpbGl0
eSkKICAgICAgICBzZWxmLnNob3dfcGFzc3dvcmRfY2hlY2sucGFjayhwYWR5PTUsIHBhZHg9MTAp
CgogICAgICAgIGN0ay5DVGtCdXR0b24oc2VsZiwgdGV4dD0i0JLQvtC50YLQuCIsIGNvbW1hbmQ9
c2VsZi5fYXR0ZW1wdF9sb2dpbiwgd2lkdGg9MjUwKS5wYWNrKHBhZHk9MjAsIHBhZHg9MTApCgog
ICAgZGVmIF90b2dnbGVfcGFzc3dvcmRfdmlzaWJpbGl0eShzZWxmKToKICAgICAgICBpZiBzZWxm
LnNob3dfcGFzc3dvcmRfdmFyLmdldCgpOgogICAgICAgICAgICBzZWxmLnBhc3N3b3JkX2VudHJ5
LmNvbmZpZ3VyZShzaG93PSIiKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYucGFzc3dv
cmRfZW50cnkuY29uZmlndXJlKHNob3c9IioiKQoKICAgIGRlZiBfYXR0ZW1wdF9sb2dpbihzZWxm
KToKICAgICAgICBsb2dpbiA9IHNlbGYubG9naW5fZW50cnkuZ2V0KCkKICAgICAgICBwYXNzd29y
ZCA9IHNlbGYucGFzc3dvcmRfZW50cnkuZ2V0KCkKICAgICAgICBpZiBub3QgbG9naW4gb3Igbm90
IHBhc3N3b3JkOgogICAgICAgICAgICBtZXNzYWdlYm94LnNob3dlcnJvcigi0J7RiNC40LHQutCw
IiwgItCb0L7Qs9C40L0g0Lgg0L/QsNGA0L7Qu9GMINC+0LHRj9C30LDRgtC10LvRjNC90YsuIiwg
cGFyZW50PXNlbGYubWFzdGVyKQogICAgICAgICAgICByZXR1cm4KICAgICAgICB0cnk6CiAgICAg
ICAgICAgIHJlc3VsdCA9IGxvZ2luX3VzZXJfc2VydmljZShsb2dpbiwgcGFzc3dvcmQpCiAgICAg
ICAgICAgIGlmIHJlc3VsdFsic3RhdHVzIl0gPT0gInN1Y2Nlc3MiOgogICAgICAgICAgICAgICAg
c2VsZi5hcHBfY29udHJvbGxlci5jdXJyZW50X3VzZXIgPSByZXN1bHRbInVzZXIiXQogICAgICAg
ICAgICAgICAgbWVzc2FnZWJveC5zaG93aW5mbygi0KPRgdC/0LXRhSIsIGYi0JTQvtCx0YDQviDQ
v9C+0LbQsNC70L7QstCw0YLRjCwge3Jlc3VsdFsndXNlciddLmdldCgnZnVsbF9uYW1lJywgcmVz
dWx0Wyd1c2VyJ11bJ2xvZ2luJ10pfSEiLCBwYXJlbnQ9c2VsZi5tYXN0ZXIpCiAgICAgICAgICAg
ICAgICBpZiByZXN1bHRbImZvcmNlX3Bhc3N3b3JkX2NoYW5nZSJdOgogICAgICAgICAgICAgICAg
ICAgIHNlbGYuYXBwX2NvbnRyb2xsZXIuc2hvd19jaGFuZ2VfcGFzc3dvcmRfd2luZG93KGluaXRp
YWxfY2hhbmdlPVRydWUpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAg
IHNlbGYuYXBwX2NvbnRyb2xsZXIuc2hvd19kYXNoYm9hcmRfZm9yX3JvbGUocmVzdWx0WyJ1c2Vy
Il1bJ3JvbGUnXSkKICAgICAgICAgICAgICAgIHNlbGYuZGVzdHJveSgpCiAgICAgICAgICAgIGVs
c2U6CiAgICAgICAgICAgICAgICBtZXNzYWdlYm94LnNob3dlcnJvcigi0J7RiNC40LHQutCwINCy
0YXQvtC00LAiLCByZXN1bHRbIm1lc3NhZ2UiXSwgcGFyZW50PXNlbGYubWFzdGVyKQogICAgICAg
IGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgbWVzc2FnZWJveC5zaG93ZXJyb3Io
ItCa0YDQuNGC0LjRh9C10YHQutCw0Y8g0L7RiNC40LHQutCwIiwgZiLQntGI0LjQsdC60LAg0L/R
gNC4INC/0L7Qv9GL0YLQutC1INCy0YXQvtC00LA6IHtlfSIsIHBhcmVudD1zZWxmLm1hc3RlcikK
CgpjbGFzcyBDaGFuZ2VQYXNzd29yZFdpbmRvdyhjdGsuQ1RrVG9wbGV2ZWwpOgogICAgZGVmIF9f
aW5pdF9fKHNlbGYsIG1hc3RlciwgYXBwX2NvbnRyb2xsZXIsIGluaXRpYWxfY2hhbmdlPUZhbHNl
KToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKG1hc3RlcikKICAgICAgICBzZWxmLmFwcF9jb250
cm9sbGVyID0gYXBwX2NvbnRyb2xsZXIKICAgICAgICBzZWxmLnVzZXJfaWQgPSBzZWxmLmFwcF9j
b250cm9sbGVyLmN1cnJlbnRfdXNlclsnaWQnXQogICAgICAgIHNlbGYuaW5pdGlhbF9jaGFuZ2Ug
PSBpbml0aWFsX2NoYW5nZQogICAgICAgIHNlbGYudGl0bGUoItCh0LzQtdC90LAg0L/QsNGA0L7Q
u9GPIikKICAgICAgICBzZWxmLmdlb21ldHJ5KCI0MDB4MzUwIikKICAgICAgICAKICAgICAgICBz
ZWxmLnRyYW5zaWVudChtYXN0ZXIpCgogICAgICAgIGN0ay5DVGtMYWJlbChzZWxmLCB0ZXh0PSLQ
odC80LXQvdCwINC/0LDRgNC+0LvRjyIsIGZvbnQ9KCJBcmlhbCIsIDE2KSkucGFjayhwYWR5PTEw
KQogICAgICAgIHNlbGYuY3VycmVudF9wYXNzX2VudHJ5ID0gY3RrLkNUa0VudHJ5KHNlbGYsIHBs
YWNlaG9sZGVyX3RleHQ9ItCi0LXQutGD0YnQuNC5INC/0LDRgNC+0LvRjCIsIHNob3c9IioiLCB3
aWR0aD0zMDApCiAgICAgICAgc2VsZi5jdXJyZW50X3Bhc3NfZW50cnkucGFjayhwYWR5PTEwLCBw
YWR4PTIwLCBmaWxsPSJ4IikKICAgICAgICBzZWxmLm5ld19wYXNzX2VudHJ5ID0gY3RrLkNUa0Vu
dHJ5KHNlbGYsIHBsYWNlaG9sZGVyX3RleHQ9ItCd0L7QstGL0Lkg0L/QsNGA0L7Qu9GMIiwgc2hv
dz0iKiIsIHdpZHRoPTMwMCkKICAgICAgICBzZWxmLm5ld19wYXNzX2VudHJ5LnBhY2socGFkeT0x
MCwgcGFkeD0yMCwgZmlsbD0ieCIpCiAgICAgICAgc2VsZi5jb25maXJtX3Bhc3NfZW50cnkgPSBj
dGsuQ1RrRW50cnkoc2VsZiwgcGxhY2Vob2xkZXJfdGV4dD0i0J/QvtC00YLQstC10YDQtNC40YLQ
tSDQvdC+0LLRi9C5INC/0LDRgNC+0LvRjCIsIHNob3c9IioiLCB3aWR0aD0zMDApCiAgICAgICAg
c2VsZi5jb25maXJtX3Bhc3NfZW50cnkucGFjayhwYWR5PTEwLCBwYWR4PTIwLCBmaWxsPSJ4IikK
ICAgICAgICBjdGsuQ1RrQnV0dG9uKHNlbGYsIHRleHQ9ItCY0LfQvNC10L3QuNGC0Ywg0L/QsNGA
0L7Qu9GMIiwgY29tbWFuZD1zZWxmLl9hdHRlbXB0X2NoYW5nZSwgd2lkdGg9MzAwKS5wYWNrKHBh
ZHk9MjApCiAgICAgICAgCiAgICAgICAgaWYgc2VsZi5pbml0aWFsX2NoYW5nZToKICAgICAgICAg
ICAgc2VsZi5wcm90b2NvbCgiV01fREVMRVRFX1dJTkRPVyIsIGxhbWJkYTogbWVzc2FnZWJveC5z
aG93d2FybmluZygi0KHQvNC10L3QsCDQv9Cw0YDQvtC70Y8iLCAi0J/QvtC20LDQu9GD0LnRgdGC
0LAsINGB0LzQtdC90LjRgtC1INC/0LDRgNC+0LvRjC4iLCBwYXJlbnQ9c2VsZikpCgogICAgZGVm
IF9hdHRlbXB0X2NoYW5nZShzZWxmKToKICAgICAgICBjdXIgPSBzZWxmLmN1cnJlbnRfcGFzc19l
bnRyeS5nZXQoKQogICAgICAgIG5ldyA9IHNlbGYubmV3X3Bhc3NfZW50cnkuZ2V0KCkKICAgICAg
ICBjb25mID0gc2VsZi5jb25maXJtX3Bhc3NfZW50cnkuZ2V0KCkKICAgICAgICAKICAgICAgICBp
ZiBub3QgYWxsKFtjdXIsIG5ldywgY29uZl0pOgogICAgICAgICAgICBtZXNzYWdlYm94LnNob3dl
cnJvcigi0J7RiNC40LHQutCwIiwgItCS0YHQtSDQv9C+0LvRjyDQvtCx0Y/Qt9Cw0YLQtdC70YzQ
vdGLLiIsIHBhcmVudD1zZWxmKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBpZiBuZXcgIT0g
Y29uZjoKICAgICAgICAgICAgbWVzc2FnZWJveC5zaG93ZXJyb3IoItCe0YjQuNCx0LrQsCIsICLQ
ndC+0LLRi9C1INC/0LDRgNC+0LvQuCDQvdC1INGB0L7QstC/0LDQtNCw0Y7Rgi4iLCBwYXJlbnQ9
c2VsZikKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgaWYgbGVuKG5ldykgPCAxOiAjINCj0L/R
gNC+0YnQtdC90L4KICAgICAgICAgICAgbWVzc2FnZWJveC5zaG93ZXJyb3IoItCe0YjQuNCx0LrQ
sCIsICLQndC+0LLRi9C5INC/0LDRgNC+0LvRjCDQvdC1INC80L7QttC10YIg0LHRi9GC0Ywg0L/R
g9GB0YLRi9C8LiIsIHBhcmVudD1zZWxmKQogICAgICAgICAgICByZXR1cm4KICAgICAgICAKICAg
ICAgICB0cnk6CiAgICAgICAgICAgIHJlc3VsdCA9IGNoYW5nZV9wYXNzd29yZF9zZXJ2aWNlKHNl
bGYudXNlcl9pZCwgY3VyLCBuZXcpCiAgICAgICAgICAgIGlmIHJlc3VsdFsic3RhdHVzIl0gPT0g
InN1Y2Nlc3MiOgogICAgICAgICAgICAgICAgbWVzc2FnZWJveC5zaG93aW5mbygi0KPRgdC/0LXR
hSIsIHJlc3VsdFsibWVzc2FnZSJdLCBwYXJlbnQ9c2VsZikKICAgICAgICAgICAgICAgIHNlbGYu
ZGVzdHJveSgpCiAgICAgICAgICAgICAgICBpZiBzZWxmLmluaXRpYWxfY2hhbmdlOgogICAgICAg
ICAgICAgICAgICAgIHNlbGYuYXBwX2NvbnRyb2xsZXIuc2hvd19kYXNoYm9hcmRfZm9yX3JvbGUo
c2VsZi5hcHBfY29udHJvbGxlci5jdXJyZW50X3VzZXJbJ3JvbGUnXSkKICAgICAgICAgICAgZWxz
ZToKICAgICAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2Vycm9yKCLQntGI0LjQsdC60LAg0YHQ
vNC10L3RiyIsIHJlc3VsdFsibWVzc2FnZSJdLCBwYXJlbnQ9c2VsZikKICAgICAgICBleGNlcHQg
RXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICBtZXNzYWdlYm94LnNob3dlcnJvcigi0JrRgNC4
0YLQuNGH0LXRgdC60LDRjyDQvtGI0LjQsdC60LAiLCBmItCe0YjQuNCx0LrQsCDQv9GA0Lgg0YHQ
vNC10L3QtSDQv9Cw0YDQvtC70Y86IHtlfSIsIHBhcmVudD1zZWxmKQoKCmNsYXNzIFVzZXJNYW5h
Z2VtZW50V2luZG93KGN0ay5DVGtUb3BsZXZlbCk6CiAgICAjIC4uLiAo0LrQvtC0INGN0YLQvtCz
0L4g0LrQu9Cw0YHRgdCwINC+0YHRgtCw0LXRgtGB0Y8g0L/QvtGH0YLQuCDRgtCw0LrQuNC8INC2
0LUsINC60LDQuiDQsiDQv9GA0LXQtNGL0LTRg9GJ0LXQuSDQstC10YDRgdC40LgsINGC0L7Qu9GM
0LrQviDQstGL0LfQvtCy0Ysg0YHQtdGA0LLQuNGB0L7QsiDRgtC10L/QtdGA0Ywg0LHQtdC3IGNv
bm4pCiAgICBkZWYgX19pbml0X18oc2VsZiwgbWFzdGVyLCBhcHBfY29udHJvbGxlcik6CiAgICAg
ICAgc3VwZXIoKS5fX2luaXRfXyhtYXN0ZXIpCiAgICAgICAgc2VsZi5hcHBfY29udHJvbGxlciA9
IGFwcF9jb250cm9sbGVyCiAgICAgICAgc2VsZi50aXRsZSgi0KPQv9GA0LDQstC70LXQvdC40LUg
0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GP0LzQuCIpCiAgICAgICAgc2VsZi5nZW9tZXRyeSgiODUw
eDUwMCIpCiAgICAgICAgCiAgICAgICAgc2VsZi50cmFuc2llbnQobWFzdGVyKQogICAgICAgIAog
ICAgICAgIGJ0bl9mcmFtZSA9IGN0ay5DVGtGcmFtZShzZWxmKQogICAgICAgIGJ0bl9mcmFtZS5w
YWNrKHBhZHk9MTAsIHBhZHg9MTAsIGZpbGw9IngiKQogICAgICAgIGN0ay5DVGtCdXR0b24oYnRu
X2ZyYW1lLCB0ZXh0PSLQlNC+0LHQsNCy0LjRgtGMIiwgY29tbWFuZD1zZWxmLl9vcGVuX2FkZF9l
ZGl0X2RpYWxvZykucGFjayhzaWRlPSJsZWZ0IiwgcGFkeD01KQogICAgICAgIGN0ay5DVGtCdXR0
b24oYnRuX2ZyYW1lLCB0ZXh0PSLQoNC10LTQsNC60YLQuNGA0L7QstCw0YLRjCIsIGNvbW1hbmQ9
bGFtYmRhOiBzZWxmLl9vcGVuX2FkZF9lZGl0X2RpYWxvZyhlZGl0X21vZGU9VHJ1ZSkpLnBhY2so
c2lkZT0ibGVmdCIsIHBhZHg9NSkKICAgICAgICBjdGsuQ1RrQnV0dG9uKGJ0bl9mcmFtZSwgdGV4
dD0i0J7QsdC90L7QstC40YLRjCIsIGNvbW1hbmQ9c2VsZi5fbG9hZF91c2VycykucGFjayhzaWRl
PSJsZWZ0IiwgcGFkeD01KQoKICAgICAgICBzdHlsZSA9IHR0ay5TdHlsZShzZWxmKQogICAgICAg
IHN0eWxlLnRoZW1lX3VzZSgiZGVmYXVsdCIpICMg0LjQu9C4INC00YDRg9Cz0LDRjyDQtNC+0YHR
gtGD0L/QvdCw0Y8g0YLQtdC80LAKICAgICAgICBzdHlsZS5jb25maWd1cmUoIlRyZWV2aWV3Lkhl
YWRpbmciLCBmb250PSgnQXJpYWwnLCAxMCwgJ2JvbGQnKSkKICAgICAgICBzZWxmLnRyZWUgPSB0
dGsuVHJlZXZpZXcoc2VsZiwgY29sdW1ucz0oImlkIiwgImxvZ2luIiwgImZ1bGxfbmFtZSIsICJy
b2xlIiwgImlzX2Jsb2NrZWQiKSwgc2hvdz0iaGVhZGluZ3MiKQogICAgICAgIAogICAgICAgIHNl
bGYudHJlZS5oZWFkaW5nKCJpZCIsIHRleHQ9IklEIikKICAgICAgICBzZWxmLnRyZWUuY29sdW1u
KCJpZCIsIHdpZHRoPTUwLCBzdHJldGNoPUZhbHNlLCBhbmNob3I9ImNlbnRlciIpCiAgICAgICAg
c2VsZi50cmVlLmhlYWRpbmcoImxvZ2luIiwgdGV4dD0i0JvQvtCz0LjQvSIpCiAgICAgICAgc2Vs
Zi50cmVlLmNvbHVtbigibG9naW4iLCB3aWR0aD0xNTAsIGFuY2hvcj0idyIpCiAgICAgICAgc2Vs
Zi50cmVlLmhlYWRpbmcoImZ1bGxfbmFtZSIsIHRleHQ9ItCk0JjQniIpCiAgICAgICAgc2VsZi50
cmVlLmNvbHVtbigiZnVsbF9uYW1lIiwgd2lkdGg9MjUwLCBhbmNob3I9InciKQogICAgICAgIHNl
bGYudHJlZS5oZWFkaW5nKCJyb2xlIiwgdGV4dD0i0KDQvtC70YwiKQogICAgICAgIHNlbGYudHJl
ZS5jb2x1bW4oInJvbGUiLCB3aWR0aD0xMjAsIGFuY2hvcj0idyIpCiAgICAgICAgc2VsZi50cmVl
LmhlYWRpbmcoImlzX2Jsb2NrZWQiLCB0ZXh0PSLQkdC70L7QuiIpCiAgICAgICAgc2VsZi50cmVl
LmNvbHVtbigiaXNfYmxvY2tlZCIsIHdpZHRoPTgwLCBzdHJldGNoPUZhbHNlLCBhbmNob3I9ImNl
bnRlciIpCiAgICAgICAgCiAgICAgICAgc2VsZi50cmVlLnBhY2socGFkeT0xMCwgcGFkeD0xMCwg
ZmlsbD0iYm90aCIsIGV4cGFuZD1UcnVlKQogICAgICAgIHNlbGYuX2xvYWRfdXNlcnMoKQoKICAg
IGRlZiBfbG9hZF91c2VycyhzZWxmKToKICAgICAgICBmb3IgaSBpbiBzZWxmLnRyZWUuZ2V0X2No
aWxkcmVuKCk6CiAgICAgICAgICAgIHNlbGYudHJlZS5kZWxldGUoaSkKICAgICAgICB0cnk6CiAg
ICAgICAgICAgIHVzZXJzID0gZ2V0X2FsbF91c2Vyc19zZXJ2aWNlKCkKICAgICAgICAgICAgaWYg
dXNlcnM6CiAgICAgICAgICAgICAgICBmb3IgdXNlciBpbiB1c2VyczoKICAgICAgICAgICAgICAg
ICAgICBzZWxmLnRyZWUuaW5zZXJ0KCIiLCAiZW5kIiwgdmFsdWVzPSgKICAgICAgICAgICAgICAg
ICAgICAgICAgdXNlclsnaWQnXSwgCiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJbJ2xvZ2lu
J10sIAogICAgICAgICAgICAgICAgICAgICAgICB1c2VyLmdldCgnZnVsbF9uYW1lJywnJyksICMg
0JjRgdC/0L7Qu9GM0LfRg9C10LwgZ2V0INC00LvRjyDQsdC10LfQvtC/0LDRgdC90L7RgdGC0LgK
ICAgICAgICAgICAgICAgICAgICAgICAgdXNlclsncm9sZSddLCAKICAgICAgICAgICAgICAgICAg
ICAgICAgItCU0LAiIGlmIHVzZXIuZ2V0KCdpc19ibG9ja2VkJywgRmFsc2UpIGVsc2UgItCd0LXR
giIKICAgICAgICAgICAgICAgICAgICApKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToK
ICAgICAgICAgICAgbWVzc2FnZWJveC5zaG93ZXJyb3IoItCe0YjQuNCx0LrQsCDQt9Cw0LPRgNGD
0LfQutC4IiwgZiLQndC1INGD0LTQsNC70L7RgdGMINC30LDQs9GA0YPQt9C40YLRjCDQv9C+0LvR
jNC30L7QstCw0YLQtdC70LXQuToge2V9IiwgcGFyZW50PXNlbGYpCgoKICAgIGRlZiBfb3Blbl9h
ZGRfZWRpdF9kaWFsb2coc2VsZiwgZWRpdF9tb2RlPUZhbHNlKToKICAgICAgICB1c2VyX2RhdGFf
dG9fZWRpdCA9IE5vbmUKICAgICAgICBpZiBlZGl0X21vZGU6CiAgICAgICAgICAgIHNlbGVjdGVk
X2l0ZW0gPSBzZWxmLnRyZWUuZm9jdXMoKQogICAgICAgICAgICBpZiBub3Qgc2VsZWN0ZWRfaXRl
bToKICAgICAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd3dhcm5pbmcoItCS0YvQsdC+0YAiLCAi
0JLRi9Cx0LXRgNC40YLQtSDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y8g0LTQu9GPINGA0LXQtNCw
0LrRgtC40YDQvtCy0LDQvdC40Y8uIiwgcGFyZW50PXNlbGYpCiAgICAgICAgICAgICAgICByZXR1
cm4KICAgICAgICAgICAgdXNlcl9pZF9zZWxlY3RlZCA9IHNlbGYudHJlZS5pdGVtKHNlbGVjdGVk
X2l0ZW0pWyd2YWx1ZXMnXVswXQogICAgICAgICAgICAKICAgICAgICAgICAgdHJ5OiAjINCf0L7Q
u9GD0YfQsNC10Lwg0YHQstC10LbQuNC1INC00LDQvdC90YvQtSDQv9C+0LvRjNC30L7QstCw0YLQ
tdC70Y8g0LTQu9GPINGA0LXQtNCw0LrRgtC40YDQvtCy0LDQvdC40Y8KICAgICAgICAgICAgICAg
IGFsbF91c2VycyA9IGdldF9hbGxfdXNlcnNfc2VydmljZSgpCiAgICAgICAgICAgICAgICBpZiBh
bGxfdXNlcnM6CiAgICAgICAgICAgICAgICAgICAgZm9yIHVfZGF0YSBpbiBhbGxfdXNlcnM6CiAg
ICAgICAgICAgICAgICAgICAgICAgIGlmIHVfZGF0YVsnaWQnXSA9PSB1c2VyX2lkX3NlbGVjdGVk
OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcl9kYXRhX3RvX2VkaXQgPSB1X2RhdGEK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICBpZiBub3Qg
dXNlcl9kYXRhX3RvX2VkaXQ6CiAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2Vy
cm9yKCLQntGI0LjQsdC60LAiLCAi0J3QtSDQvdCw0LnQtNC10L3RiyDQtNCw0L3QvdGL0LUg0L/Q
vtC70YzQt9C+0LLQsNGC0LXQu9GPINC00LvRjyDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNGP
LiIsIHBhcmVudD1zZWxmKQogICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAg
ZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgbWVzc2FnZWJveC5zaG93ZXJy
b3IoItCe0YjQuNCx0LrQsCIsIGYi0J3QtSDRg9C00LDQu9C+0YHRjCDQv9C+0LvRg9GH0LjRgtGM
INC00LDQvdC90YvQtSDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y86IHtlfSIsIHBhcmVudD1zZWxm
KQogICAgICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIEFkZEVkaXRVc2VyRGlhbG9nKHNlbGYs
IHNlbGYuYXBwX2NvbnRyb2xsZXIsIG1vZGU9KCJlZGl0IiBpZiBlZGl0X21vZGUgZWxzZSAiYWRk
IiksIHVzZXJfZGF0YT11c2VyX2RhdGFfdG9fZWRpdCwgY2FsbGJhY2s9c2VsZi5fbG9hZF91c2Vy
cykKCgpjbGFzcyBBZGRFZGl0VXNlckRpYWxvZyhjdGsuQ1RrVG9wbGV2ZWwpOgogICAgIyAuLi4g
KNC60L7QtCDRjdGC0L7Qs9C+INC60LvQsNGB0YHQsCDQvtGB0YLQsNC10YLRgdGPINC/0L7Rh9GC
0Lgg0YLQsNC60LjQvCDQttC1LCDQutCw0Log0LIg0L/RgNC10LTRi9C00YPRidC10Lkg0LLQtdGA
0YHQuNC4LCDRgtC+0LvRjNC60L4g0LLRi9C30L7QstGLINGB0LXRgNCy0LjRgdC+0LIg0YLQtdC/
0LXRgNGMINCx0LXQtyBjb25uKQogICAgZGVmIF9faW5pdF9fKHNlbGYsIG1hc3RlciwgYXBwX2Nv
bnRyb2xsZXIsIG1vZGU9ImFkZCIsIHVzZXJfZGF0YT1Ob25lLCBjYWxsYmFjaz1Ob25lKToKICAg
ICAgICBzdXBlcigpLl9faW5pdF9fKG1hc3RlcikKICAgICAgICBzZWxmLm1vZGUgPSBtb2RlCiAg
ICAgICAgc2VsZi51c2VyX2RhdGEgPSB1c2VyX2RhdGEgIyDQrdGC0L4gZGljdCDQv9C+0LvRjNC3
0L7QstCw0YLQtdC70Y8sINC10YHQu9C4IG1vZGU9ImVkaXQiCiAgICAgICAgc2VsZi5jYWxsYmFj
ayA9IGNhbGxiYWNrCiAgICAgICAgc2VsZi5hcHBfY29udHJvbGxlciA9IGFwcF9jb250cm9sbGVy
ICMg0J3QtSDQuNGB0L/QvtC70YzQt9C+0LLQsNC70YHRjywg0L3QviDQvNC+0LbQtdGCINC/0YDQ
uNCz0L7QtNC40YLRjNGB0Y8KCiAgICAgICAgaWYgbW9kZSA9PSAiYWRkIjoKICAgICAgICAgICAg
c2VsZi50aXRsZSgi0JTQvtCx0LDQstC40YLRjCDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y8iKQog
ICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYudGl0bGUoZiLQoNC10LTQsNC60YLQuNGA0L7Q
stCw0YLRjDoge3VzZXJfZGF0YS5nZXQoJ2xvZ2luJywgJycpfSIpCiAgICAgICAgCiAgICAgICAg
c2VsZi5nZW9tZXRyeSgiNDUweDQ1MCIpCiAgICAgICAgCiAgICAgICAgc2VsZi50cmFuc2llbnQo
bWFzdGVyKQoKICAgICAgICBjdGsuQ1RrTGFiZWwoc2VsZiwgdGV4dD0i0JvQvtCz0LjQvToiKS5w
YWNrKGFuY2hvcj0idyIsIHBhZHg9MjAsIHBhZHk9KDEwLDApKQogICAgICAgIHNlbGYubG9naW5f
ZW50cnkgPSBjdGsuQ1RrRW50cnkoc2VsZiwgd2lkdGg9NDAwKQogICAgICAgIHNlbGYubG9naW5f
ZW50cnkucGFjayhwYWR4PTIwLCBwYWR5PSgwLDEwKSkKICAgICAgICAKICAgICAgICBjdGsuQ1Rr
TGFiZWwoc2VsZiwgdGV4dD0i0KTQmNCeOiIpLnBhY2soYW5jaG9yPSJ3IiwgcGFkeD0yMCwgcGFk
eT0oNSwwKSkKICAgICAgICBzZWxmLmZuYW1lX2VudHJ5ID0gY3RrLkNUa0VudHJ5KHNlbGYsIHdp
ZHRoPTQwMCkKICAgICAgICBzZWxmLmZuYW1lX2VudHJ5LnBhY2socGFkeD0yMCwgcGFkeT0oMCwx
MCkpCiAgICAgICAgCiAgICAgICAgY3RrLkNUa0xhYmVsKHNlbGYsIHRleHQ9ItCg0L7Qu9GMOiIp
LnBhY2soYW5jaG9yPSJ3IiwgcGFkeD0yMCwgcGFkeT0oNSwwKSkKICAgICAgICBzZWxmLnJvbGVf
dmFyID0gY3RrLlN0cmluZ1Zhcih2YWx1ZT0i0J/QvtC70YzQt9C+0LLQsNGC0LXQu9GMIikgIyDQ
l9C90LDRh9C10L3QuNC1INC/0L4g0YPQvNC+0LvRh9Cw0L3QuNGOCiAgICAgICAgY3RrLkNUa09w
dGlvbk1lbnUoc2VsZiwgdmFyaWFibGU9c2VsZi5yb2xlX3ZhciwgdmFsdWVzPVsi0J/QvtC70YzQ
t9C+0LLQsNGC0LXQu9GMIiwgItCQ0LTQvNC40L3QuNGB0YLRgNCw0YLQvtGAIl0sIHdpZHRoPTQw
MCkucGFjayhwYWR4PTIwLCBwYWR5PSgwLDEwKSkKICAgICAgICAKICAgICAgICBwYXNzX2xhYmVs
X3RleHQgPSAi0J/QsNGA0L7Qu9GMOiIgaWYgbW9kZSA9PSAiYWRkIiBlbHNlICLQndC+0LLRi9C5
INC/0LDRgNC+0LvRjCAo0L/Rg9GB0YLQviAtINC90LUg0LzQtdC90Y/RgtGMKToiCiAgICAgICAg
Y3RrLkNUa0xhYmVsKHNlbGYsIHRleHQ9cGFzc19sYWJlbF90ZXh0KS5wYWNrKGFuY2hvcj0idyIs
IHBhZHg9MjAsIHBhZHk9KDUsMCkpCiAgICAgICAgc2VsZi5wYXNzX2VudHJ5ID0gY3RrLkNUa0Vu
dHJ5KHNlbGYsIHNob3c9IioiLCB3aWR0aD00MDApCiAgICAgICAgc2VsZi5wYXNzX2VudHJ5LnBh
Y2socGFkeD0yMCwgcGFkeT0oMCwxMCkpCgogICAgICAgIGlmIG1vZGUgPT0gImVkaXQiOgogICAg
ICAgICAgICBzZWxmLmJsb2NrX3ZhciA9IGN0ay5Cb29sZWFuVmFyKHZhbHVlPXVzZXJfZGF0YS5n
ZXQoJ2lzX2Jsb2NrZWQnLCBGYWxzZSkpCiAgICAgICAgICAgIGN0ay5DVGtDaGVja0JveChzZWxm
LCB0ZXh0PSLQl9Cw0LHQu9C+0LrQuNGA0L7QstCw0L0iLCB2YXJpYWJsZT1zZWxmLmJsb2NrX3Zh
cikucGFjayhhbmNob3I9InciLCBwYWR4PTIwLCBwYWR5PSg1LDEwKSkKICAgICAgICAKICAgICAg
ICBpZiB1c2VyX2RhdGE6ICMg0J/RgNC10LTQt9Cw0L/QvtC70L3QtdC90LjQtSDQtNC70Y8g0YDQ
tdC20LjQvNCwINGA0LXQtNCw0LrRgtC40YDQvtCy0LDQvdC40Y8KICAgICAgICAgICAgc2VsZi5s
b2dpbl9lbnRyeS5pbnNlcnQoMCwgdXNlcl9kYXRhLmdldCgnbG9naW4nLCcnKSkKICAgICAgICAg
ICAgc2VsZi5mbmFtZV9lbnRyeS5pbnNlcnQoMCwgdXNlcl9kYXRhLmdldCgnZnVsbF9uYW1lJywn
JykpCiAgICAgICAgICAgIHNlbGYucm9sZV92YXIuc2V0KHVzZXJfZGF0YS5nZXQoJ3JvbGUnLCfQ
n9C+0LvRjNC30L7QstCw0YLQtdC70YwnKSkKCiAgICAgICAgY3RrLkNUa0J1dHRvbihzZWxmLCB0
ZXh0PSLQodC+0YXRgNCw0L3QuNGC0YwiLCBjb21tYW5kPXNlbGYuX3NhdmUsIHdpZHRoPTQwMCku
cGFjayhwYWR5PTIwKQoKICAgIGRlZiBfc2F2ZShzZWxmKToKICAgICAgICBsb2dpbiA9IHNlbGYu
bG9naW5fZW50cnkuZ2V0KCkKICAgICAgICBmbmFtZSA9IHNlbGYuZm5hbWVfZW50cnkuZ2V0KCkK
ICAgICAgICByb2xlID0gc2VsZi5yb2xlX3Zhci5nZXQoKQogICAgICAgIHBhc3N3b3JkID0gc2Vs
Zi5wYXNzX2VudHJ5LmdldCgpCgogICAgICAgIGlmIG5vdCBsb2dpbjoKICAgICAgICAgICAgbWVz
c2FnZWJveC5zaG93ZXJyb3IoItCe0YjQuNCx0LrQsCIsICLQm9C+0LPQuNC9INC+0LHRj9C30LDR
gtC10LvQtdC9LiIsIHBhcmVudD1zZWxmKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBpZiBz
ZWxmLm1vZGUgPT0gImFkZCIgYW5kIG5vdCBwYXNzd29yZDoKICAgICAgICAgICAgbWVzc2FnZWJv
eC5zaG93ZXJyb3IoItCe0YjQuNCx0LrQsCIsICLQn9Cw0YDQvtC70Ywg0L7QsdGP0LfQsNGC0LXQ
u9C10L0g0LTQu9GPINC90L7QstC+0LPQviDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y8uIiwgcGFy
ZW50PXNlbGYpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICByZXN1bHQgPSBOb25lCiAgICAg
ICAgdHJ5OgogICAgICAgICAgICBpZiBzZWxmLm1vZGUgPT0gImFkZCI6CiAgICAgICAgICAgICAg
ICByZXN1bHQgPSBjcmVhdGVfdXNlcl9zZXJ2aWNlKGxvZ2luLCBwYXNzd29yZCwgcm9sZSwgZm5h
bWUpCiAgICAgICAgICAgIGVsc2U6ICMgZWRpdCBtb2RlCiAgICAgICAgICAgICAgICBpc19ibG9j
a2VkX3ZhbCA9IHNlbGYuYmxvY2tfdmFyLmdldCgpIGlmIGhhc2F0dHIoc2VsZiwgJ2Jsb2NrX3Zh
cicpIGVsc2Ugc2VsZi51c2VyX2RhdGEuZ2V0KCdpc19ibG9ja2VkJykgCiAgICAgICAgICAgICAg
ICAKICAgICAgICAgICAgICAgIHVwZGF0ZV9wYXJhbXMgPSB7J3VzZXJfaWQnOiBzZWxmLnVzZXJf
ZGF0YVsnaWQnXX0KICAgICAgICAgICAgICAgICMg0J/QtdGA0LXQtNCw0LXQvCDQv9Cw0YDQsNC8
0LXRgtGA0YssINGC0L7Qu9GM0LrQviDQtdGB0LvQuCDQvtC90Lgg0LjQt9C80LXQvdC40LvQuNGB
0YwsINC40LvQuCDRjdGC0L4g0L3QvtCy0YvQuSDQv9Cw0YDQvtC70YwKICAgICAgICAgICAgICAg
IGlmIGxvZ2luICE9IHNlbGYudXNlcl9kYXRhLmdldCgnbG9naW4nKTogdXBkYXRlX3BhcmFtc1sn
bG9naW4nXSA9IGxvZ2luCiAgICAgICAgICAgICAgICBpZiBmbmFtZSAhPSBzZWxmLnVzZXJfZGF0
YS5nZXQoJ2Z1bGxfbmFtZScpOiB1cGRhdGVfcGFyYW1zWydmdWxsX25hbWUnXSA9IGZuYW1lCiAg
ICAgICAgICAgICAgICBpZiByb2xlICE9IHNlbGYudXNlcl9kYXRhLmdldCgncm9sZScpOiB1cGRh
dGVfcGFyYW1zWydyb2xlJ10gPSByb2xlCiAgICAgICAgICAgICAgICBpZiBwYXNzd29yZDogdXBk
YXRlX3BhcmFtc1snbmV3X3Bhc3N3b3JkJ10gPSBwYXNzd29yZCAKICAgICAgICAgICAgICAgIGlm
IGlzX2Jsb2NrZWRfdmFsICE9IHNlbGYudXNlcl9kYXRhLmdldCgnaXNfYmxvY2tlZCcpOgogICAg
ICAgICAgICAgICAgICAgIHVwZGF0ZV9wYXJhbXNbJ2lzX2Jsb2NrZWQnXSA9IGlzX2Jsb2NrZWRf
dmFsCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHVpZF90ZW1wID0gdXBkYXRlX3Bh
cmFtcy5wb3AoJ3VzZXJfaWQnKSAjIHVzZXJfaWQg0L/QtdGA0LXQtNCw0LXRgtGB0Y8g0L/QtdGA
0LLRi9C8INCw0YDQs9GD0LzQtdC90YLQvtC8CiAgICAgICAgICAgICAgICBpZiBsZW4odXBkYXRl
X3BhcmFtcykgPiAwOiAjINCi0L7Qu9GM0LrQviDQtdGB0LvQuCDQtdGB0YLRjCDRh9GC0L4g0L7Q
sdC90L7QstC70Y/RgtGMCiAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHVwZGF0ZV91c2Vy
X3NlcnZpY2UodWlkX3RlbXAsICoqdXBkYXRlX3BhcmFtcykKICAgICAgICAgICAgICAgIGVsc2U6
CiAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHsic3RhdHVzIjogImluZm8iLCAibWVzc2Fn
ZSI6ICLQndC10YIg0LjQt9C80LXQvdC10L3QuNC5INC00LvRjyDRgdC+0YXRgNCw0L3QtdC90LjR
jy4ifQoKICAgICAgICAgICAgaWYgcmVzdWx0IGFuZCByZXN1bHRbInN0YXR1cyJdID09ICJzdWNj
ZXNzIjoKICAgICAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2luZm8oItCj0YHQv9C10YUiLCBy
ZXN1bHRbIm1lc3NhZ2UiXSwgcGFyZW50PXNlbGYpCiAgICAgICAgICAgICAgICBpZiBzZWxmLmNh
bGxiYWNrOiBzZWxmLmNhbGxiYWNrKCkKICAgICAgICAgICAgICAgIHNlbGYuZGVzdHJveSgpCiAg
ICAgICAgICAgIGVsaWYgcmVzdWx0IGFuZCByZXN1bHRbInN0YXR1cyJdID09ICJpbmZvIjoKICAg
ICAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2luZm8oItCY0L3RhNC+0YDQvNCw0YbQuNGPIiwg
cmVzdWx0WyJtZXNzYWdlIl0sIHBhcmVudD1zZWxmKQogICAgICAgICAgICAgICAgc2VsZi5kZXN0
cm95KCkgIyDQl9Cw0LrRgNGL0LLQsNC10Lwg0L7QutC90L4sINC00LDQttC1INC10YHQu9C4INC9
0LUg0LHRi9C70L4g0LjQt9C80LXQvdC10L3QuNC5CiAgICAgICAgICAgIGVsaWYgcmVzdWx0OiAj
INCe0YjQuNCx0LrQsAogICAgICAgICAgICAgICAgbWVzc2FnZWJveC5zaG93ZXJyb3IoItCe0YjQ
uNCx0LrQsCIsIHJlc3VsdFsibWVzc2FnZSJdLCBwYXJlbnQ9c2VsZikKICAgICAgICBleGNlcHQg
RXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2Vycm9yKCLQmtGA0LjR
gtC40YfQtdGB0LrQsNGPINC+0YjQuNCx0LrQsCIsIGYi0J7RiNC40LHQutCwINC/0YDQuCDRgdC+
0YXRgNCw0L3QtdC90LjQuCDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y86IHtlfSIsIHBhcmVudD1z
ZWxmKQoKCmNsYXNzIEFkbWluRGFzaGJvYXJkKGN0ay5DVGtGcmFtZSk6CiAgICAjIC4uLiAo0LrQ
vtC0INGN0YLQvtCz0L4g0LrQu9Cw0YHRgdCwINC+0YHRgtCw0LXRgtGB0Y8g0L/QvtGH0YLQuCDR
gtCw0LrQuNC8INC20LUsINC60LDQuiDQsiDQv9GA0LXQtNGL0LTRg9GJ0LXQuSDQstC10YDRgdC4
0LgsINGC0L7Qu9GM0LrQviDQstGL0LfQvtCy0Ysg0YHQtdGA0LLQuNGB0L7QsiDRgtC10L/QtdGA
0Ywg0LHQtdC3IGNvbm4pCiAgICBkZWYgX19pbml0X18oc2VsZiwgbWFzdGVyLCBhcHBfY29udHJv
bGxlcik6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhtYXN0ZXIpCiAgICAgICAgc2VsZi5hcHBf
Y29udHJvbGxlciA9IGFwcF9jb250cm9sbGVyCiAgICAgICAgdXNlciA9IHNlbGYuYXBwX2NvbnRy
b2xsZXIuY3VycmVudF91c2VyCiAgICAgICAgc2VsZi5tYXN0ZXIudGl0bGUoZiLQkNC00LzQuNC9
OiB7dXNlci5nZXQoJ2Z1bGxfbmFtZScsIHVzZXJbJ2xvZ2luJ10pfSIpCiAgICAgICAgc2VsZi5t
YXN0ZXIuZ2VvbWV0cnkoIjcwMHg1NTAiKSAjINCj0LLQtdC70LjRh9C40Lsg0LLRi9GB0L7RgtGD
INC00LvRjyDRgtCw0LHQu9C40YbRiwogICAgICAgIHNlbGYucGFjayhwYWR5PTEwLCBwYWR4PTEw
LCBmaWxsPSJib3RoIiwgZXhwYW5kPVRydWUpCgogICAgICAgIGN0ay5DVGtMYWJlbChzZWxmLCB0
ZXh0PSLQoNCw0LHQvtGH0LjQuSDRgdGC0L7QuyDQkNC00LzQuNC90LjRgdGC0YDQsNGC0L7RgNCw
IiwgZm9udD0oIkFyaWFsIiwgMTgpKS5wYWNrKHBhZHk9MTApCiAgICAgICAgCiAgICAgICAgdG9w
X2J1dHRvbnNfZnJhbWUgPSBjdGsuQ1RrRnJhbWUoc2VsZiwgZmdfY29sb3I9InRyYW5zcGFyZW50
IikKICAgICAgICB0b3BfYnV0dG9uc19mcmFtZS5wYWNrKHBhZHk9NSwgcGFkeD01LCBmaWxsPSJ4
IikKCiAgICAgICAgY3RrLkNUa0J1dHRvbih0b3BfYnV0dG9uc19mcmFtZSwgdGV4dD0i0KPQv9GA
0LDQstC70LXQvdC40LUg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GP0LzQuCIsIGNvbW1hbmQ9bGFt
YmRhOiBVc2VyTWFuYWdlbWVudFdpbmRvdyhzZWxmLm1hc3Rlciwgc2VsZi5hcHBfY29udHJvbGxl
cikpLnBhY2soc2lkZT0ibGVmdCIsIHBhZHg9NSwgcGFkeT01KQogICAgICAgIGN0ay5DVGtCdXR0
b24odG9wX2J1dHRvbnNfZnJhbWUsIHRleHQ9ItCY0LzQv9C+0YDRgiDQvdC+0LzQtdGA0L7QsiAo
Q1NWKSIsIGNvbW1hbmQ9c2VsZi5faW1wb3J0X3Jvb21zKS5wYWNrKHNpZGU9ImxlZnQiLCBwYWR4
PTUsIHBhZHk9NSkKICAgICAgICBjdGsuQ1RrQnV0dG9uKHRvcF9idXR0b25zX2ZyYW1lLCB0ZXh0
PSIlINC30LDQs9GA0YPQt9C60Lgg0L3QvtC80LXRgNC+0LIiLCBjb21tYW5kPXNlbGYuX3Nob3df
b2NjdXBhbmN5KS5wYWNrKHNpZGU9ImxlZnQiLCBwYWR4PTUsIHBhZHk9NSkKICAgICAgICBjdGsu
Q1RrQnV0dG9uKHRvcF9idXR0b25zX2ZyYW1lLCB0ZXh0PSLQktCw0LvQuNC00LDRhtC40Y8g0KTQ
mNCeICjQnDQpIiwgY29tbWFuZD1zZWxmLl9vcGVuX3ZhbGlkYXRpb25fbW9kdWxlKS5wYWNrKHNp
ZGU9ImxlZnQiLCBwYWR4PTUsIHBhZHk9NSkKICAgICAgICAKICAgICAgICBjdGsuQ1RrTGFiZWwo
c2VsZiwgdGV4dD0i0KHQvtGB0YLQvtGP0L3QuNC1INC90L7QvNC10YDQvdC+0LPQviDRhNC+0L3Q
tNCwOiIsIGZvbnQ9KCJBcmlhbCIsIDE0KSkucGFjayhwYWR5PSgxMCwwKSwgYW5jaG9yPSJ3Iiwg
cGFkeD01KQogICAgICAgIAogICAgICAgIHN0eWxlID0gdHRrLlN0eWxlKHNlbGYpCiAgICAgICAg
c3R5bGUudGhlbWVfdXNlKCJkZWZhdWx0IikKICAgICAgICBzdHlsZS5jb25maWd1cmUoIlRyZWV2
aWV3LkhlYWRpbmciLCBmb250PSgnQXJpYWwnLCAxMCwgJ2JvbGQnKSkKICAgICAgICBzZWxmLnJv
b21zX3RyZWUgPSB0dGsuVHJlZXZpZXcoc2VsZiwgY29sdW1ucz0oIm51bWJlciIsICJmbG9vciIs
ICJjYXRlZ29yeSIsICJzdGF0dXMiKSwgc2hvdz0iaGVhZGluZ3MiKQogICAgICAgIHNlbGYucm9v
bXNfdHJlZS5oZWFkaW5nKCJudW1iZXIiLCB0ZXh0PSLQndC+0LzQtdGAIikKICAgICAgICBzZWxm
LnJvb21zX3RyZWUuY29sdW1uKCJudW1iZXIiLCB3aWR0aD04MCwgYW5jaG9yPSJ3Iiwgc3RyZXRj
aD1GYWxzZSkKICAgICAgICBzZWxmLnJvb21zX3RyZWUuaGVhZGluZygiZmxvb3IiLCB0ZXh0PSLQ
rdGC0LDQtiIpCiAgICAgICAgc2VsZi5yb29tc190cmVlLmNvbHVtbigiZmxvb3IiLCB3aWR0aD0x
NTAsIGFuY2hvcj0idyIpCiAgICAgICAgc2VsZi5yb29tc190cmVlLmhlYWRpbmcoImNhdGVnb3J5
IiwgdGV4dD0i0JrQsNGC0LXQs9C+0YDQuNGPIikKICAgICAgICBzZWxmLnJvb21zX3RyZWUuY29s
dW1uKCJjYXRlZ29yeSIsIHdpZHRoPTIwMCwgYW5jaG9yPSJ3IikKICAgICAgICBzZWxmLnJvb21z
X3RyZWUuaGVhZGluZygic3RhdHVzIiwgdGV4dD0i0KHRgtCw0YLRg9GBIikKICAgICAgICBzZWxm
LnJvb21zX3RyZWUuY29sdW1uKCJzdGF0dXMiLCB3aWR0aD0xMjAsIGFuY2hvcj0idyIpCiAgICAg
ICAgc2VsZi5yb29tc190cmVlLnBhY2socGFkeT01LCBwYWR4PTUsIGZpbGw9ImJvdGgiLCBleHBh
bmQ9VHJ1ZSkKICAgICAgICBzZWxmLl9sb2FkX3Jvb21fZGV0YWlscygpCgogICAgICAgIGN0ay5D
VGtCdXR0b24oc2VsZiwgdGV4dD0i0JLRi9GF0L7QtCIsIGNvbW1hbmQ9c2VsZi5hcHBfY29udHJv
bGxlci5sb2dvdXQpLnBhY2socGFkeT0xMCwgc2lkZT0iYm90dG9tIikKCiAgICBkZWYgX2ltcG9y
dF9yb29tcyhzZWxmKToKICAgICAgICBpZiBtZXNzYWdlYm94LmFza3llc25vKCLQmNC80L/QvtGA
0YIiLCBmItCY0LzQv9C+0YDRgtC40YDQvtCy0LDRgtGMINC00LDQvdC90YvQtSDQuNC3ICd7Q1NW
X0ZJTEVfUEFUSH0nP1xu0KHRg9GJ0LXRgdGC0LLRg9GO0YnQuNC1INC90L7QvNC10YDQsCDQvdC1
INCx0YPQtNGD0YIg0L/QtdGA0LXQt9Cw0L/QuNGB0LDQvdGLLiIsIHBhcmVudD1zZWxmLm1hc3Rl
cik6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGltcG9ydF9yb29tX2RhdGFfZnJv
bV9jc3YoKQogICAgICAgICAgICAgICAgc2VsZi5fbG9hZF9yb29tX2RldGFpbHMoKQogICAgICAg
ICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBtZXNzYWdlYm94LnNo
b3dlcnJvcigi0J7RiNC40LHQutCwINC40LzQv9C+0YDRgtCwIiwgZiLQn9GA0L7QuNC30L7RiNC7
0LAg0L7RiNC40LHQutCwINCy0L4g0LLRgNC10LzRjyDQuNC80L/QvtGA0YLQsDoge2V9IiwgcGFy
ZW50PXNlbGYubWFzdGVyKQoKCiAgICBkZWYgX3Nob3dfb2NjdXBhbmN5KHNlbGYpOgogICAgICAg
IHRyeToKICAgICAgICAgICAgcGVyY2VudGFnZSA9IGdldF9yb29tX29jY3VwYW5jeV9wZXJjZW50
YWdlX3NlcnZpY2UoKQogICAgICAgICAgICBtZXNzYWdlYm94LnNob3dpbmZvKCLQl9Cw0LPRgNGD
0LfQutCwINC90L7QvNC10YDQvtCyIiwgZiLQotC10LrRg9GJ0LDRjyDQt9Cw0LPRgNGD0LfQutCw
OiB7cGVyY2VudGFnZTouMmZ9JSIsIHBhcmVudD1zZWxmLm1hc3RlcikKICAgICAgICBleGNlcHQg
RXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICBtZXNzYWdlYm94LnNob3dlcnJvcigi0J7RiNC4
0LHQutCwIiwgZiLQndC1INGD0LTQsNC70L7RgdGMINGA0LDRgdGB0YfQuNGC0LDRgtGMINC30LDQ
s9GA0YPQt9C60YM6IHtlfSIsIHBhcmVudD1zZWxmLm1hc3RlcikKICAgIAogICAgZGVmIF9sb2Fk
X3Jvb21fZGV0YWlscyhzZWxmKToKICAgICAgICBmb3IgaSBpbiBzZWxmLnJvb21zX3RyZWUuZ2V0
X2NoaWxkcmVuKCk6CiAgICAgICAgICAgIHNlbGYucm9vbXNfdHJlZS5kZWxldGUoaSkKICAgICAg
ICB0cnk6CiAgICAgICAgICAgIHJvb21zID0gZ2V0X2FsbF9yb29tc193aXRoX2RldGFpbHNfc2Vy
dmljZSgpCiAgICAgICAgICAgIGlmIHJvb21zOgogICAgICAgICAgICAgICAgZm9yIHJvb20gaW4g
cm9vbXM6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5yb29tc190cmVlLmluc2VydCgiIiwgImVu
ZCIsIHZhbHVlcz0oCiAgICAgICAgICAgICAgICAgICAgICAgIHJvb20uZ2V0KCdyb29tX251bWJl
cicsJycpLCAKICAgICAgICAgICAgICAgICAgICAgICAgcm9vbS5nZXQoJ2Zsb29yX25hbWUnLCcn
KSwgCiAgICAgICAgICAgICAgICAgICAgICAgIHJvb20uZ2V0KCdjYXRlZ29yeV9uYW1lJywnJyks
IAogICAgICAgICAgICAgICAgICAgICAgICByb29tLmdldCgnc3RhdHVzX25hbWUnLCcnKQogICAg
ICAgICAgICAgICAgICAgICkpCiAgICAgICAgICAgIGVsc2U6ICMg0JXRgdC70Lgg0YHQtdGA0LLQ
uNGBINCy0LXRgNC90YPQuyBOb25lINC40LvQuCDQv9GD0YHRgtC+0Lkg0YHQv9C40YHQvtC6CiAg
ICAgICAgICAgICAgICBzZWxmLnJvb21zX3RyZWUuaW5zZXJ0KCIiLCAiZW5kIiwgdmFsdWVzPSgi
0J3QtdGCINC00LDQvdC90YvRhSIsICIiLCAiIiwgIiIpKQogICAgICAgIGV4Y2VwdCBFeGNlcHRp
b24gYXMgZToKICAgICAgICAgICAgbWVzc2FnZWJveC5zaG93ZXJyb3IoItCe0YjQuNCx0LrQsCDQ
t9Cw0LPRgNGD0LfQutC4IiwgZiLQndC1INGD0LTQsNC70L7RgdGMINC30LDQs9GA0YPQt9C40YLR
jCDQvdC+0LzQtdGA0LA6IHtlfSIsIHBhcmVudD1zZWxmKQogICAgICAgICAgICBzZWxmLnJvb21z
X3RyZWUuaW5zZXJ0KCIiLCAiZW5kIiwgdmFsdWVzPSgi0J7RiNC40LHQutCwINC30LDQs9GA0YPQ
t9C60LgiLCAiIiwgIiIsICIiKSkKCgogICAgZGVmIF9vcGVuX3ZhbGlkYXRpb25fbW9kdWxlKHNl
bGYpOgogICAgICAgIFZhbGlkYXRpb25XaW5kb3coc2VsZi5tYXN0ZXIsIHNlbGYuYXBwX2NvbnRy
b2xsZXIpCgoKY2xhc3MgVXNlckRhc2hib2FyZChjdGsuQ1RrRnJhbWUpOgogICAgZGVmIF9faW5p
dF9fKHNlbGYsIG1hc3RlciwgYXBwX2NvbnRyb2xsZXIpOgogICAgICAgIHN1cGVyKCkuX19pbml0
X18obWFzdGVyKQogICAgICAgIHNlbGYuYXBwX2NvbnRyb2xsZXIgPSBhcHBfY29udHJvbGxlcgog
ICAgICAgIHVzZXIgPSBzZWxmLmFwcF9jb250cm9sbGVyLmN1cnJlbnRfdXNlcgogICAgICAgIHNl
bGYubWFzdGVyLnRpdGxlKGYi0J/QvtC70YzQt9C+0LLQsNGC0LXQu9GMOiB7dXNlci5nZXQoJ2Z1
bGxfbmFtZScsIHVzZXJbJ2xvZ2luJ10pfSIpCiAgICAgICAgc2VsZi5tYXN0ZXIuZ2VvbWV0cnko
IjY1MHg0NTAiKSAjINCY0LfQvNC10L3QuNC7INGA0LDQt9C80LXRgAogICAgICAgIHNlbGYucGFj
ayhwYWR5PTEwLCBwYWR4PTEwLCBmaWxsPSJib3RoIiwgZXhwYW5kPVRydWUpCgogICAgICAgIGN0
ay5DVGtMYWJlbChzZWxmLCB0ZXh0PSLQoNCw0LHQvtGH0LjQuSDRgdGC0L7QuyDQodC+0YLRgNGD
0LTQvdC40LrQsCIsIGZvbnQ9KCJBcmlhbCIsIDE4KSkucGFjayhwYWR5PTEwKQogICAgICAgIGN0
ay5DVGtCdXR0b24oc2VsZiwgdGV4dD0i0KHQvNC10L3QuNGC0Ywg0YHQstC+0Lkg0L/QsNGA0L7Q
u9GMIiwgY29tbWFuZD1sYW1iZGE6IHNlbGYuYXBwX2NvbnRyb2xsZXIuc2hvd19jaGFuZ2VfcGFz
c3dvcmRfd2luZG93KGluaXRpYWxfY2hhbmdlPUZhbHNlKSkucGFjayhwYWR5PTEwKQogICAgICAg
IAogICAgICAgIGN0ay5DVGtMYWJlbChzZWxmLCB0ZXh0PSLQlNC+0YHRgtGD0L/QvdGL0LUg0L3Q
vtC80LXRgNCwOiIsIGZvbnQ9KCJBcmlhbCIsIDE0KSkucGFjayhwYWR5PSgxMCwwKSwgYW5jaG9y
PSJ3IiwgcGFkeD01KQogICAgICAgIAogICAgICAgIHN0eWxlID0gdHRrLlN0eWxlKHNlbGYpCiAg
ICAgICAgc3R5bGUudGhlbWVfdXNlKCJkZWZhdWx0IikKICAgICAgICBzdHlsZS5jb25maWd1cmUo
IlRyZWV2aWV3LkhlYWRpbmciLCBmb250PSgnQXJpYWwnLCAxMCwgJ2JvbGQnKSkKICAgICAgICBz
ZWxmLnJvb21zX3RyZWUgPSB0dGsuVHJlZXZpZXcoc2VsZiwgY29sdW1ucz0oIm51bWJlciIsICJm
bG9vciIsICJjYXRlZ29yeSIsICJzdGF0dXMiKSwgc2hvdz0iaGVhZGluZ3MiKQogICAgICAgIHNl
bGYucm9vbXNfdHJlZS5oZWFkaW5nKCJudW1iZXIiLCB0ZXh0PSLQndC+0LzQtdGAIikKICAgICAg
ICBzZWxmLnJvb21zX3RyZWUuY29sdW1uKCJudW1iZXIiLCB3aWR0aD04MCwgYW5jaG9yPSJ3Iiwg
c3RyZXRjaD1GYWxzZSkKICAgICAgICBzZWxmLnJvb21zX3RyZWUuaGVhZGluZygiZmxvb3IiLCB0
ZXh0PSLQrdGC0LDQtiIpCiAgICAgICAgc2VsZi5yb29tc190cmVlLmNvbHVtbigiZmxvb3IiLCB3
aWR0aD0xNTAsIGFuY2hvcj0idyIpCiAgICAgICAgc2VsZi5yb29tc190cmVlLmhlYWRpbmcoImNh
dGVnb3J5IiwgdGV4dD0i0JrQsNGC0LXQs9C+0YDQuNGPIikKICAgICAgICBzZWxmLnJvb21zX3Ry
ZWUuY29sdW1uKCJjYXRlZ29yeSIsIHdpZHRoPTIwMCwgYW5jaG9yPSJ3IikKICAgICAgICBzZWxm
LnJvb21zX3RyZWUuaGVhZGluZygic3RhdHVzIiwgdGV4dD0i0KHRgtCw0YLRg9GBIikKICAgICAg
ICBzZWxmLnJvb21zX3RyZWUuY29sdW1uKCJzdGF0dXMiLCB3aWR0aD0xMjAsIGFuY2hvcj0idyIp
CiAgICAgICAgc2VsZi5yb29tc190cmVlLnBhY2socGFkeT01LCBwYWR4PTUsIGZpbGw9ImJvdGgi
LCBleHBhbmQ9VHJ1ZSkKICAgICAgICBzZWxmLl9sb2FkX3Jvb21fZGV0YWlscygpCgogICAgICAg
IGN0ay5DVGtCdXR0b24oc2VsZiwgdGV4dD0i0JLRi9GF0L7QtCIsIGNvbW1hbmQ9c2VsZi5hcHBf
Y29udHJvbGxlci5sb2dvdXQpLnBhY2socGFkeT0xMCwgc2lkZT0iYm90dG9tIikKCiAgICBkZWYg
X2xvYWRfcm9vbV9kZXRhaWxzKHNlbGYpOgogICAgICAgIGZvciBpIGluIHNlbGYucm9vbXNfdHJl
ZS5nZXRfY2hpbGRyZW4oKToKICAgICAgICAgICAgc2VsZi5yb29tc190cmVlLmRlbGV0ZShpKQog
ICAgICAgIHRyeToKICAgICAgICAgICAgcm9vbXMgPSBnZXRfYWxsX3Jvb21zX3dpdGhfZGV0YWls
c19zZXJ2aWNlKCkKICAgICAgICAgICAgaWYgcm9vbXM6CiAgICAgICAgICAgICAgICBmb3Igcm9v
bSBpbiByb29tczoKICAgICAgICAgICAgICAgICAgICBzZWxmLnJvb21zX3RyZWUuaW5zZXJ0KCIi
LCAiZW5kIiwgdmFsdWVzPSgKICAgICAgICAgICAgICAgICAgICAgICAgcm9vbS5nZXQoJ3Jvb21f
bnVtYmVyJywnJyksIAogICAgICAgICAgICAgICAgICAgICAgICByb29tLmdldCgnZmxvb3JfbmFt
ZScsJycpLCAKICAgICAgICAgICAgICAgICAgICAgICAgcm9vbS5nZXQoJ2NhdGVnb3J5X25hbWUn
LCcnKSwgCiAgICAgICAgICAgICAgICAgICAgICAgIHJvb20uZ2V0KCdzdGF0dXNfbmFtZScsJycp
CiAgICAgICAgICAgICAgICAgICAgKSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAg
IHNlbGYucm9vbXNfdHJlZS5pbnNlcnQoIiIsICJlbmQiLCB2YWx1ZXM9KCLQndC10YIg0LTQsNC9
0L3Ri9GFIiwgIiIsICIiLCAiIikpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAg
ICAgICAgICBtZXNzYWdlYm94LnNob3dlcnJvcigi0J7RiNC40LHQutCwINC30LDQs9GA0YPQt9C6
0LgiLCBmItCd0LUg0YPQtNCw0LvQvtGB0Ywg0LfQsNCz0YDRg9C30LjRgtGMINC90L7QvNC10YDQ
sDoge2V9IiwgcGFyZW50PXNlbGYpCiAgICAgICAgICAgIHNlbGYucm9vbXNfdHJlZS5pbnNlcnQo
IiIsICJlbmQiLCB2YWx1ZXM9KCLQntGI0LjQsdC60LAg0LfQsNCz0YDRg9C30LrQuCIsICIiLCAi
IiwgIiIpKQoKCmNsYXNzIFZhbGlkYXRpb25XaW5kb3coY3RrLkNUa1RvcGxldmVsKTogIyDQnNC+
0LTRg9C70YwgNCAtINCj0L/RgNC+0YnQtdC90L3Ri9C5CiAgICBkZWYgX19pbml0X18oc2VsZiwg
bWFzdGVyLCBhcHBfY29udHJvbGxlcik6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhtYXN0ZXIp
CiAgICAgICAgc2VsZi5hcHBfY29udHJvbGxlciA9IGFwcF9jb250cm9sbGVyICMg0J3QtSDQuNGB
0L/QvtC70YzQt9GD0LXRgtGB0Y8sINC90L4g0L/QviDRgdGC0YDRg9C60YLRg9GA0LUg0L/QtdGA
0LXQtNCw0LXQvAogICAgICAgIHNlbGYudGl0bGUoItCS0LDQu9C40LTQsNGG0LjRjyDQtNCw0L3Q
vdGL0YUiKQogICAgICAgIHNlbGYuZ2VvbWV0cnkoIjU1MHgyMDAiKSAjINCj0LzQtdC90YzRiNC4
0Lsg0YDQsNC30LzQtdGACiAgICAgICAgCiAgICAgICAgc2VsZi50cmFuc2llbnQobWFzdGVyKQog
ICAgICAgIHNlbGYucmVzaXphYmxlKEZhbHNlLCBGYWxzZSkKCiAgICAgICAgbWFpbl9mcmFtZSA9
IGN0ay5DVGtGcmFtZShzZWxmLCBmZ19jb2xvcj0idHJhbnNwYXJlbnQiKQogICAgICAgIG1haW5f
ZnJhbWUucGFjayhwYWR5PTIwLCBwYWR4PTIwLCBmaWxsPSJib3RoIiwgZXhwYW5kPVRydWUpCgog
ICAgICAgICMg0J/QtdGA0LLQsNGPINGB0YLRgNC+0LrQsDog0JrQvdC+0L/QutCwICLQn9C+0LvR
g9GH0LjRgtGMINC00LDQvdC90YvQtSIg0Lgg0YLQtdC60YHRgtC+0LLQvtC1INC/0L7Qu9C1INC0
0LvRjyDQpNCY0J4KICAgICAgICBmcmFtZV9nZXRfZGF0YSA9IGN0ay5DVGtGcmFtZShtYWluX2Zy
YW1lLCBmZ19jb2xvcj0idHJhbnNwYXJlbnQiKQogICAgICAgIGZyYW1lX2dldF9kYXRhLnBhY2so
ZmlsbD0ieCIsIHBhZHk9NSkKCiAgICAgICAgc2VsZi5nZXRfZGF0YV9idXR0b24gPSBjdGsuQ1Rr
QnV0dG9uKGZyYW1lX2dldF9kYXRhLCB0ZXh0PSLQn9C+0LvRg9GH0LjRgtGMINC00LDQvdC90YvQ
tSIsIGNvbW1hbmQ9c2VsZi5fZ2V0X2RhdGFfZnJvbV9hcGksIHdpZHRoPTE4MCkKICAgICAgICBz
ZWxmLmdldF9kYXRhX2J1dHRvbi5wYWNrKHNpZGU9ImxlZnQiLCBwYWR4PSgwLCAxMCkpCgogICAg
ICAgIHNlbGYuZmlvX2Rpc3BsYXlfZW50cnkgPSBjdGsuQ1RrRW50cnkoZnJhbWVfZ2V0X2RhdGEs
IHBsYWNlaG9sZGVyX3RleHQ9ItCk0JjQniDRgSBBUEkiLCB3aWR0aD0zMDApCiAgICAgICAgc2Vs
Zi5maW9fZGlzcGxheV9lbnRyeS5wYWNrKHNpZGU9ImxlZnQiLCBmaWxsPSJ4IiwgZXhwYW5kPVRy
dWUpCiAgICAgICAgc2VsZi5maW9fZGlzcGxheV9lbnRyeS5jb25maWd1cmUoc3RhdGU9InJlYWRv
bmx5IikKCiAgICAgICAgIyDQktGC0L7RgNCw0Y8g0YHRgtGA0L7QutCwOiDQmtC90L7Qv9C60LAg
ItCe0YLQv9GA0LDQstC40YLRjCDRgNC10LfRg9C70YzRgtCw0YIg0YLQtdGB0YLQsCIg0Lgg0YLQ
tdC60YHRgtC+0LLQvtC1INC/0L7Qu9C1INC00LvRjyDRgNC10LfRg9C70YzRgtCw0YLQsAogICAg
ICAgIGZyYW1lX3NlbmRfcmVzdWx0ID0gY3RrLkNUa0ZyYW1lKG1haW5fZnJhbWUsIGZnX2NvbG9y
PSJ0cmFuc3BhcmVudCIpCiAgICAgICAgZnJhbWVfc2VuZF9yZXN1bHQucGFjayhmaWxsPSJ4Iiwg
cGFkeT0xNSkKCiAgICAgICAgc2VsZi5zZW5kX3Jlc3VsdF9idXR0b24gPSBjdGsuQ1RrQnV0dG9u
KGZyYW1lX3NlbmRfcmVzdWx0LCB0ZXh0PSLQntGC0L/RgNCw0LLQuNGC0Ywg0YDQtdC30YPQu9GM
0YLQsNGCINGC0LXRgdGC0LAiLCBjb21tYW5kPXNlbGYuX3NlbmRfdGVzdF9yZXN1bHQsIHdpZHRo
PTE4MCkKICAgICAgICBzZWxmLnNlbmRfcmVzdWx0X2J1dHRvbi5wYWNrKHNpZGU9ImxlZnQiLCBw
YWR4PSgwLCAxMCkpCgogICAgICAgIHNlbGYudmFsaWRhdGlvbl9zdGF0dXNfZW50cnkgPSBjdGsu
Q1RrRW50cnkoZnJhbWVfc2VuZF9yZXN1bHQsIHBsYWNlaG9sZGVyX3RleHQ9ItCh0YLQsNGC0YPR
gSDQstCw0LvQuNC00LDRhtC40LgiLCB3aWR0aD0zMDApCiAgICAgICAgc2VsZi52YWxpZGF0aW9u
X3N0YXR1c19lbnRyeS5wYWNrKHNpZGU9ImxlZnQiLCBmaWxsPSJ4IiwgZXhwYW5kPVRydWUpCiAg
ICAgICAgc2VsZi52YWxpZGF0aW9uX3N0YXR1c19lbnRyeS5jb25maWd1cmUoc3RhdGU9InJlYWRv
bmx5IikKCgogICAgZGVmIF9nZXRfZGF0YV9mcm9tX2FwaShzZWxmKToKICAgICAgICBmaW8gPSBn
ZXRfZnVsbG5hbWVfZnJvbV9hcGkoKQogICAgICAgIHNlbGYuZmlvX2Rpc3BsYXlfZW50cnkuY29u
ZmlndXJlKHN0YXRlPSJub3JtYWwiKQogICAgICAgIHNlbGYuZmlvX2Rpc3BsYXlfZW50cnkuZGVs
ZXRlKDAsICJlbmQiKQogICAgICAgIGlmIGZpbzoKICAgICAgICAgICAgc2VsZi5maW9fZGlzcGxh
eV9lbnRyeS5pbnNlcnQoMCwgZmlvKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZmlv
X2Rpc3BsYXlfZW50cnkuaW5zZXJ0KDAsICLQntGI0LjQsdC60LAg0L/QvtC70YPRh9C10L3QuNGP
INCk0JjQniDRgSBBUEkiKQogICAgICAgIHNlbGYuZmlvX2Rpc3BsYXlfZW50cnkuY29uZmlndXJl
KHN0YXRlPSJyZWFkb25seSIpCiAgICAgICAgCiAgICAgICAgIyDQodGA0LDQt9GDINC+0YfQuNGJ
0LDQtdC8INC/0L7Qu9C1INGA0LXQt9GD0LvRjNGC0LDRgtCwINCy0LDQu9C40LTQsNGG0LjQuCwg
0YIu0LouINC00LDQvdC90YvQtSDQvdC+0LLRi9C1CiAgICAgICAgc2VsZi52YWxpZGF0aW9uX3N0
YXR1c19lbnRyeS5jb25maWd1cmUoc3RhdGU9Im5vcm1hbCIpCiAgICAgICAgc2VsZi52YWxpZGF0
aW9uX3N0YXR1c19lbnRyeS5kZWxldGUoMCwgImVuZCIpCiAgICAgICAgc2VsZi52YWxpZGF0aW9u
X3N0YXR1c19lbnRyeS5jb25maWd1cmUoc3RhdGU9InJlYWRvbmx5IikKCgogICAgZGVmIF9zZW5k
X3Rlc3RfcmVzdWx0KHNlbGYpOgogICAgICAgIGZpb190b192YWxpZGF0ZSA9IHNlbGYuZmlvX2Rp
c3BsYXlfZW50cnkuZ2V0KCkKICAgICAgICBzZWxmLnZhbGlkYXRpb25fc3RhdHVzX2VudHJ5LmNv
bmZpZ3VyZShzdGF0ZT0ibm9ybWFsIikKICAgICAgICBzZWxmLnZhbGlkYXRpb25fc3RhdHVzX2Vu
dHJ5LmRlbGV0ZSgwLCAiZW5kIikKCiAgICAgICAgaWYgbm90IGZpb190b192YWxpZGF0ZSBvciAi
0J7RiNC40LHQutCwINC/0L7Qu9GD0YfQtdC90LjRjyIgaW4gZmlvX3RvX3ZhbGlkYXRlOgogICAg
ICAgICAgICBzZWxmLnZhbGlkYXRpb25fc3RhdHVzX2VudHJ5Lmluc2VydCgwLCAi0J3QtdGCINCk
0JjQniDQtNC70Y8g0L/RgNC+0LLQtdGA0LrQuCIpCiAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hv
d3dhcm5pbmcoItCS0L3QuNC80LDQvdC40LUiLCAi0KHQvdCw0YfQsNC70LAg0L/QvtC70YPRh9C4
0YLQtSDQpNCY0J4g0YEgQVBJLiIsIHBhcmVudD1zZWxmKQogICAgICAgIGVsc2U6CiAgICAgICAg
ICAgIGlzX3ZhbGlkID0gdmFsaWRhdGVfZmlvX3NlcnZpY2UoZmlvX3RvX3ZhbGlkYXRlKSAjINCY
0YHQv9C+0LvRjNC30YPQtdC8INGD0L/RgNC+0YnQtdC90L3Ri9C5INGB0LXRgNCy0LjRgQogICAg
ICAgICAgICBpZiBpc192YWxpZDoKICAgICAgICAgICAgICAgIHNlbGYudmFsaWRhdGlvbl9zdGF0
dXNfZW50cnkuaW5zZXJ0KDAsICLQpNCY0J4g0LrQvtGA0YDQtdC60YLQvdC+IikKICAgICAgICAg
ICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYudmFsaWRhdGlvbl9zdGF0dXNfZW50cnkuaW5z
ZXJ0KDAsICLQpNCY0J4g0YHQvtC00LXRgNC20LjRgiDQt9Cw0L/RgNC10YnQtdC90L3Ri9C1INGB
0LjQvNCy0L7Qu9GLIikKICAgICAgICAKICAgICAgICBzZWxmLnZhbGlkYXRpb25fc3RhdHVzX2Vu
dHJ5LmNvbmZpZ3VyZShzdGF0ZT0icmVhZG9ubHkiKQogICAgICAgICMg0JjQvNC40YLQsNGG0LjR
jyAi0L7RgtC/0YDQsNCy0LrQuCIgLSDQv9GA0L7RgdGC0L4g0LLRi9Cy0L7QtNC40Lwg0YHQvtC+
0LHRidC10L3QuNC1CiAgICAgICAgcHJpbnQoZiLQnNC+0LTRg9C70YwgNDog0J/RgNC+0LLQtdGA
0LXQvdC+INCk0JjQniAne2Zpb190b192YWxpZGF0ZX0nLCDRgNC10LfRg9C70YzRgtCw0YI6ICd7
c2VsZi52YWxpZGF0aW9uX3N0YXR1c19lbnRyeS5nZXQoKX0nIikKCgpjbGFzcyBBcHBDb250cm9s
bGVyKGN0ay5DVGspOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHN1cGVyKCkuX19p
bml0X18oKQogICAgICAgIHNlbGYuY3VycmVudF91c2VyID0gTm9uZQogICAgICAgIHNlbGYuX2N1
cnJlbnRfZnJhbWUgPSBOb25lCiAgICAgICAgCiAgICAgICAgc2VsZi5zaG93X2xvZ2luX3dpbmRv
dygpCgogICAgZGVmIGNsZWFyX2ZyYW1lKHNlbGYpOgogICAgICAgIGlmIHNlbGYuX2N1cnJlbnRf
ZnJhbWU6CiAgICAgICAgICAgIHNlbGYuX2N1cnJlbnRfZnJhbWUuZGVzdHJveSgpCiAgICAgICAg
ICAgIHNlbGYuX2N1cnJlbnRfZnJhbWUgPSBOb25lCgogICAgZGVmIHNob3dfbG9naW5fd2luZG93
KHNlbGYpOgogICAgICAgIHNlbGYuY2xlYXJfZnJhbWUoKQogICAgICAgIHNlbGYuY3VycmVudF91
c2VyID0gTm9uZQogICAgICAgIHNlbGYuX2N1cnJlbnRfZnJhbWUgPSBMb2dpbldpbmRvdyhzZWxm
LCBzZWxmKQogICAgICAgIHNlbGYudGl0bGUoItCQ0LLRgtC+0YDQuNC30LDRhtC40Y8iKQoKICAg
IGRlZiBzaG93X2NoYW5nZV9wYXNzd29yZF93aW5kb3coc2VsZiwgaW5pdGlhbF9jaGFuZ2U9RmFs
c2UpOgogICAgICAgIGlmIHNlbGYuY3VycmVudF91c2VyOgogICAgICAgICAgICBDaGFuZ2VQYXNz
d29yZFdpbmRvdyhzZWxmLCBzZWxmLCBpbml0aWFsX2NoYW5nZT1pbml0aWFsX2NoYW5nZSkKICAg
ICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLnNob3dfbG9naW5fd2luZG93KCkgIyDQn9C10YDQ
tdC90LDQv9GA0LDQstC40YLRjCDQvdCwINC70L7Qs9C40L0sINC10YHQu9C4INC90LXRgiDQv9C+
0LvRjNC30L7QstCw0YLQtdC70Y8KCiAgICBkZWYgc2hvd19kYXNoYm9hcmRfZm9yX3JvbGUoc2Vs
Ziwgcm9sZSk6CiAgICAgICAgc2VsZi5jbGVhcl9mcmFtZSgpCiAgICAgICAgaWYgcm9sZSA9PSAn
0JDQtNC80LjQvdC40YHRgtGA0LDRgtC+0YAnOgogICAgICAgICAgICBzZWxmLl9jdXJyZW50X2Zy
YW1lID0gQWRtaW5EYXNoYm9hcmQoc2VsZiwgc2VsZikKICAgICAgICBlbHNlOiAjINCf0L7Qu9GM
0LfQvtCy0LDRgtC10LvRjAogICAgICAgICAgICBzZWxmLl9jdXJyZW50X2ZyYW1lID0gVXNlckRh
c2hib2FyZChzZWxmLCBzZWxmKQogICAgCiAgICBkZWYgbG9nb3V0KHNlbGYpOgogICAgICAgIHNl
bGYuY3VycmVudF91c2VyID0gTm9uZQogICAgICAgICMg0JfQsNC60YDRi9GC0Ywg0LLRgdC1INC0
0L7Rh9C10YDQvdC40LUg0L7QutC90LAgVG9wbGV2ZWwKICAgICAgICBmb3Igd2lkZ2V0IGluIHNl
bGYud2luZm9fY2hpbGRyZW4oKToKICAgICAgICAgICAgaWYgaXNpbnN0YW5jZSh3aWRnZXQsIGN0
ay5DVGtUb3BsZXZlbCk6CiAgICAgICAgICAgICAgICB3aWRnZXQuZGVzdHJveSgpCiAgICAgICAg
c2VsZi5zaG93X2xvZ2luX3dpbmRvdygpCgojIDYuIE1BSU4gRVhFQ1VUSU9OIEJMT0NLCmlmIF9f
bmFtZV9fID09ICJfX21haW5fXyI6CiAgICBjdGsuc2V0X2FwcGVhcmFuY2VfbW9kZSgiU3lzdGVt
IikgICMgTW9kZXM6ICJTeXN0ZW0iICjRgdGC0LDQvdC00LDRgNGCKSwgIkRhcmsiLCAiTGlnaHQi
CiAgICBjdGsuc2V0X2RlZmF1bHRfY29sb3JfdGhlbWUoImdyZWVuIikgIyBUaGVtZXM6ICJibHVl
IiAo0YHRgtCw0L3QtNCw0YDRgiksICJncmVlbiIsICJkYXJrLWJsdWUiCiAgICAKICAgIGFwcCA9
IEFwcENvbnRyb2xsZXIoKQogICAgYXBwLm1haW5sb29wKCkKCgojIFNFTEVDVAogICAgIyAoU0VM
RUNUIENPVU5UKCopIEZST00gcm9vbXMgV0hFUkUgY3VycmVudF9zdGF0dXNfaWQgPSAoU0VMRUNU
IGlkIEZST00gcm9vbV9zdGF0dXNlcyBXSEVSRSBuYW1lID0gJ9CX0LDQvdGP0YInKSkgKiAxMDAu
MCAvCiAgICAjIChTRUxFQ1QgQ09VTlQoKikgRlJPTSByb29tcykgQVMgcGVyY2VudGFnZV9vY2N1
cGFuY3k7"""