"use strict";(self.webpackChunk_swan_cern_sparkconnector=self.webpackChunk_swan_cern_sparkconnector||[]).push([[262],{132:(e,t,n)=>{n.r(t),n.d(t,{default:()=>se});var r=n(6029),l=n.n(r),a=n(8273),o=n(2914),c=n(2972),s=n(3457);const i=getComputedStyle(document.body).getPropertyValue("--jp-brand-color1").trim(),u=e=>(0,c.A)({shadows:Array(25).fill("none"),shape:{borderRadius:2},typography:{fontSize:12,fontFamily:["-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(",")},palette:{type:e||"light",primary:{main:i}}}),m=u("light"),d=u("dark"),p=(0,a.observer)((e=>{const t="light"===o.h.colorTheme?m:d;return l().createElement(s.Z,{theme:t},e.children)}));var E=n(282),k=n(7094),b=n(9803),v=n(724),h=n(7155);const C=(0,a.observer)((()=>{var e,t;let n="";return(null===(e=o.h.currentNotebook)||void 0===e?void 0:e.clusterName)&&(null===(t=o.h.currentNotebook)||void 0===t?void 0:t.sparkVersion)&&(n=l().createElement("div",{className:"jp-SparkConnector-connectionDetailsContainerInfo"},"Cluster ",l().createElement("b",null,o.h.currentNotebook.clusterName)," | Version"," ",l().createElement("b",null,o.h.currentNotebook.sparkVersion))),l().createElement("div",{className:"jp-SparkConnector-details"},l().createElement("div",null,l().createElement("div",{className:"jp-SparkConnector-connectionDetailsContainer"},l().createElement("div",{className:"jp-SparkConnector-logo"}),n)))})),g=(0,a.observer)((()=>{var e,t;let n="";return(null===(e=null===o.h||void 0===o.h?void 0:o.h.currentNotebook)||void 0===e?void 0:e.title)&&(n="| "+(null===(t=null===o.h||void 0===o.h?void 0:o.h.currentNotebook)||void 0===t?void 0:t.title)),l().createElement("div",{className:"jp-SparkConnector-panel"},l().createElement("span",{className:"jp-SparkConnector-panelLabel"},"Apache Spark ",n))})),N=e=>l().createElement("div",{className:"jp-SparkConnector"},l().createElement(g,null),l().createElement(C,null),e.children),Z=e=>l().createElement(l().Fragment,null,l().createElement("header",{className:"jp-SparkConnector-section-header"},e.title,e.extraActions),l().createElement("div",{className:"jp-SparkConnector-details "+e.className||0},e.children)),f=(0,a.observer)((()=>{const[e,t]=l().useState("");let n="";return o.h.currentNotebook.authError&&(n=l().createElement(v.Z,{severity:"error"},l().createElement(h.Z,null,"Error"),o.h.currentNotebook.authError)),l().createElement(N,null,l().createElement(Z,{title:"Authentication",className:"jp-SparkConnector-auth"},n,l().createElement(v.Z,{severity:"info"},"Before connecting to the cluster, we need to obtain a Kerberos ticket. Please enter your account password."),l().createElement(b.Z,{id:"standard-password-input",size:"small",variant:"outlined",label:"Password",type:"password",autoComplete:"current-password",value:e,fullWidth:!0,onChange:e=>{t(e.target.value)}})),l().createElement(E.Z,{color:"primary",variant:"contained",disabled:!e,onClick:()=>{o.h.onClickAuthenticate(e)},startIcon:l().createElement(k.Z,null),className:"jp-SparkConnector-button-main"},"Authenticate"))}));var S=n(6081),y=n(7989),j=n(8057),A=n(3957);const R=(0,a.observer)((()=>{const e=o.h.availableOptions||[],[t,n]=l().useState(null),[r,a]=l().useState(""),[c,s]=l().useState("");return l().createElement(Z,{title:"Add Extra Configuration"},l().createElement("ul",null,l().createElement("li",null,"You can configure the following"," ",l().createElement("a",{href:"https://spark.apache.org/docs/latest/configuration#available-properties",target:"_blank",rel:"noreferrer"},"options.")),l().createElement("li",null,"These options override options in the selected bundles."),l().createElement("li",null,"Environment variables can be used via ","{ENV_VAR_NAME}",".")),l().createElement("div",{className:"jp-SparkConnector-input-sparkopts"},l().createElement(y.ZP,{size:"small",freeSolo:!0,options:e,inputValue:r,onInputChange:(e,t)=>{a(t)},value:t,onChange:(e,t)=>{n(t)},disableClearable:!0,groupBy:e=>e.data.category,getOptionLabel:e=>"string"==typeof e?e:e.value,renderInput:e=>l().createElement(b.Z,{...e,label:"Configuration Name",variant:"outlined",size:"small"})}),l().createElement(b.Z,{label:"Value",size:"small",variant:"outlined",value:c,onChange:e=>{s(e.target.value)}}),l().createElement(j.Button,{startIcon:l().createElement(A.Z,null),disabled:!r||!c,variant:"contained",onClick:()=>{o.h.currentNotebook.addConfiguration(r,c),a(""),s("")}},"Add Configuration")))}));var w=n(2822),I=n(998),_=n(6869),B=n(5757),z=n(3144),V=n(3123);const x=(0,a.observer)((()=>{const e=o.h.currentNotebook.selectedBundles,t=o.h.currentNotebook.filteredAvailableBundles||[],n=Object.keys(t).map((t=>{const n=-1!==e.indexOf(t);return l().createElement(I.Z,{key:t,button:!0,selected:n,onClick:()=>{(t=>{-1===e.indexOf(t)?o.h.currentNotebook.addBundle(t):o.h.currentNotebook.removeBundle(t)})(t)}},l().createElement(_.Z,null,n?l().createElement(z.Z,null):l().createElement(V.Z,null)),l().createElement(B.Z,{id:t,primary:t}))}));return l().createElement(Z,{title:"Add Configuration Bundle"},l().createElement(w.Z,{dense:!0,disablePadding:!0},n))}));var U=n(6037),M=n(5025),P=n(4566),O=n(9969),D=n(8428),F=n(7812),L=n(1860),W=n(6837);const q=e=>l().createElement(I.Z,{dense:!0,key:e.config.id},l().createElement(_.Z,null,l().createElement(O.Z,null)),l().createElement(B.Z,{primary:e.config.name,secondary:e.config.value}),l().createElement(L.Z,null,l().createElement(F.Z,{edge:"end",size:"small",onClick:e.onClickRemove},l().createElement(D.Z,null)))),T=(0,a.observer)((e=>{var t,n;const[r,a]=l().useState(!0),c=null===(n=null===(t=o.h.currentNotebook.filteredAvailableBundles[e.bundleName])||void 0===t?void 0:t.options)||void 0===n?void 0:n.map(((e,t)=>l().createElement(I.Z,{dense:!0,key:t},l().createElement(_.Z,null,l().createElement(O.Z,null)),l().createElement(B.Z,{primary:e.name,secondary:e.value}))));return l().createElement(l().Fragment,null,l().createElement(I.Z,{dense:!0,button:!0,divider:!0,onClick:()=>{a(!r)},key:e.bundleName},l().createElement(_.Z,null,l().createElement(F.Z,{"aria-label":"delete",size:"small",onClick:()=>{o.h.currentNotebook.removeBundle(e.bundleName)}},l().createElement(D.Z,null))),l().createElement(B.Z,{primary:l().createElement("b",null,e.bundleName)}),r?l().createElement(M.Z,null):l().createElement(P.Z,null)),l().createElement(U.Z,{in:r,timeout:"auto"},l().createElement(w.Z,{component:"div",disablePadding:!0,dense:!0},c)))})),H=(0,a.observer)((()=>{const e=o.h.currentNotebook.selectedBundles.map((e=>l().createElement(T,{bundleName:e,key:e}))),t=o.h.currentNotebook.selectedConfigurations.map((e=>l().createElement(q,{config:e,onClickRemove:()=>{o.h.currentNotebook.removeConfiguration(e.id)},key:e.id})));return l().createElement(Z,{title:"Selected Configuration",className:"jp-SparkConnector-selected-config"},l().createElement(w.Z,{dense:!0,disablePadding:!0},e,t.length>0&&l().createElement(W.Z,null,"Extra Configuration"),t))})),K=()=>l().createElement(N,null,l().createElement("div",{className:"jp-SparkConnector-scrollable"},l().createElement(x,null),l().createElement(R,null),l().createElement(H,null)),l().createElement(E.Z,{color:"primary",variant:"contained",onClick:()=>{o.h.onClickConnect()},startIcon:l().createElement(S.Z,null),className:"jp-SparkConnector-button-main"},"Connect"));var Y=n(1939),G=n(1120),J=n(460),Q=n(6210);const X=(0,a.observer)((()=>{const e=l().useRef(null);return l().useEffect((()=>{var t;null===(t=e.current)||void 0===t||t.scrollIntoView({behavior:"smooth"})}),[o.h.currentNotebook.logs]),l().createElement("div",{className:"jp-SparkConnector-confDetailsContainer-sparkLogs info"},o.h.currentNotebook.logs.map(((e,t)=>l().createElement("pre",{key:t},e))),l().createElement("div",{ref:e}))})),$=(0,a.observer)((()=>r.createElement(v.Z,{severity:"success",style:{margin:"8px"}},r.createElement(h.Z,null,"Connected to ",r.createElement("b",null,o.h.currentNotebook.clusterName)),"Variables available in the notebook",r.createElement("li",null,"sc:"," ",r.createElement("a",{href:"https://spark.apache.org/docs/latest/api/python/reference/api/pyspark.SparkContext.html",target:"_blank",rel:"noreferrer"},r.createElement("u",null,r.createElement("b",null,"SparkContext")))),r.createElement("li",null,"spark:"," ",r.createElement("a",{href:"https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.SparkSession.html",target:"_blank",rel:"noreferrer"},r.createElement("u",null,r.createElement("b",null,"SparkSession"))))))),ee=(0,a.observer)((()=>{var e,t,n,l,a;return r.createElement(N,null,r.createElement($,null),r.createElement(Z,{title:"connection resources"},r.createElement(w.Z,{dense:!0},r.createElement(I.Z,{button:!0,component:"a",target:"_blank",href:null===(t=null===(e=o.h.currentNotebook)||void 0===e?void 0:e.connectionResources)||void 0===t?void 0:t.sparkWebuiUrl},r.createElement(_.Z,null,r.createElement(G.Z,null)),r.createElement(B.Z,{primary:"Spark Web UI"})),r.createElement(I.Z,{button:!0,component:"a",target:"_blank",href:null===(n=o.h.currentNotebook.connectionResources)||void 0===n?void 0:n.sparkMetricsUrl,disabled:!(null===(l=o.h.currentNotebook.connectionResources)||void 0===l?void 0:l.sparkMetricsUrl)},r.createElement(_.Z,null,r.createElement(Y.Z,null)),r.createElement(B.Z,{primary:"Spark Metrics Dashboard"+((null===(a=o.h.currentNotebook.connectionResources)||void 0===a?void 0:a.sparkMetricsUrl)?"":"(bundle not added)")})))),r.createElement(Z,{title:"logs",className:"jp-SparkConnector-logs",extraActions:r.createElement(F.Z,{size:"small",className:"jp-SparkConnector-logrefresh",onClick:()=>{o.h.onRefreshLogs()}},r.createElement(Q.Z,null))},r.createElement(X,null)),r.createElement(E.Z,{color:"secondary",variant:"contained",onClick:()=>{o.h.onClickRestart()},startIcon:r.createElement(J.Z,null),className:"jp-SparkConnector-button-main"},"Disconnect"))}));var te=n(428);const ne=(0,a.observer)((()=>r.createElement(N,null,r.createElement(Z,{title:"connection failed",className:"jp-SparkConnector-error"},r.createElement(v.Z,{severity:"error"},r.createElement(h.Z,null,"Error"),o.h.currentNotebook.errorMessage)),r.createElement(Z,{title:"logs",className:"jp-SparkConnector-logs"},r.createElement(X,null)),r.createElement(E.Z,{color:"secondary",variant:"contained",onClick:()=>{o.h.onClickRestart()},startIcon:r.createElement(te.Z,null),className:"jp-SparkConnector-button-main"},"Restart"))));var re=n(7298),le=n(5477);const ae=(0,a.observer)((()=>l().createElement(N,null,l().createElement(Z,{title:"spark connecting",className:"jp-SparkConnector-loading"},l().createElement(le.Z,{size:80})),l().createElement(Z,{title:"logs",className:"jp-SparkConnector-logs"},l().createElement(X,null)),l().createElement(E.Z,{color:"secondary",variant:"contained",onClick:()=>{o.h.onClickRestart()},startIcon:l().createElement(re.Z,null),className:"jp-SparkConnector-button-main"},"Cancel")))),oe=()=>l().createElement(N,null,l().createElement("div",{className:"jp-SparkConnector-loading"},l().createElement(le.Z,{size:80}))),ce=()=>l().createElement(N,null,l().createElement("div",{className:"jp-SparkConnector-notattached"},"Open a notebook to connect to Apache Spark")),se=(0,a.observer)((()=>{let e=l().createElement("div",null);if(!o.h.currentNotebook)return l().createElement(ce,null);switch(o.h.currentNotebook.status){case"configuring":e=l().createElement(K,null);break;case"auth":e=l().createElement(f,null);break;case"connected":e=l().createElement(ee,null);break;case"connecting":e=l().createElement(ae,null);break;case"loading":case"notattached":e=l().createElement(oe,null);break;case"error":e=l().createElement(ne,null)}return l().createElement(p,null,e)}))}}]);