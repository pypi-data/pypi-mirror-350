/*! For license information please see auth.38d6f28c232f2507e43f.js.LICENSE.txt */
try{let t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},e=(new t.Error).stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="bcef7ec7-6b3a-4b67-a569-7b58cca4064c",t._sentryDebugIdIdentifier="sentry-dbid-bcef7ec7-6b3a-4b67-a569-7b58cca4064c")}catch(t){}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{}).SENTRY_RELEASE={id:"0.12.0"};!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.swh=e():(t.swh=t.swh||{},t.swh.auth=e())}(self,(function(){return function(){var t={4633:function(t,e,n){var r=n(73738).default;function o(){"use strict";t.exports=o=function(){return n},t.exports.__esModule=!0,t.exports.default=t.exports;var e,n={},i=Object.prototype,a=i.hasOwnProperty,u="function"==typeof Symbol?Symbol:{},s=u.iterator||"@@iterator",c=u.asyncIterator||"@@asyncIterator",f=u.toStringTag||"@@toStringTag";function l(t,e,n,r){return Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{l({},"")}catch(e){l=function(t,e,n){return t[e]=n}}function h(t,n,r,o){var i=n&&n.prototype instanceof v?n:v,a=Object.create(i.prototype);return l(a,"_invoke",function(t,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var u=r.delegate;if(u){var s=T(u,r);if(s){if(s===d)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var c=p(t,n,r);if("normal"===c.type){if(o=r.done?4:2,c.arg===d)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(o=4,r.method="throw",r.arg=c.arg)}}}(t,r,new O(o||[])),!0),a}function p(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}n.wrap=h;var d={};function v(){}function b(){}function y(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,w=m&&m(m(S([])));w&&w!==i&&a.call(w,s)&&(g=w);var k=y.prototype=v.prototype=Object.create(g);function x(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){function n(o,i,u,s){var c=p(t[o],t,i);if("throw"!==c.type){var f=c.arg,l=f.value;return l&&"object"==r(l)&&a.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,u,s)}),(function(t){n("throw",t,u,s)})):e.resolve(l).then((function(t){f.value=t,u(f)}),(function(t){return n("throw",t,u,s)}))}s(c.arg)}var o;l(this,"_invoke",(function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function T(t,n){var r=n.method,o=t.i[r];if(o===e)return n.delegate=null,"throw"===r&&t.i.return&&(n.method="return",n.arg=e,T(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=p(o,t.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,d;var a=i.arg;return a?a.done?(n[t.r]=a.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function E(t){this.tryEntries.push(t)}function j(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function O(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function S(t){if(null!=t){var n=t[s];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(a.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(r(t)+" is not iterable")}return b.prototype=y,l(k,"constructor",y),l(y,"constructor",b),b.displayName=l(y,f,"GeneratorFunction"),n.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,l(t,f,"GeneratorFunction")),t.prototype=Object.create(k),t},n.awrap=function(t){return{__await:t}},x(_.prototype),l(_.prototype,c,(function(){return this})),n.AsyncIterator=_,n.async=function(t,e,r,o,i){void 0===i&&(i=Promise);var a=new _(h(t,e,r,o),i);return n.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(k),l(k,f,"Generator"),l(k,s,(function(){return this})),l(k,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},n.values=S,O.prototype={constructor:O,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){a.type="throw",a.arg=t,n.next=e}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],u=this.prev,s=i[1],c=i[2];if(-1===i[0])return r("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=u){if(u<s)return this.method="next",this.arg=e,r(s),!0;if(u<c)return r(c),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),j(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var o=r.arg;j(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={i:S(t),r:n,n:r},"next"===this.method&&(this.arg=e),d}},n}t.exports=o,t.exports.__esModule=!0,t.exports.default=t.exports},8545:function(t,e,n){"use strict";n.d(e,{Iq:function(){return u},Jq:function(){return a},Tv:function(){return o},lY:function(){return i}});n(54756);var r=n(18987);function o(t){if(!t.ok)throw t;return t}function i(t){return"/static/"+t}function a(t,e,n){return void 0===e&&(e={}),void 0===n&&(n=null),e["X-CSRFToken"]=r.A.get("csrftoken"),fetch(t,{credentials:"include",headers:e,method:"POST",body:n})}function u(){history.replaceState("",document.title,window.location.pathname+window.location.search)}},10467:function(t,e,n){"use strict";function r(t,e,n,r,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,o)}function o(t){return function(){var e=this,n=arguments;return new Promise((function(o,i){var a=t.apply(e,n);function u(t){r(a,o,i,u,s,"next",t)}function s(t){r(a,o,i,u,s,"throw",t)}u(void 0)}))}}n.d(e,{A:function(){return o}})},18987:function(t,e,n){"use strict";function r(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}n.d(e,{A:function(){return o}});var o=function t(e,n){function o(t,o,i){if("undefined"!=typeof document){"number"==typeof(i=r({},n,i)).expires&&(i.expires=new Date(Date.now()+864e5*i.expires)),i.expires&&(i.expires=i.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var u in i)i[u]&&(a+="; "+u,!0!==i[u]&&(a+="="+i[u].split(";")[0]));return document.cookie=t+"="+e.write(o,t)+a}}return Object.create({set:o,get:function(t){if("undefined"!=typeof document&&(!arguments.length||t)){for(var n=document.cookie?document.cookie.split("; "):[],r={},o=0;o<n.length;o++){var i=n[o].split("="),a=i.slice(1).join("=");try{var u=decodeURIComponent(i[0]);if(r[u]=e.read(a,u),t===u)break}catch(t){}}return t?r[t]:r}},remove:function(t,e){o(t,"",r({},e,{expires:-1}))},withAttributes:function(e){return t(this.converter,r({},this.attributes,e))},withConverter:function(e){return t(r({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(e)}})}({read:function(t){return'"'===t[0]&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})},23717:function(t,e,n){"use strict";n.d(e,{_k:function(){return r}});var r={serverSide:!0,processing:!0,language:{processing:'<img src="'+(0,n(8545).lY)("img/swh-spinner.gif")+'"></img>'},fixedHeader:!0,lengthMenu:[10,25,50,100,1e3],scrollCollapse:!0,searchDelay:1e3}},54756:function(t,e,n){var r=n(4633)();t.exports=r;try{regeneratorRuntime=r}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},58168:function(t,e,n){"use strict";function r(){return r=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},r.apply(null,arguments)}n.d(e,{A:function(){return r}})},73738:function(t){function e(n){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r](i,i.exports,n),i.exports}n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};return function(){"use strict";n.r(r),n.d(r,{applyTokenAction:function(){return y},initProfilePage:function(){return g}});var t,e=n(58168),o=n(10467),i=n(54756),a=n.n(i),u=n(8545),s=n(23717);function c(t){return'<p id="swh-token-error-message" class="mt-3 swh-token-form-message">'+t+"</p>"}function f(){window.location=Urls.oidc_generate_bearer_token()}function l(t){return h.apply(this,arguments)}function h(){return(h=(0,o.A)(a().mark((function t(e){var n,r,o,i,s,f;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={token_id:e},t.prev=1,t.next=4,(0,u.Jq)(Urls.oidc_get_bearer_token(),{},JSON.stringify(n));case 4:return r=t.sent,(0,u.Tv)(r),t.next=8,r.text();case 8:o=t.sent,i='<p>Below is your token.</p>\n      <pre id="swh-bearer-token" class="mt-3">'+o+"</pre>",swh.webapp.showModalHtml("Display bearer token",i),t.next=21;break;case 13:return t.prev=13,t.t0=t.catch(1),t.next=17,t.t0.text();case 17:s=t.sent,f="Internal server error.",400===t.t0.status&&(f=s),swh.webapp.showModalHtml("Display bearer token",c(f));case 21:case"end":return t.stop()}}),t,null,[[1,13]])})))).apply(this,arguments)}function p(t){return d.apply(this,arguments)}function d(){return(d=(0,o.A)(a().mark((function e(n){var r,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={token_ids:n},e.prev=1,e.next=4,(0,u.Jq)(Urls.oidc_revoke_bearer_tokens(),{},JSON.stringify(r));case 4:o=e.sent,(0,u.Tv)(o),$("#swh-token-form-submit").prop("disabled",!0),$("#swh-token-form-message").html('<p id="swh-token-success-message" class="mt-3 swh-token-form-message">'+("Bearer token"+(n.length>1?"s":"")+" successfully revoked.")+"</p>"),t.draw(),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),$("#swh-token-form-message").html(c("Internal server error."));case 14:case"end":return e.stop()}}),e,null,[[1,11]])})))).apply(this,arguments)}function v(t){p([t])}function b(){for(var e=[],n=t.rows().data(),r=0;r<n.length;++r)e.push(n[r].id);p(e)}function y(t,e){var n,r,o={display:{submitCallback:l},generate:{modalTitle:"Bearer token generation",infoText:"Click on the button to generate the token. You will be redirected to Software Heritage Authentication Service and might be asked to enter your password again.",buttonText:"Generate token",submitCallback:f},revoke:{modalTitle:"Revoke bearer token",infoText:"Click on the button to revoke the token.",buttonText:"Revoke token",submitCallback:v},revokeAll:{modalTitle:"Revoke all bearer tokens",infoText:"Click on the button to revoke all tokens.",buttonText:"Revoke tokens",submitCallback:b}};if(o[t])if("display"!==t){var i=(n=o[t].infoText,r=o[t].buttonText,'<form id="swh-token-form" class="text-center">\n      <p id="swh-token-form-text">'+n+'</p>\n      <input id="swh-token-form-submit" type="submit" value="'+r+'">\n      <div id="swh-token-form-message"></div>\n    </form>');swh.webapp.showModalHtml(o[t].modalTitle,i),$("#swh-token-form").submit((function(n){n.preventDefault(),n.stopPropagation(),o[t].submitCallback(e)}))}else o[t].submitCallback(e)}function g(){$(document).ready((function(){t=$("#swh-bearer-tokens-table").on("error.dt",(function(t,e,n,r){$("#swh-origin-save-request-list-error").text("An error occurred while retrieving the tokens list"),console.log(r)})).DataTable((0,e.A)({},s._k,{ajax:Urls.oidc_list_bearer_tokens(),columns:[{data:"creation_date",name:"creation_date",render:function(t,e,n){return"display"===e?new Date(t).toLocaleString():t}},{render:function(t,e,n){return'<button class="btn btn-secondary btn-sm"\n                         onclick="swh.auth.applyTokenAction(\'display\', '+n.id+')">\n                  Display token\n                </button>\n                <button class="btn btn-secondary btn-sm"\n                        onclick="swh.auth.applyTokenAction(\'revoke\', '+n.id+')">\n                  Revoke token\n                </button>'}}],ordering:!1,searching:!1})),$("#swh-oidc-profile-tokens-tab").on("shown.bs.tab",(function(){t.draw(),window.location.hash="#tokens"})),$("#swh-oidc-profile-account-tab").on("shown.bs.tab",(function(){(0,u.Iq)()})),"#tokens"===window.location.hash&&$('.nav-tabs a[href="#swh-oidc-profile-tokens"]').tab("show")}))}}(),r}()}));
//# sourceMappingURL=auth.38d6f28c232f2507e43f.js.map