      SUBROUTINE SKBARB
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION AM(60),DCAP(60),CP(60)
      COMMON/GEOM1/XB(240),RB(240),RBP(240),C2,BETA
      COMMON/RX/XR(20,6),G(20),GCH,DM,N,N1(20),IX,I1
      COMMON/GEO3/VOVS,AL,YINT,F,RR,RREF,AREF,DLN
      COMMON/ICOU/VOLN,SOBS,RJA1,RJA2,ICOUNT,NGOL,NHBS
      COMMON/VOL/CAF,CNF,CMF,CMX,DIA,RN,AP,XP
      COMMON/BASE/CAB,CNB,CMB
      COMMON/BAND/CAP,CNP,CMP,HB
      COMMON/GEO2/NFL,NN,IPRINT,MAL,MAX,IPR
      DATA CP/0.131,.1332,0.1355,.139,.141,.151,.169,.209,.219,.221,
     * .22,.218,.211,.202,.192,.182,.173,.165,.157,.15,.143,
     * .137,.131,.125,.119,.114,.109,.104,.1,.095,.091,.087,.083,
     * .08,.078,.076,.073,.071,.069,.067,.065,.063,.062,.061,
     * .06,.059,.058,.057,.056,.055,.054,.053,.052,.051,.05,.049,
     * .048,.047,.046,.045/
      DATA AM/0.4,0.5,.6,.7,.8,.9,.95,1.0,1.05,1.1,1.15,1.2,1.3,1.4,1.5,
     *1.6,1.7,1.8,1.9,2.0,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3.0,3.1,3.
     *2,3.3,3.4,3.5,3.6,3.7,3.8,3.9,4.0,4.1,4.2,4.3,4.4,4.5,4.6,4.7,4.8,
     *4.9,5.0,5.1,5.2,5.3,5.4,5.5,5.6,5.7,5.8,5.9,6.0/
      DATA DCAP/0.,0.,0.,0.0003,0.001,0.005,
     *0.01,0.0101,0.0098,0.009,0.0084
     *,0.0079,0.0074,0.007,0.0067,0.0065,0.0064,0.0063,0.0062,0.006,0.00
     *59,0.0058,0.0057,0.0056,0.0055,0.0054,0.0053,0.0052,0.0051,0.005,0
     *.0049,0.0049,0.0048,0.0047,0.0047,0.0046,0.0046,0.0045,0.0045,
     *0.0044,0.0044,0.0044,0.0043,0.0043,0.0043,.0042,.0042,.0042,
     *.0041,.0041,.0041,.0041,.004,.004,.004,.004,
     *.0039,.0039,.0039,.0039/
      CALL INTERP(AM,DCAP,VOVS,CAP1,60,3)
      CAP=CAP1*HB/0.01D0
      CNP=0.D0
      CMP=0.D0
      CALL INTERP(AM,CP,VOVS,CP3,60,3)
      CP3=CP3*(RB(NN)/RREF)**3
      DCP=0.68755D0*DEXP(-0.32D0*VOVS)*AL*(RB(NN)/RREF)**3
      CDLN=1.D0
      CAB=CDLN*CP3+DCP
      CNB=0.D0
      CMB=0.D0
      C=0.4D0
      TWOTI=1.D0+0.45D0*C*VOVS**2
      A=DSQRT(C*VOVS**2/(2.D0*TWOTI))
      B=(1.D0+0.5D0*C*VOVS**2)/TWOTI-1.D0
      D=DSQRT(B**2+4.D0*A**2)
      C1=(2.D0*A**2-B)/D
      D2=B/D
      D3=0.242D0/(A*DSQRT(TWOTI))
      D4=DATAN(C1/DSQRT(1.D0-C1**2))
      C5=DATAN(D2/DSQRT(1.D0-D2**2))
      C6=1.26D0*DLOG10(TWOTI)
      C7=D3*(D4+C5)
      R3=RN*DLN*DIA
      CF=0.0025D0
      J=0
  1   S=C7/DSQRT(CF)-DLOG10(R3*CF)+C6
      DFDCF=-0.5D0*C7/(CF**1.5D0)-.43429D0/CF
      J=J+1
      CF1=CF
      CF=CF-S/DFDCF
      IF(CF.LE.0.0001D0)CF=0.0001D0
      DCF=CF-CF1
      IF(DABS(DCF)-0.00001D0)2,2,4
  4   IF(J-50)1,1,2
    2 RKR=1.0D+6
      XKR=RKR/(RN*DIA)
      SKR=SOBS*XKR/DLN
      IF(SKR.GT.SOBS) SKR=SOBS
      CDFB=(CF*(SOBS-SKR)+1.328D0*SKR/DSQRT(RKR))/AREF
      CAF=CDFB
      CMF=0.D0
      CDFB=CDFB*(1.+.1/(1.+VOVS**3))
      CAF=CDFB
      CNF=0.D0
      CMX=-.34D0*CDFB
      RETURN
      END
