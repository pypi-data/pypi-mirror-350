"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[734],{9307:function(e,t,r){r.d(t,{Cl:function(){return c},OE:function(){return u}});var a=r(5893);r(7294);var s=r(8799),o=r(6989),n=r(3850);let c=e=>{switch(e){case"LAUNCHING":return"bg-blue-100 text-sky-blue";case"RUNNING":return"bg-green-50 text-green-700";case"STOPPED":return"bg-yellow-100 text-yellow-800";case"TERMINATED":default:return"bg-gray-100 text-gray-800";case"PENDING":case"CANCELLED":case"CANCELLING":return"bg-yellow-50 text-yellow-700";case"SUCCEEDED":return"bg-blue-50 text-blue-700";case"FAILED":case"FAILED_PRECHECKS":case"FAILED_NO_RESOURCE":case"FAILED_CONTROLLER":return"bg-red-50 text-red-700";case"RECOVERING":return"bg-orange-50 text-orange-700";case"SUBMITTED":return"bg-indigo-50 text-indigo-700";case"STARTING":return"bg-cyan-50 text-cyan-700";case"FAILED_SETUP":return"bg-pink-50 text-pink-700"}},l=e=>{switch(e){case"LAUNCHING":case"STARTING":return(0,a.jsx)(s.Z,{size:12,className:"w-3 h-3 mr-1"});case"RUNNING":default:return(0,a.jsx)(n.W2,{className:"w-3 h-3 mr-1"});case"STOPPED":return(0,a.jsx)(n.fp,{className:"w-3 h-3 mr-1"});case"TERMINATED":case"FAILED":case"CANCELLED":return(0,a.jsx)(n.Ps,{className:"w-3 h-3 mr-1"});case"SUCCEEDED":return(0,a.jsx)(n.Ye,{className:"w-3 h-3 mr-1"});case"PENDING":case"RECOVERING":case"SUBMITTED":case"CANCELLING":case"FAILED_SETUP":case"FAILED_PRECHECKS":case"FAILED_NO_RESOURCE":case"FAILED_CONTROLLER":return(0,a.jsx)(n.J$,{className:"w-3 h-3 mr-1"})}},i=e=>{let t=c(e),r=l(e);return(0,a.jsxs)("span",{className:"".concat("inline-flex items-center px-2 py-1 rounded-full text-sm"," ").concat(t),children:[r,e]})},u=e=>{let{status:t}=e;return(0,a.jsx)(o.WH,{content:t,className:"text-muted-foreground text-sm",children:(0,a.jsx)("span",{children:i(t)})})}},9284:function(e,t,r){r.d(t,{Oh:function(){return f},_R:function(){return p},cV:function(){return m}});var a=r(5893),s=r(7294),o=r(326),n=r(803),c=r(7673),l=r(8671),i=r(6989),u=r(3225),d=r(3001);function f(e){let{isOpen:t,onClose:r,cluster:u}=e,[d,f]=s.useState(!1),p=e=>{navigator.clipboard.writeText(e),f(!0),setTimeout(()=>f(!1),2e3)},m=["sky status ".concat(u),"ssh ".concat(u)],h=m.join("\n");return(0,a.jsx)(o.Vq,{open:t,onOpenChange:r,children:(0,a.jsxs)(o.cZ,{className:"sm:max-w-md",children:[(0,a.jsxs)(o.fK,{children:[(0,a.jsxs)(o.$N,{children:["Connect to: ",(0,a.jsx)("span",{className:"font-light",children:u})]}),(0,a.jsx)(o.Be,{children:"Use these instructions to connect to your cluster via SSH."})]}),(0,a.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium mb-2",children:"SSH Command"}),(0,a.jsx)(c.Zb,{className:"p-3 bg-gray-50",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("pre",{className:"text-sm w-full whitespace-pre-wrap",children:m.map((e,t)=>(0,a.jsx)("code",{className:"block",children:e},t))}),(0,a.jsx)(i.WH,{content:d?"Copied!":"Copy command",children:(0,a.jsx)(n.z,{variant:"ghost",size:"icon",onClick:()=>p(h),className:"h-8 w-8 rounded-full",children:(0,a.jsx)(l.Z,{className:"h-4 w-4"})})})]})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Additional Information"}),(0,a.jsxs)("p",{className:"text-sm text-secondary-foreground",children:["Make sure to run"," ",(0,a.jsxs)("code",{className:"text-sm",children:["sky status ",u]})," first to have SkyPilot set up the SSH access."]})]})]})]})})}function p(e){let{isOpen:t,onClose:r,cluster:s}=e,f=(0,d.X)();return(0,a.jsx)(o.Vq,{open:t,onOpenChange:r,children:(0,a.jsx)(o.cZ,{className:"sm:max-w-3xl",children:(0,a.jsxs)(o.fK,{children:[(0,a.jsxs)(o.$N,{children:["Connect to: ",(0,a.jsx)("span",{className:"font-light",children:s})]}),(0,a.jsx)(o.Be,{children:(0,a.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium mb-2 my-2",children:"Setup SSH access"}),(0,a.jsx)(c.Zb,{className:"p-3 bg-gray-50",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("pre",{className:"text-sm",children:(0,a.jsxs)("code",{children:["sky status ",s]})}),(0,a.jsx)(i.WH,{content:"Copy command",children:(0,a.jsx)(n.z,{variant:"ghost",size:"icon",onClick:()=>navigator.clipboard.writeText("sky status ".concat(s)),className:"h-8 w-8 rounded-full",children:(0,a.jsx)(l.Z,{className:"h-4 w-4"})})})]})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium mb-2 my-2",children:"Connect with VSCode/Cursor"}),(0,a.jsx)(c.Zb,{className:"p-3 bg-gray-50",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("pre",{className:"text-sm",children:(0,a.jsxs)("code",{children:["code --remote ssh-remote+",s]})}),(0,a.jsx)(i.WH,{content:"Copy command",children:(0,a.jsx)(n.z,{variant:"ghost",size:"icon",onClick:()=>navigator.clipboard.writeText("code --remote ssh-remote+".concat(s)),className:"h-8 w-8 rounded-full",children:(0,a.jsx)(l.Z,{className:"h-4 w-4"})})})]})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium",children:"Or use the GUI to connect"}),(0,a.jsx)("div",{className:"relative ".concat(f?"-mt-5":"-mt-10"),style:{paddingBottom:"70%"},children:(0,a.jsxs)("video",{className:"absolute top-0 left-0 w-full h-full rounded-lg",controls:!0,autoPlay:!0,muted:!0,preload:"metadata",children:[(0,a.jsx)("source",{src:"".concat(u.GW,"/videos/cursor-small.mp4"),type:"video/mp4"}),"Your browser does not support the video tag."]})})]})]})})]})})})}function m(e){let{isOpen:t,onClose:r,onConfirm:s,title:c,message:l,confirmText:i="Confirm",confirmVariant:u="destructive"}=e;return(0,a.jsx)(o.Vq,{open:t,onOpenChange:r,children:(0,a.jsxs)(o.cZ,{className:"sm:max-w-md",children:[(0,a.jsxs)(o.fK,{children:[(0,a.jsx)(o.$N,{children:c}),(0,a.jsx)(o.Be,{children:l})]}),(0,a.jsxs)(o.cN,{className:"flex justify-end gap-2 pt-4",children:[(0,a.jsx)(n.z,{variant:"outline",onClick:r,children:"Cancel"}),(0,a.jsx)(n.z,{variant:u,onClick:()=>{s(),r()},children:i})]})]})})}},803:function(e,t,r){r.d(t,{z:function(){return i}});var a=r(5893),s=r(7294),o=r(8426),n=r(2003),c=r(2350);let l=(0,n.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),i=s.forwardRef((e,t)=>{let{className:r,variant:s,size:n,asChild:i=!1,...u}=e,d=i?o.g7:"button";return(0,a.jsx)(d,{className:(0,c.cn)(l({variant:s,size:n,className:r})),ref:t,...u})});i.displayName="Button"},7673:function(e,t,r){r.d(t,{Ol:function(){return i},Zb:function(){return l},aY:function(){return f},eW:function(){return p},ll:function(){return u}});var a=r(5893),s=r(7294),o=r(5697),n=r.n(o),c=r(2350);let l=s.forwardRef((e,t)=>{let{className:r,children:s,...o}=e;return(0,a.jsx)("div",{ref:t,className:(0,c.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...o,children:s})});l.displayName="Card",l.propTypes={className:n().string,children:n().node};let i=s.forwardRef((e,t)=>{let{className:r,children:s,...o}=e;return(0,a.jsx)("div",{ref:t,className:(0,c.cn)("flex flex-col space-y-1.5 p-6",r),...o,children:s})});i.displayName="CardHeader",i.propTypes={className:n().string,children:n().node};let u=s.forwardRef((e,t)=>{let{className:r,children:s,...o}=e;return(0,a.jsx)("h3",{ref:t,className:(0,c.cn)("text-2xl font-semibold leading-none tracking-tight",r),...o,children:s})});u.displayName="CardTitle",u.propTypes={className:n().string,children:n().node};let d=s.forwardRef((e,t)=>{let{className:r,children:s,...o}=e;return(0,a.jsx)("p",{ref:t,className:(0,c.cn)("text-sm text-muted-foreground",r),...o,children:s})});d.displayName="CardDescription",d.propTypes={className:n().string,children:n().node};let f=s.forwardRef((e,t)=>{let{className:r,children:s,...o}=e;return(0,a.jsx)("div",{ref:t,className:(0,c.cn)("p-6 pt-0",r),...o,children:s})});f.displayName="CardContent",f.propTypes={className:n().string,children:n().node};let p=s.forwardRef((e,t)=>{let{className:r,children:s,...o}=e;return(0,a.jsx)("div",{ref:t,className:(0,c.cn)("flex items-center p-6 pt-0",r),...o,children:s})});p.displayName="CardFooter",p.propTypes={className:n().string,children:n().node}},326:function(e,t,r){r.d(t,{$N:function(){return m},Be:function(){return h},Vq:function(){return l},cN:function(){return p},cZ:function(){return d},fK:function(){return f}});var a=r(5893),s=r(7294),o=r(6327),n=r(2350),c=r(3767);let l=o.fC;o.xz;let i=o.h_;o.x8;let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(o.aV,{ref:t,className:(0,n.cn)("fixed inset-0 z-50 bg-black/50 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...s})});u.displayName=o.aV.displayName;let d=s.forwardRef((e,t)=>{let{className:r,children:s,...l}=e;return(0,a.jsxs)(i,{children:[(0,a.jsx)(u,{}),(0,a.jsxs)(o.VY,{ref:t,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-gray-200 bg-white p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...l,children:[s,(0,a.jsxs)(o.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-white transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-gray-100 data-[state=open]:text-gray-500",children:[(0,a.jsx)(c.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});d.displayName=o.VY.displayName;let f=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...r})};f.displayName="DialogHeader";let p=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...r})};p.displayName="DialogFooter";let m=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(o.Dx,{ref:t,className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight",r),...s})});m.displayName=o.Dx.displayName;let h=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(o.dk,{ref:t,className:(0,n.cn)("text-sm text-gray-500",r),...s})});h.displayName=o.dk.displayName},8764:function(e,t,r){r.d(t,{RM:function(){return l},SC:function(){return i},iA:function(){return n},pj:function(){return d},ss:function(){return u},xD:function(){return c}});var a=r(5893),s=r(7294),o=r(2350);let n=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,o.cn)("w-full caption-bottom text-base",r),...s})})});n.displayName="Table";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("thead",{ref:t,className:(0,o.cn)("[&_tr]:border-b",r),...s})});c.displayName="TableHeader";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("tbody",{ref:t,className:(0,o.cn)("[&_tr:last-child]:border-0",r),...s})});l.displayName="TableBody",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("tfoot",{ref:t,className:(0,o.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...s})}).displayName="TableFooter";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("tr",{ref:t,className:(0,o.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...s})});i.displayName="TableRow";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("th",{ref:t,className:(0,o.cn)("h-12 px-4 text-left align-middle font-medium text-[hsl(var(--text-strong))] [&:has([role=checkbox])]:pr-0",r),...s})});u.displayName="TableHead";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("td",{ref:t,className:(0,o.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...s})});d.displayName="TableCell",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("caption",{ref:t,className:(0,o.cn)("mt-4 text-base text-muted-foreground",r),...s})}).displayName="TableCaption"},3266:function(e,t,r){r.d(t,{QL:function(){return u},Sl:function(){return l},zd:function(){return c}});var a=r(7294),s=r(5821),o=r(3225);let n={UP:"RUNNING",STOPPED:"STOPPED",INIT:"LAUNCHING",null:"TERMINATED"};async function c(){let{clusterNames:e=null}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let t=await fetch("".concat(o.f4,"/status"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cluster_names:e,all_users:!0})}),r=t.headers.get("X-Skypilot-Request-ID")||t.headers.get("X-Request-ID"),a=await fetch("".concat(o.f4,"/api/get?request_id=").concat(r)),s=await a.json();return(s.return_value?JSON.parse(s.return_value):[]).map(e=>{let t="",r=t=e.zone?e.zone:e.region;return t&&t.length>25&&(t=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;if(!e||e.length<=t)return e;if(t<=3)return"...";let r=Math.floor((t-3)/2),a=r+(t-3)%2;return 0===r?e.substring(0,a)+"...":e.substring(0,a)+"..."+e.substring(e.length-r)}(t,25)),{status:n[e.status],cluster:e.name,user:e.user_name,user_hash:e.user_hash,cloud:e.cloud,infra:t?e.cloud+" ("+t+")":e.cloud,full_infra:r?"".concat(e.cloud," (").concat(r,")"):e.cloud,cpus:e.cpus,mem:e.memory,gpus:e.accelerators,resources_str:e.resources_str,resources_str_full:e.resources_str_full,time:new Date(1e3*e.launched_at),num_nodes:e.nodes,workspace:e.workspace,jobs:[],events:[{time:new Date(1e3*e.launched_at),event:"Cluster created."}]}})}catch(e){return console.error("Error fetching clusters:",e),[]}}async function l(e){let{clusterName:t,jobId:r,onNewLog:a,workspace:n}=e;try{let e=(await fetch("".concat(o.f4,"/logs"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({follow:!1,cluster_name:t,job_id:r,override_skypilot_config:{active_workspace:n||"default"}})})).body.getReader();for(;;){let{done:t,value:r}=await e.read();if(t)break;let s=new TextDecoder().decode(r);a(s)}}catch(e){console.error("Error in streamClusterJobLogs:",e),(0,s.C)("Error in streamClusterJobLogs: ".concat(e.message),"error")}}async function i(e){let{clusterName:t,workspace:r}=e;try{let e=await fetch("".concat(o.f4,"/queue"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cluster_name:t,all_users:!0,override_skypilot_config:{active_workspace:r}})}),a=e.headers.get("X-Skypilot-Request-ID")||e.headers.get("X-Request-ID"),s=await fetch("".concat(o.f4,"/api/get?request_id=").concat(a)),n=await s.json();return JSON.parse(n.return_value).map(e=>{let r=e.end_at?e.end_at:Date.now()/1e3,a=0,s=0;return e.submitted_at&&(a=r-e.submitted_at),e.start_at&&(s=r-e.start_at),{id:e.job_id,status:e.status,job:e.job_name,user:e.username,gpus:e.accelerators||{},submitted_at:e.submitted_at?new Date(1e3*e.submitted_at):null,resources:e.resources,cluster:t,total_duration:a,job_duration:s,infra:"",logs:""}})}catch(e){return console.error("Error fetching cluster jobs:",e),[]}}function u(e){let{cluster:t,job:r=null}=e,[s,o]=(0,a.useState)(null),[n,l]=(0,a.useState)(null),[u,d]=(0,a.useState)(!0),[f,p]=(0,a.useState)(!0),m=(0,a.useCallback)(async()=>{if(t)try{d(!0);let e=await c({clusterNames:[t]});return o(e[0]),e[0]}catch(e){console.error("Error fetching cluster data:",e)}finally{d(!1)}return null},[t]),h=(0,a.useCallback)(async e=>{if(t)try{p(!0);let r=await i({clusterName:t,workspace:e||"default"});l(r)}catch(e){console.error("Error fetching cluster job data:",e)}finally{p(!1)}},[t]),g=(0,a.useCallback)(async()=>{let e=await m();e&&await h(e.workspace)},[m,h]);return(0,a.useEffect)(()=>{(async()=>{let e=await m();e&&await h(e.workspace)})()},[t,r,m,h]),{clusterData:s,clusterJobData:n,loading:u||f,refreshData:g}}},7324:function(e,t,r){r.d(t,{MB:function(){return l},eA:function(){return c},fX:function(){return s},yz:function(){return o},zl:function(){return i}});var a=r(3225);async function s(){try{let e=await fetch("".concat(a.f4,"/workspaces"));if(!e.ok)throw Error("Error scheduling getWorkspaces: ".concat(e.statusText," (status ").concat(e.status,")"));let t=e.headers.get("X-Skypilot-Request-ID");if(!t){console.warn("X-Skypilot-Request-ID header not found in /workspaces response. Attempting to find request_id in response body as a fallback.");try{let r=await e.json();if(r&&r.request_id)t=r.request_id,console.log("Found request_id in /workspaces response body (fallback):",t);else throw Error("X-Skypilot-Request-ID header not found AND request_id not found in parsed response body from /workspaces.")}catch(t){let e=t.message||"Error processing fallback for request_id from /workspaces response body.";throw console.error("Error in /workspaces request_id fallback logic:",e),Error("X-Skypilot-Request-ID header not found, and fallback to read request_id from body failed: ".concat(e))}}if(!t)throw Error("Failed to obtain X-Skypilot-Request-ID from /workspaces response (checked header and attempted body fallback, but ID is still missing).");console.log("Fetching workspace data with request_id: ".concat(t));let r=await fetch("".concat(a.f4,"/api/get?request_id=").concat(t));if(!r.ok){let e="Error fetching workspace data for request ID ".concat(t,": ").concat(r.statusText," (status ").concat(r.status,")");try{let a=await r.json();if(a&&a.detail){let r=a.detail;try{let e=JSON.parse(r);e&&e.error?r=e.error:e&&e.result&&e.result.error&&(r=e.result.error)}catch(e){}e="Error fetching workspace data for request ID ".concat(t,": ").concat(r)}}catch(e){}throw Error(e)}let s=await r.json();if(console.log("[Connector Debug] Full resultData from /api/get:",s),"FAILED"===s.status){let e="Unknown error during task execution";if(s.error)"string"==typeof s.error?e=s.error:"object"==typeof s.error&&(e=s.error.message||s.error.detail||JSON.stringify(s.error));else if(s.result&&s.result.error)"string"==typeof s.result.error?e=s.result.error:"object"==typeof s.result.error&&(e=s.result.error.message||s.result.error.detail||JSON.stringify(s.result.error));else if(s.return_value)try{let t=JSON.parse(s.return_value);t.error&&(e="string"==typeof t.error?t.error:t.error.message||t.error.detail||JSON.stringify(t.error))}catch(t){(s.return_value.includes("Error")||s.return_value.includes("Cannot"))&&(e=s.return_value)}throw Error(e)}let o={};if("SUCCEEDED"===s.status&&s.return_value)try{o=JSON.parse(s.return_value),console.log("Successfully parsed workspace data from return_value:",o)}catch(e){throw console.error("Failed to parse workspace data from return_value:",e,"Raw return_value:",s.return_value),Error("Failed to parse workspace data for request ID ".concat(t,": ").concat(e.message))}else s.result&&(console.warn("Using resultData.result as fallback for status ".concat(s.status)),o=s.result);return console.log("Effectively fetched workspace data (to be returned):",o),o||{}}catch(e){throw console.error("Failed to fetch workspaces (in getWorkspaces function):",e.message,e.stack),e}}async function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{let t="".concat(a.f4,"/enabled_clouds");e&&(t+="?workspace=".concat(encodeURIComponent(e)));let r=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json"}});if(!r.ok)throw Error("Error scheduling getEnabledClouds: ".concat(r.statusText," (status ").concat(r.status,")"));let s=r.headers.get("X-Skypilot-Request-ID");if(!s){console.warn("X-Skypilot-Request-ID header not found in /enabled_clouds response. Attempting to find request_id in response body as a fallback.");try{let e=await r.json();if(e&&e.request_id)s=e.request_id,console.log("Found request_id in /enabled_clouds response body (fallback):",s);else throw Error("X-Skypilot-Request-ID header not found AND request_id not found in parsed response body from /enabled_clouds.")}catch(t){let e=t.message||"Error processing fallback for request_id from /enabled_clouds response body.";throw console.error("Error in /enabled_clouds request_id fallback logic:",e),Error("X-Skypilot-Request-ID header not found, and fallback to read request_id from body failed: ".concat(e))}}if(!s)throw Error("Failed to obtain X-Skypilot-Request-ID from /enabled_clouds response (checked header and attempted body fallback, but ID is still missing).");console.log("Fetching enabled_clouds data with request_id: ".concat(s));let o=await fetch("".concat(a.f4,"/api/get?request_id=").concat(s));if(!o.ok){let e="Error fetching enabled_clouds data for request ID ".concat(s,": ").concat(o.statusText," (status ").concat(o.status,")");try{let t=await o.json();if(t&&t.detail){let r=t.detail;try{let e=JSON.parse(r);e&&e.error?r=e.error:e&&e.result&&e.result.error&&(r=e.result.error)}catch(e){}e="Error fetching enabled_clouds data for request ID ".concat(s,": ").concat(r)}}catch(e){}throw Error(e)}let n=await o.json();if(console.log("[Connector Debug] Full resultData from /api/get for enabled_clouds:",n),"FAILED"===n.status){let e=n.error||n.result&&n.result.error||"Unknown error during task execution for enabled_clouds";throw Error("Fetching enabled_clouds data failed for request ID ".concat(s,": ").concat(e))}let c=[];if("SUCCEEDED"===n.status&&n.return_value)try{c=JSON.parse(n.return_value),console.log("Successfully parsed enabled_clouds data from return_value:",c)}catch(e){throw console.error("Failed to parse enabled_clouds data from return_value:",e,"Raw return_value:",n.return_value),Error("Failed to parse enabled_clouds data for request ID ".concat(s,": ").concat(e.message))}else n.result&&(console.warn("Using resultData.result as fallback for enabled_clouds status ".concat(n.status)),c=n.result);return Array.isArray(c)?c:[]}catch(e){throw console.error("Failed to fetch enabled_clouds (in getEnabledClouds function):",e.message,e.stack),e}}async function n(e,t){console.log("Polling for ".concat(t," task completion with request_id: ").concat(e));let r=await fetch("".concat(a.f4,"/api/get?request_id=").concat(e));if(!r.ok){let a="Error fetching ".concat(t," data for request ID ").concat(e,": ").concat(r.statusText," (status ").concat(r.status,")");try{let e=await r.json();if(console.error("[Error Debug] ".concat(t," HTTP error response:"),JSON.stringify(e,null,2)),e&&e.detail){if("object"==typeof e.detail&&e.detail.error)try{let r=JSON.parse(e.detail.error);if(r&&r.message)a="".concat(t," failed: ").concat(r.message);else if(r&&"object"==typeof r){let e=r.type||JSON.stringify(r);a="".concat(t," failed: ").concat(e)}}catch(r){a="".concat(t," failed: ").concat(e.detail.error)}else if("string"==typeof e.detail)a="".concat(t," failed: ").concat(e.detail);else{let r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if("string"==typeof e&&(e.includes("Cannot")||e.includes("Error")||e.includes("Failed")))return e;if("object"==typeof e&&null!==e)for(let[a,s]of Object.entries(e)){let e=r(s,t?"".concat(t,".").concat(a):a);if(e)return e}return null},s=r(e.detail);s&&(a="".concat(t," failed: ").concat(s))}}}catch(e){console.error("[Error Debug] Failed to parse error response:",e)}throw Error(a)}let s=await r.json();if(console.log("[Connector Debug] ".concat(t," resultData:"),s),"FAILED"===s.status){console.error("[Error Debug] ".concat(t," failed. Full resultData:"),JSON.stringify(s,null,2)),console.error("[Error Debug] resultData.error:",s.error),console.error("[Error Debug] resultData.result:",s.result),console.error("[Error Debug] resultData.return_value:",s.return_value);let e="Unknown error during ".concat(t," task execution");if(s.error)"string"==typeof s.error?e=s.error:"object"==typeof s.error&&(e=s.error.message||s.error.detail||JSON.stringify(s.error));else if(s.result&&s.result.error)"string"==typeof s.result.error?e=s.result.error:"object"==typeof s.result.error&&(e=s.result.error.message||s.result.error.detail||JSON.stringify(s.result.error));else if(s.return_value)try{let t=JSON.parse(s.return_value);t.error&&(e="string"==typeof t.error?t.error:t.error.message||t.error.detail||JSON.stringify(t.error))}catch(t){s.return_value&&(s.return_value.includes("Error")||s.return_value.includes("Cannot"))&&(e=s.return_value)}if(e==="Unknown error during ".concat(t," task execution")){let t=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if("string"==typeof e&&(e.includes("Cannot")||e.includes("Error")||e.includes("Failed")))return e;if("object"==typeof e&&null!==e)for(let[a,s]of Object.entries(e)){let e=t(s,r?"".concat(r,".").concat(a):a);if(e)return e}return null},r=t(s);r&&(e=r)}throw Error(e)}let o={};if("SUCCEEDED"===s.status&&s.return_value)try{o=JSON.parse(s.return_value),console.log("Successfully parsed ".concat(t," data:"),o)}catch(r){throw console.error("Failed to parse ".concat(t," data from return_value:"),r,"Raw return_value:",s.return_value),Error("Failed to parse ".concat(t," data for request ID ").concat(e,": ").concat(r.message))}else s.result&&(console.warn("Using resultData.result as fallback for ".concat(t," status ").concat(s.status)),o=s.result);return o}async function c(e,t){try{console.log("Updating workspace ".concat(e," with config:"),t);let r=await fetch("".concat(a.f4,"/workspaces/update"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({workspace_name:e,config:t})});if(!r.ok)throw Error("Error scheduling updateWorkspace: ".concat(r.statusText," (status ").concat(r.status,")"));let s=r.headers.get("X-Skypilot-Request-ID");if(!s)throw Error("Failed to obtain request ID for updateWorkspace");return await n(s,"updateWorkspace")}catch(e){throw console.error("Failed to update workspace:",e),e}}let l=async(e,t)=>{try{let r=await fetch("".concat(a.f4,"/workspaces/create"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({workspace_name:e,config:t})});if(!r.ok)throw await r.text(),Error("Error scheduling createWorkspace: ".concat(r.statusText," (status ").concat(r.status,")"));let s=r.headers.get("X-Skypilot-Request-ID");if(!s)throw Error("Failed to obtain request ID for createWorkspace");return await n(s,"createWorkspace")}catch(e){throw console.error("Failed to create workspace:",e),e}};async function i(e){try{console.log("Deleting workspace ".concat(e));let t=await fetch("".concat(a.f4,"/workspaces/delete"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({workspace_name:e})});if(!t.ok)throw Error("Error scheduling deleteWorkspace: ".concat(t.statusText," (status ").concat(t.status,")"));let r=t.headers.get("X-Skypilot-Request-ID");if(!r)throw Error("Failed to obtain request ID for deleteWorkspace");console.log("[Delete Debug] Got request ID for deleteWorkspace: ".concat(r));try{let e=await n(r,"deleteWorkspace");return console.log("[Delete Debug] deleteWorkspace completed successfully:",e),e}catch(e){throw console.error("[Delete Debug] deleteWorkspace failed with error:",e),console.error("[Delete Debug] Error message:",e.message),e}}catch(e){throw console.error("Failed to delete workspace:",e),e}}},4545:function(e,t,r){function a(e){return e.startsWith("sky-jobs-controller-")}function s(e,t,r){return null===t?e:[...e].sort((e,a)=>e[t]<a[t]?"ascending"===r?-1:1:e[t]>a[t]?"ascending"===r?1:-1:0)}r.d(t,{R0:function(){return s},Ym:function(){return a}})}}]);