Metadata-Version: 2.4
Name: nonebot-adapter-efchat
Version: 0.0.4
Summary: A NoneBot adapter for EFChat and similar chatrooms
Author-email: molanp <molanpp@outlook.com>
License-Expression: MIT
Project-URL: Homepage, https://github.com/molanp/nonebot_adapter_efchat
Project-URL: Repository, https://github.com/molanp/nonebot_adapter_efchat
Keywords: bot,efchat,wtek
Classifier: Development Status :: 5 - Production/Stable
Classifier: Framework :: Robot Framework
Classifier: Framework :: Robot Framework :: Library
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: nonebot2>=2.2.0
Requires-Dist: typing-extensions<5.0.0,>=4.0.0
Requires-Dist: pydantic!=2.5.0,!=2.5.1,<3.0.0,>=1.10.0
Requires-Dist: websockets>=2.0.0
Dynamic: license-file

<p align="center">
  <a href="https://nonebot.dev/"><img src="https://nonebot.dev/logo.png" width="200" height="200" alt="nonebot"></a>
</p>

<div align="center">

# NoneBot-Adapter-EFChat

_âœ¨ NoneBot2 EFChat åè®®é€‚é… / EFChat Protocol Adapter for NoneBot2 âœ¨_

</div>
## EFChaté€‚é…å™¨ç®€è¿°

EFChat Adapter æ˜¯ä¸€ä¸ªé€‚ç”¨äº **[EFChatèŠå¤©å®¤](https://efchat.melon.fish)** çš„ **NoneBot é€‚é…å™¨**ï¼Œå¯ä»¥è½»æ¾åœ°åœ¨ EFChat èŠå¤©å®¤ä¸­å¼€å‘æœºå™¨äººï¼Œå¹¶ä½¿ç”¨ NoneBot ç”Ÿæ€æ¥æ„å»ºèŠå¤©æœºå™¨äººã€‚

> [!IMPORTANT]
>
> ä¸ºäº†é¿å…é€ æˆä¸å¿…è¦çš„éº»çƒ¦ï¼Œæœ¬é€‚é…å™¨ä¸ä¼šæ”¯æŒä»¥ä¸‹åŠŸèƒ½ï¼š
> 1. **è´¦å·å¯†ç ç™»å½•**ï¼ˆå³éå®˜æ–¹çš„é‡ç”Ÿæœºå™¨äººï¼‰
> 2. **å‘é€è¯­éŸ³**
> 3. **å…¶ä»–æœ‰å¯èƒ½å±å®³èŠå¤©å®¤å®‰å…¨çš„åŠŸèƒ½**

---

## ğŸš€ ç‰¹æ€§
- ğŸ”Œ **NoneBot é€‚é…**ï¼Œå¯ç›´æ¥é›†æˆåˆ° NoneBot æ’ä»¶ç³»ç»Ÿï¼Œå®ç°çµæ´»çš„æœºå™¨äººå¼€å‘
- ğŸ“¡ **è‡ªåŠ¨å¤„ç† EFChat äº‹ä»¶**ï¼Œæ”¯æŒæˆ¿é—´æ¶ˆæ¯ã€ç§èŠã€ç³»ç»Ÿé€šçŸ¥ç­‰

---

## ğŸ“¦ å®‰è£…
```bash
pip install nonebot-adapter-efchat
```
---

## ğŸ”§ é…ç½®
åœ¨ `bot.py` ä¸­å¯ç”¨ EFChat é€‚é…å™¨ï¼š
```python
from nonebot import get_driver
from nonebot.adapters.efchat import Adapter

driver = get_driver()
driver.register_adapter(Adapter)
```

åœ¨ `.env` æˆ–é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š
```ini
DRIVER=~websockets

COMMAND_START=[""]

NICKNAME=[]

LOG_LEVEL=INFO

EFCHAT_name=xxxx
# Bot åç§°
EFCHAT_CHANNEL="PublicR"
# Bot æ´»è·ƒçš„ Channel
EFCHAT_HEAD="https://efchat.melon.fish/imgs/ava.png"
# Bot å¤´åƒåœ°å€
EFCHAT_TOKEN=xxxx
# ä½ çš„è®¤è¯ token
```

> âš ï¸ **æš‚ä¸æ”¯æŒåŒæ—¶è¿æ¥å¤šä¸ªæˆ¿é—´**

---

## ğŸ“– API å‚è€ƒ

### `MessageEvent(Event)`
EFChat æ¶ˆæ¯åŸºæœ¬æ¨¡å‹ï¼š
- `event.message`ï¼šæ¶ˆæ¯å†…å®¹
- `event.trip`: åŠ å¯†èº«ä»½æ ‡è¯†
- `event.self_id`: Bot åç§°
- `event.nick`ï¼šå‘é€è€…çš„ç”¨æˆ· ID
- `event.channel`ï¼šèŠå¤©å®¤åç§°

### `send()`
æ ¹æ® **æ¶ˆæ¯ç±»å‹** é€‰æ‹© `send_chat_message()` æˆ– `send_whisper_message()`ï¼š
```python
await bot.send(event, message="ä½ å¥½ï¼", at_sender=True, reply_message=False)
```
> **å‚æ•°è¯´æ˜**ï¼š
> - `event`: æ¶ˆæ¯äº‹ä»¶ï¼ˆ`ChannelMessageEvent` æˆ– `WhisperMessageEvent`ï¼‰
> - `message`: è¦å‘é€çš„å†…å®¹ï¼ˆ`str` æˆ– `Message`ï¼‰
> - `at_sender`: æ˜¯å¦ @ å‘é€è€…
> - `reply_message`: æ˜¯å¦å›å¤åŸæ¶ˆæ¯å†…å®¹

---

### `send_chat_message()`
å‘é€æ¶ˆæ¯åˆ° **å½“å‰æˆ¿é—´**ï¼š
```python
await bot.send_chat_message(event, message="Hello!", show=True, at_sender=False, reply_message=False)
```
> **å‚æ•°è¯´æ˜**ï¼š
> - `event`: æˆ¿é—´æ¶ˆæ¯äº‹ä»¶
> - `message`: è¦å‘é€çš„å†…å®¹ï¼ˆ`str` æˆ– `Message`ï¼‰
> - `show`: æ˜¯å¦åœ¨èŠå¤©è®°å½•ä¸­æ˜¾ç¤º (`True` æ˜¾ç¤ºï¼Œ`False` éšè—)
> - `at_sender`: æ˜¯å¦ @ å‘é€è€…
> - `reply_message`: æ˜¯å¦å›å¤åŸæ¶ˆæ¯å†…å®¹

---

### `send_whisper_message()`
å‘é€ **ç§èŠæ¶ˆæ¯** ç»™æŒ‡å®šç”¨æˆ·ï¼š
```python
await bot.send_whisper_message(event, message="Hello EFChat!", at_sender=False, reply_message=False)
```
> **å‚æ•°è¯´æ˜**ï¼š
> - `event`: ç§èŠæ¶ˆæ¯äº‹ä»¶
> - `message`: è¦å‘é€çš„å†…å®¹ï¼ˆ`str` æˆ– `Message`ï¼‰
> - `at_sender`: æ˜¯å¦ @ å‘é€è€…
> - `reply_message`: æ˜¯å¦å›å¤åŸæ¶ˆæ¯å†…å®¹

---

### `move()`
ç§»åŠ¨ Bot åˆ°æŒ‡å®šæˆ¿é—´ï¼š
```python
await bot.move("PrivateRoom")
```

---

### `change_nick()`
ä¿®æ”¹ Bot åç§°ï¼š
```python
await bot.change_nick("EFChatBot")
```

---

### `get_chat_history()`
è·å–æŒ‡å®šæ•°é‡çš„ **å†å²èŠå¤©è®°å½•**ï¼š
```python
await bot.get_chat_history(num=50)
```

---

## ğŸ’¬ ä½¿ç”¨ç¤ºä¾‹

### **æ¶ˆæ¯å›æ˜¾**
åœ¨ `plugins/echo.py` ä¸­åˆ›å»ºä¸€ä¸ªç®€å•çš„å›æ˜¾æ’ä»¶ï¼š
```python
from nonebot import on_message
from nonebot.adapters.efchat import MessageEvent

echo = on_message()

@echo.handle()
async def handle_echo(event: MessageEvent):
    await echo.send(f"ä½ å‘é€çš„æ¶ˆæ¯æ˜¯: {event.get_message()}")
```

---

## ğŸ”¨ å¼€å‘ä¸è´¡çŒ®
æ¬¢è¿è´¡çŒ®ä»£ç ï¼è¯·éµå¾ªä»¥ä¸‹æµç¨‹ï¼š
1. **Fork æœ¬ä»“åº“** å¹¶å…‹éš†ä»£ç ã€‚
2. **æäº¤ Pull Request**ï¼Œæè¿°ä½ çš„æ”¹åŠ¨ã€‚

---

## ğŸ“œ è®¸å¯è¯
æœ¬é¡¹ç›®åŸºäº **MIT è®¸å¯è¯** å¼€æºï¼Œä½ å¯ä»¥è‡ªç”±ä½¿ç”¨å’Œä¿®æ”¹ã€‚
